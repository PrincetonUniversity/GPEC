<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>pypec.modplot &#8212; GPEC 1.0.5 documentation</title>
    
    <link rel="stylesheet" href="../../_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '1.0.5',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
  </head>
  <body role="document">

<div style="background-color: white; text-align: left; padding: 10px 10px 15px 15px">
<a href="../../index.html"><img src="../../_static/logo.png" border="0" alt="py4sci"/></a>
</div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="../../index.html">home</a>|&nbsp;</li>
        <li><a href="../../search.html">search</a>|&nbsp;</li>

          <li class="nav-item nav-item-1"><a href="../index.html" accesskey="U">Module code</a> &#187;</li> 
      </ul>
    </div>

      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for pypec.modplot</h1><div class="highlight"><pre>
<span></span><span class="ch">#!/usr/local/env python</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">:mod:`pypec.modplot` -- matplotlib Customizations</span>
<span class="sd">=================================================</span>

<span class="sd">Collection of modified matplotlib functions and objects.</span>

<span class="sd">Examples</span>
<span class="sd">--------</span>

<span class="sd">Plot complex arguments.</span>

<span class="sd">&gt;&gt;&gt; f,ax = subplots()</span>
<span class="sd">&gt;&gt;&gt; lines = ax.plot(np.arange(10)*(1+0.5j),label=&#39;test&#39;)</span>
<span class="sd">&gt;&gt;&gt; pyplot.show()</span>

<span class="sd">Automatically resize plots to fit labels.</span>

<span class="sd">&gt;&gt;&gt; xlbl = ax.set_xlabel(&#39;X AXIS&#39;)</span>

<span class="sd">Plot huge data sets quickly.</span>

<span class="sd">&gt;&gt;&gt; x = np.linspace(0,9,1e5)</span>
<span class="sd">&gt;&gt;&gt; data = np.arange(1e5)/1.5e4+(np.random.rand(1e5)-0.5)</span>
<span class="sd">&gt;&gt;&gt; newline = ax.plot(x,data,label=&#39;large data set&#39;)</span>

<span class="sd">This plots a line capped at 1000-pts by default. The maximum number </span>
<span class="sd">of points is maintained as you manipulate the axis, so zooming</span>
<span class="sd">in will provide you with new points and increased detail until the</span>
<span class="sd">window samples fewer than that many points in the orginal data. The</span>
<span class="sd">first two lines, for instance, contain only their original 10 points</span>
<span class="sd">(not 1000 interpolated points). </span>

<span class="sd">&quot;&quot;&quot;</span>

<span class="c1">#standard matplotlib modules</span>
<span class="kn">import</span> <span class="nn">matplotlib</span>                       <span class="c1"># standard plotting library</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="k">import</span> <span class="n">pyplot</span>
<span class="kn">from</span> <span class="nn">matplotlib.colors</span> <span class="k">import</span> <span class="n">Normalize</span>
<span class="kn">from</span> <span class="nn">mpl_toolkits.axes_grid1</span> <span class="k">import</span> <span class="n">make_axes_locatable</span>    <span class="c1">#for splitting axes</span>
<span class="kn">from</span> <span class="nn">mpl_toolkits.mplot3d</span> <span class="k">import</span> <span class="n">Axes3D</span>
<span class="kn">import</span> <span class="nn">matplotlib.gridspec</span> <span class="k">as</span> <span class="nn">gridspec</span>

<span class="c1"># standard python modules</span>
<span class="kn">import</span> <span class="nn">sys</span><span class="o">,</span><span class="nn">copy</span><span class="o">,</span><span class="nn">os</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>                      <span class="c1"># math</span>
<span class="kn">from</span> <span class="nn">scipy.interpolate</span> <span class="k">import</span> <span class="n">interp1d</span>  <span class="c1"># math</span>
<span class="kn">from</span> <span class="nn">types</span> <span class="k">import</span> <span class="n">MethodType</span>            <span class="c1"># to modify instances</span>

<span class="c1"># Want separate ID pyplot module for my hacks</span>
<span class="c1"># so this module does not change global matplotlib,pyplot,pylab,etc.</span>
<span class="c1"># Issue is import matplotlib imports many modules... all intertwined.</span>
<span class="c1"># METHOD 1</span>
<span class="c1">#import imp #built in method for assigning IDs</span>
<span class="c1">#mfile,mpath,mdesc = imp.find_module(&#39;matplotlib&#39;)</span>
<span class="c1">#pyplot = imp.load_module(&#39;modpyplot&#39;, *imp.find_module(&#39;pyplot&#39;,[mpath]))</span>
<span class="c1"># Method 2</span>
<span class="c1">#save = sys.modules.pop(&#39;matplotlib.pyplot&#39;, None) </span>
<span class="c1">#import matplotlib.pyplot as pyplot</span>
<span class="c1">#sys.modules[&#39;matplotlib.pyplot&#39;] = save</span>

<span class="c1"># matplotlib modifications</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">interactive</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">is_interactive</span><span class="p">()</span>
    <span class="kn">import</span> <span class="nn">seaborn</span>
    <span class="n">seaborn</span><span class="o">.</span><span class="n">reset_orig</span><span class="p">()</span>
    <span class="n">matplotlib</span><span class="o">.</span><span class="n">interactive</span><span class="p">(</span><span class="n">interactive</span><span class="p">)</span>
<span class="k">except</span><span class="p">:</span>
    <span class="n">seaborn</span> <span class="o">=</span> <span class="kc">None</span>
<span class="c1">#override user preferences from ~/.matplotlib/matplotlibrc file.</span>
<span class="c1">#really should define new functions</span>
<span class="c1">#matplotlib.rcParams[&#39;figure.autolayout&#39;]=True # Necessary for tight_layout</span>
<span class="c1">#matplotlib.rcParams[&#39;legend.frameon&#39;]=False</span>
<span class="c1">#matplotlib.rcParams[&#39;legend.loc&#39;]=&#39;best&#39;</span>

<span class="n">linestyles</span> <span class="o">=</span> <span class="p">[</span> <span class="s1">&#39;-&#39;</span> <span class="p">,</span> <span class="s1">&#39;--&#39;</span> <span class="p">,</span> <span class="s1">&#39;-.&#39;</span> <span class="p">,</span> <span class="s1">&#39;:&#39;</span> <span class="p">,</span> <span class="s1">&#39;None&#39;</span> <span class="p">,</span> <span class="s1">&#39; &#39;</span> <span class="p">,</span><span class="s1">&#39;&#39;</span> <span class="p">]</span>
<span class="n">show</span> <span class="o">=</span> <span class="n">pyplot</span><span class="o">.</span><span class="n">show</span>
<span class="n">draw</span> <span class="o">=</span> <span class="n">pyplot</span><span class="o">.</span><span class="n">draw</span>


<span class="c1">########################################### some figure sizes (journal defualts)</span>

<span class="n">rcp_size</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">matplotlib</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.figsize&#39;</span><span class="p">])</span>
<span class="n">pop_size</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">3.346</span><span class="p">,</span><span class="mf">3.346</span><span class="p">])</span> <span class="c1">#single column. Do *2 for double</span>

<span class="c1">########################################### default colormaps</span>

<span class="kn">import</span> <span class="nn">colormaps</span> <span class="k">as</span> <span class="nn">cmaps</span>
<span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">matplotlib</span><span class="o">.</span><span class="n">cm</span><span class="p">,</span> <span class="s1">&#39;viridis&#39;</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;magma&#39;</span><span class="p">,</span><span class="s1">&#39;inferno&#39;</span><span class="p">,</span><span class="s1">&#39;plasma&#39;</span><span class="p">,</span><span class="s1">&#39;viridis&#39;</span><span class="p">]:</span>
        <span class="n">pyplot</span><span class="o">.</span><span class="n">register_cmap</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">k</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmaps</span><span class="o">.</span><span class="n">cmaps</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
        <span class="n">pyplot</span><span class="o">.</span><span class="n">register_cmap</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">k</span><span class="o">+</span><span class="s1">&#39;_r&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmaps</span><span class="o">.</span><span class="n">cmaps</span><span class="p">[</span><span class="n">k</span><span class="o">+</span><span class="s1">&#39;_r&#39;</span><span class="p">])</span>
    <span class="n">f</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">pyplot</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
    <span class="n">pyplot</span><span class="o">.</span><span class="n">set_cmap</span><span class="p">(</span><span class="n">cmaps</span><span class="o">.</span><span class="n">cmaps</span><span class="p">[</span><span class="s1">&#39;viridis&#39;</span><span class="p">])</span>
    <span class="n">pyplot</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>

<span class="c1">########################################### default colormaps</span>

<div class="viewcode-block" id="png_to_gif"><a class="viewcode-back" href="../../source_documentation.html#pypec.modplot.png_to_gif">[docs]</a><span class="k">def</span> <span class="nf">png_to_gif</span><span class="p">(</span><span class="n">files</span><span class="p">,</span><span class="n">gif_file</span><span class="p">,</span><span class="n">delay</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span><span class="n">loop</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">clean</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;gif_file should end in .gif&quot;&quot;&quot;</span>
    <span class="n">gif_file</span> <span class="o">=</span> <span class="n">gif_file</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(</span><span class="s1">&#39;.gif&#39;</span><span class="p">)</span>
    <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s1">&#39;convert -delay </span><span class="si">{d}</span><span class="s1"> -loop </span><span class="si">{l}</span><span class="s1"> </span><span class="si">{i}</span><span class="s1"> </span><span class="si">{o}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">d</span><span class="o">=</span><span class="n">delay</span><span class="p">,</span><span class="n">l</span><span class="o">=</span><span class="n">loop</span><span class="p">,</span><span class="n">i</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">files</span><span class="p">),</span><span class="n">o</span><span class="o">=</span><span class="n">gif_file</span><span class="o">+</span><span class="s1">&#39;.gif&#39;</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">clean</span><span class="p">:</span>
        <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s1">&#39;zip -j </span><span class="si">{zipfile}</span><span class="s1"> </span><span class="si">{files}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">zipfile</span><span class="o">=</span><span class="n">gif_file</span><span class="o">+</span><span class="s1">&#39;.zip&#39;</span><span class="p">,</span> <span class="n">files</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">files</span><span class="p">)))</span>
        <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s1">&#39;rm </span><span class="si">{files}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">files</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">files</span><span class="p">)))</span>
        
    <span class="k">return</span></div>

<span class="c1">########################################### Custom Styles</span>

<div class="viewcode-block" id="set_style"><a class="viewcode-back" href="../../source_documentation.html#pypec.modplot.set_style">[docs]</a><span class="k">def</span> <span class="nf">set_style</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">rc</span><span class="o">=</span><span class="p">{}):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Seaborn set_style with additional &#39;thick&#39;,</span>
<span class="sd">    </span>
<span class="sd">    Thick (thin) style multiplies rcParams axes.linewidth, lines.linewidth,</span>
<span class="sd">    xtick.major.width, xtick.minor.width, ytick.major.width, and </span>
<span class="sd">    ytick.minor.width by 2 (0.5).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">style</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;thick&#39;</span><span class="p">,</span><span class="s1">&#39;thin&#39;</span><span class="p">]:</span>
        <span class="k">if</span> <span class="n">pyplot</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;font.weight&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;normal&#39;</span><span class="p">:</span>
            <span class="n">pyplot</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;font.weight&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;400&#39;</span>
        <span class="k">elif</span> <span class="n">pyplot</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;font.weight&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;bold&#39;</span><span class="p">:</span>
            <span class="n">pyplot</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;font.weight&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;700&#39;</span>
        <span class="k">if</span> <span class="n">style</span> <span class="o">==</span><span class="s1">&#39;thick&#39;</span><span class="p">:</span>
            <span class="n">fac</span> <span class="o">=</span> <span class="mi">3</span><span class="o">/</span><span class="mf">2.</span>
            <span class="n">pyplot</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;font.weight&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">min</span><span class="p">((</span><span class="mi">900</span><span class="p">,</span><span class="nb">int</span><span class="p">(</span><span class="n">pyplot</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;font.weight&#39;</span><span class="p">])</span><span class="o">+</span><span class="mi">200</span><span class="p">)))</span>
        <span class="k">elif</span> <span class="n">style</span><span class="o">==</span><span class="s1">&#39;thin&#39;</span><span class="p">:</span>
            <span class="n">fac</span> <span class="o">=</span> <span class="mf">2.</span><span class="o">/</span><span class="mi">3</span>
            <span class="n">pyplot</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;font.weight&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">max</span><span class="p">((</span><span class="mi">100</span><span class="p">,</span><span class="nb">int</span><span class="p">(</span><span class="n">pyplot</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;font.weight&#39;</span><span class="p">])</span><span class="o">-</span><span class="mi">200</span><span class="p">)))</span>
        
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="n">pyplot</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">iteritems</span><span class="p">():</span>
            <span class="k">if</span> <span class="s1">&#39;weight&#39;</span> <span class="ow">in</span> <span class="n">k</span><span class="p">:</span> <span class="n">pyplot</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">pyplot</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;font.weight&#39;</span><span class="p">]</span>
        
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="nb">dict</span><span class="p">(</span><span class="n">rc</span><span class="p">)</span><span class="o">.</span><span class="n">iteritems</span><span class="p">():</span>
            <span class="n">pyplot</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span>
        
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;axes.linewidth&#39;</span><span class="p">,</span><span class="s1">&#39;lines.linewidth&#39;</span><span class="p">,</span><span class="s1">&#39;xtick.major.width&#39;</span><span class="p">,</span>
                  <span class="s1">&#39;xtick.minor.width&#39;</span><span class="p">,</span><span class="s1">&#39;ytick.major.width&#39;</span><span class="p">,</span><span class="s1">&#39;ytick.minor.width&#39;</span><span class="p">]:</span>
            <span class="n">pyplot</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">*=</span> <span class="n">fac</span>
        
    <span class="k">else</span><span class="p">:</span>
        <span class="n">seaborn</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="n">style</span><span class="p">,</span><span class="n">rc</span><span class="p">)</span>
    
    <span class="k">return</span></div>


<span class="c1">########################################### modified pyplot functions</span>

<div class="viewcode-block" id="subplots"><a class="viewcode-back" href="../../source_documentation.html#pypec.modplot.subplots">[docs]</a><span class="k">def</span> <span class="nf">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">squeeze</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">autosize</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
             <span class="n">subplot_kw</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">powerlim</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">useOffset</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">nybins</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">nxbins</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
             <span class="o">**</span><span class="n">fig_kw</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Matplotlib subplots with default figsize = rcp_size*[ncols,nrows]</span>
<span class="sd">    fig_kw.setdefault(&#39;figsize&#39;,figsize). </span>

<span class="sd">    Additional Key Word Arguments:</span>
<span class="sd">      powlim    : tuple. </span>
<span class="sd">        Axis labels use scientific notion above 10^power.</span>
<span class="sd">      useOffset : bool. </span>
<span class="sd">        Axis labels use offset if range&lt;&lt;average.</span>
<span class="sd">        </span>
<span class="sd">    Accepts standargs args and kwargs for pyplot.subplots.</span>
<span class="sd">    </span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">figsize</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">matplotlib</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.figsize&#39;</span><span class="p">])</span><span class="o">*</span><span class="p">[</span><span class="n">ncols</span><span class="p">,</span><span class="n">nrows</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">autosize</span><span class="p">:</span> <span class="n">fig_kw</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s1">&#39;figsize&#39;</span><span class="p">,</span><span class="n">figsize</span><span class="p">)</span>
    <span class="n">f</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">pyplot</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="n">nrows</span><span class="p">,</span><span class="n">ncols</span><span class="o">=</span><span class="n">ncols</span><span class="p">,</span><span class="n">sharex</span><span class="o">=</span><span class="n">sharex</span><span class="p">,</span><span class="n">sharey</span><span class="o">=</span><span class="n">sharey</span><span class="p">,</span><span class="n">squeeze</span><span class="o">=</span><span class="n">squeeze</span><span class="p">,</span><span class="n">subplot_kw</span><span class="o">=</span><span class="n">subplot_kw</span><span class="p">,</span><span class="o">**</span><span class="n">fig_kw</span><span class="p">)</span>
    <span class="c1"># customize axes and figure</span>
    <span class="k">if</span> <span class="n">nybins</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">ax</span><span class="o">.</span><span class="n">flat</span><span class="p">:</span>
           <span class="n">a</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">matplotlib</span><span class="o">.</span><span class="n">ticker</span><span class="o">.</span><span class="n">MaxNLocator</span><span class="p">(</span><span class="n">nbins</span><span class="o">=</span><span class="n">nybins</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">nxbins</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">ax</span><span class="o">.</span><span class="n">flat</span><span class="p">:</span>
           <span class="n">a</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">matplotlib</span><span class="o">.</span><span class="n">ticker</span><span class="o">.</span><span class="n">MaxNLocator</span><span class="p">(</span><span class="n">nbins</span><span class="o">=</span><span class="n">nxbins</span><span class="p">))</span>
    <span class="n">f</span> <span class="o">=</span> <span class="n">_modfigure</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">f</span><span class="p">,</span><span class="n">ax</span></div>
<span class="n">subplots</span><span class="o">.</span><span class="vm">__doc__</span> <span class="o">+=</span> <span class="s1">&#39;ORIGINAL DOCUMENTATION </span><span class="se">\n\n</span><span class="s1">&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">pyplot</span><span class="o">.</span><span class="n">subplots</span><span class="o">.</span><span class="vm">__doc__</span><span class="p">)</span>

<div class="viewcode-block" id="figure"><a class="viewcode-back" href="../../source_documentation.html#pypec.modplot.figure">[docs]</a><span class="k">def</span> <span class="nf">figure</span><span class="p">(</span><span class="n">num</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">FigureClass</span><span class="o">=</span><span class="n">matplotlib</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">Figure</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">f</span> <span class="o">=</span> <span class="n">pyplot</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">num</span><span class="o">=</span><span class="n">num</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="n">dpi</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="n">facecolor</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="n">edgecolor</span><span class="p">,</span> <span class="n">frameon</span><span class="o">=</span><span class="n">frameon</span><span class="p">,</span> <span class="n">FigureClass</span><span class="o">=</span><span class="n">FigureClass</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">f</span> <span class="o">=</span> <span class="n">_modfigure</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">f</span></div>

<div class="viewcode-block" id="colorbar"><a class="viewcode-back" href="../../source_documentation.html#pypec.modplot.colorbar">[docs]</a><span class="k">def</span> <span class="nf">colorbar</span><span class="p">(</span><span class="n">mappable</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">cax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">use_gridspec</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="o">**</span><span class="n">kw</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Modified pyplot colorbar for default use_gridspec=True.</span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">cb</span> <span class="o">=</span> <span class="n">pyplot</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">mappable</span><span class="o">=</span><span class="n">mappable</span><span class="p">,</span> <span class="n">cax</span><span class="o">=</span><span class="n">cax</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">use_gridspec</span><span class="o">=</span><span class="n">use_gridspec</span><span class="p">,</span><span class="o">**</span><span class="n">kw</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">cb</span></div>
<span class="n">colorbar</span><span class="o">.</span><span class="vm">__doc__</span><span class="o">+=</span><span class="s1">&#39;ORIGINAL DOCUMENTATION </span><span class="se">\n\n</span><span class="s1">&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">pyplot</span><span class="o">.</span><span class="n">colorbar</span><span class="o">.</span><span class="vm">__doc__</span><span class="p">)</span>





<span class="c1">########################################### Figure object modifications</span>

<span class="c1"># internal function to apply customizations post initialization</span>
<span class="k">def</span> <span class="nf">_modfigure</span><span class="p">(</span><span class="n">f</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Modplot figure object modifications. These include:</span>
<span class="sd">        1) canvas connection to modplot.key_press event funtion</span>

<span class="sd">    Arguments:</span>
<span class="sd">      f : Figure object.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">f</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">mpl_connect</span><span class="p">(</span><span class="s1">&#39;key_press_event&#39;</span><span class="p">,</span><span class="n">onkey</span><span class="p">)</span> <span class="c1">#custom hotkeys</span>
    <span class="c1">#pppl Figure base doesn&#39;t have show from nomachine for some reason</span>
    <span class="c1">#f._orig_show = MethodType(copy.deepcopy(f.show),f)</span>
    <span class="c1">#f.show = MethodType(_figure_show,f)</span>
    
    <span class="k">return</span> <span class="n">f</span>

<span class="c1"># customize axes when added    </span>
<span class="k">def</span> <span class="nf">_figure_add_subplot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="o">*</span><span class="n">args</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_orig_add_subplot</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">_modaxes</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ax</span>
<span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">pyplot</span><span class="o">.</span><span class="n">Figure</span><span class="p">,</span><span class="s2">&quot;_orig_add_subplot&quot;</span><span class="p">):</span> <span class="c1">#prevent recursion when reloaded</span>
    <span class="n">pyplot</span><span class="o">.</span><span class="n">Figure</span><span class="o">.</span><span class="n">_orig_add_subplot</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">pyplot</span><span class="o">.</span><span class="n">Figure</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">)</span>
<span class="n">pyplot</span><span class="o">.</span><span class="n">Figure</span><span class="o">.</span><span class="n">add_subplot</span> <span class="o">=</span> <span class="n">_figure_add_subplot</span>

<span class="c1"># tight_layout when show</span>
<span class="k">def</span> <span class="nf">_figure_show</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="o">*</span><span class="n">args</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_orig_show</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>
<span class="n">_figure_show</span><span class="o">.</span><span class="vm">__doc__</span> <span class="o">=</span> <span class="n">pyplot</span><span class="o">.</span><span class="n">show</span><span class="o">.</span><span class="vm">__doc__</span>
<span class="c1">#pppl Figure base doesn&#39;t have show from nomachine or 2.7.2 for some reason</span>
<span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">pyplot</span><span class="o">.</span><span class="n">Figure</span><span class="p">,</span><span class="s2">&quot;_orig_show&quot;</span><span class="p">):</span> <span class="c1">#prevent recursion when reloaded</span>
    <span class="k">if</span> <span class="n">sys</span><span class="o">.</span><span class="n">version_info</span><span class="o">&lt;</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">3</span><span class="p">):</span>
        <span class="n">pyplot</span><span class="o">.</span><span class="n">Figure</span><span class="o">.</span><span class="n">_orig_show</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">pyplot</span><span class="o">.</span><span class="n">show</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">pyplot</span><span class="o">.</span><span class="n">Figure</span><span class="o">.</span><span class="n">_orig_show</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">pyplot</span><span class="o">.</span><span class="n">Figure</span><span class="o">.</span><span class="n">show</span><span class="p">)</span>
<span class="n">pyplot</span><span class="o">.</span><span class="n">Figure</span><span class="o">.</span><span class="n">show</span> <span class="o">=</span> <span class="n">_figure_show</span>

<span class="c1">#colorbars are axes (for tight_layout)</span>
<span class="k">def</span> <span class="nf">_figure_colorbar</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mappable</span><span class="p">,</span> <span class="n">cax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">use_gridspec</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="o">**</span><span class="n">kw</span><span class="p">):</span>
    <span class="n">cb</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_orig_colorbar</span><span class="p">(</span><span class="n">mappable</span><span class="p">,</span> <span class="n">cax</span><span class="o">=</span><span class="n">cax</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
                             <span class="n">use_gridspec</span><span class="o">=</span><span class="n">use_gridspec</span><span class="p">,</span><span class="o">**</span><span class="n">kw</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">cb</span>
<span class="n">_figure_colorbar</span><span class="o">.</span><span class="vm">__doc__</span><span class="o">=</span><span class="s1">&#39;Modified default use_gridspec=True. </span><span class="se">\n</span><span class="s1"> - </span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">pyplot</span><span class="o">.</span><span class="n">colorbar</span><span class="o">.</span><span class="vm">__doc__</span><span class="p">)</span>
<span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">pyplot</span><span class="o">.</span><span class="n">Figure</span><span class="p">,</span><span class="s2">&quot;_orig_colorbar&quot;</span><span class="p">):</span> <span class="c1">#prevent recursion when reloaded</span>
    <span class="n">pyplot</span><span class="o">.</span><span class="n">Figure</span><span class="o">.</span><span class="n">_orig_colorbar</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">pyplot</span><span class="o">.</span><span class="n">Figure</span><span class="o">.</span><span class="n">colorbar</span><span class="p">)</span>
<span class="n">pyplot</span><span class="o">.</span><span class="n">Figure</span><span class="o">.</span><span class="n">colorbar</span> <span class="o">=</span> <span class="n">_figure_colorbar</span>


<span class="c1"># new method to print text file of lines in figure</span>
<div class="viewcode-block" id="printlines"><a class="viewcode-back" href="../../source_documentation.html#pypec.modplot.printlines">[docs]</a><span class="k">def</span> <span class="nf">printlines</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">filename</span><span class="p">,</span><span class="n">labeled_only</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">squeeze</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Print all data in line plot(s) to text file.The x values </span>
<span class="sd">    will be taken from the line with the greatest number of</span>
<span class="sd">    points in the (first) axis, and other lines are interpolated</span>
<span class="sd">    if their x values do not match. Column lables are the</span>
<span class="sd">    line labels and xlabel.</span>

<span class="sd">    Arguments:</span>
<span class="sd">      filename : str. </span>
<span class="sd">        Path to print to.</span>
<span class="sd">    </span>
<span class="sd">    Key Word Arguments:</span>
<span class="sd">      labeled_only : bool</span>
<span class="sd">        Only print labeled lines to file.</span>
<span class="sd">      squeeze : bool.</span>
<span class="sd">        Print lines from all axes in a single table.</span>
<span class="sd"> </span>
<span class="sd">    returns</span>
<span class="sd">      bool. </span>
<span class="sd">        True.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">data</span><span class="o">=</span><span class="p">[]</span>

        <span class="c1"># Try to avoid clutter in squeeze</span>
        <span class="n">samettle</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">sameylbl</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="n">squeeze</span><span class="p">:</span>
            <span class="n">ylbl</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_axes</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get_ylabel</span><span class="p">()</span>
            <span class="n">ttle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_axes</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get_title</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_axes</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">a</span><span class="o">.</span><span class="n">get_ylabel</span><span class="p">()</span> <span class="o">!=</span> <span class="n">ylbl</span><span class="p">:</span>
                    <span class="n">sameylbl</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="k">if</span> <span class="n">a</span><span class="o">.</span><span class="n">get_title</span><span class="p">()</span> <span class="o">!=</span> <span class="n">ttle</span><span class="p">:</span>
                    <span class="n">samettle</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">if</span> <span class="n">samettle</span><span class="p">:</span>
                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">ttle</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">sameylbl</span><span class="p">:</span>
                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;  ylabel = &#39;</span><span class="o">+</span><span class="n">ylbl</span><span class="o">.</span><span class="n">encode</span><span class="p">()</span><span class="o">.</span><span class="n">translate</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span><span class="s1">&#39; \$</span><span class="si">{}</span><span class="s1">&#39;</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n\n</span><span class="s1">&#39;</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_axes</span><span class="p">():</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">a</span><span class="o">.</span><span class="n">lines</span><span class="p">:</span> <span class="k">continue</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">squeeze</span><span class="p">:</span> 
                <span class="n">data</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">+</span><span class="n">a</span><span class="o">.</span><span class="n">get_title</span><span class="p">()</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n\n</span><span class="s1">&#39;</span><span class="p">)</span>
                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;  ylabel = &#39;</span><span class="o">+</span><span class="n">a</span><span class="o">.</span><span class="n">get_ylabel</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">()</span><span class="o">.</span><span class="n">translate</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span><span class="s1">&#39; \$</span><span class="si">{}</span><span class="s1">&#39;</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="c1"># use x-axis from line with greatest number of pts</span>
            <span class="n">xs</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">a</span><span class="o">.</span><span class="n">lines</span><span class="p">:</span>
                <span class="n">label</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">get_label</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">()</span><span class="o">.</span><span class="n">translate</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span><span class="s1">&#39; \$</span><span class="si">{}</span><span class="s1">&#39;</span><span class="p">)</span> 
                <span class="k">if</span> <span class="n">labeled_only</span> <span class="ow">and</span> <span class="p">(</span><span class="n">label</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">label</span><span class="p">):</span>
                    <span class="k">continue</span>
                <span class="n">xs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">get_xdata</span><span class="p">())</span>
            <span class="n">longest</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">xs</span><span class="p">])</span><span class="o">.</span><span class="n">argmax</span><span class="p">()</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">data</span><span class="p">:</span> 
                <span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">xs</span><span class="p">[</span><span class="n">longest</span><span class="p">])</span>
                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{0:&gt;25s}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">get_xlabel</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">()</span><span class="o">.</span><span class="n">translate</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span><span class="s1">&#39; \$</span><span class="si">{}</span><span class="s1">&#39;</span><span class="p">)))</span>
            <span class="c1"># label and extrapolate each line</span>
            <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">a</span><span class="o">.</span><span class="n">lines</span><span class="p">:</span>
                <span class="n">label</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">get_label</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">()</span><span class="o">.</span><span class="n">translate</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span><span class="s1">&#39; \$</span><span class="si">{}</span><span class="s1">&#39;</span><span class="p">)</span> 
                <span class="k">if</span> <span class="n">labeled_only</span> <span class="ow">and</span> <span class="p">(</span><span class="n">label</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">label</span><span class="p">):</span>
                    <span class="k">continue</span>
                <span class="k">if</span> <span class="n">squeeze</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">sameylbl</span><span class="p">:</span> 
                    <span class="n">label</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">get_ylabel</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">()</span><span class="o">.</span><span class="n">translate</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span><span class="s1">&#39; \$</span><span class="si">{}</span><span class="s1">&#39;</span><span class="p">)</span><span class="o">+</span><span class="n">label</span>
                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{0:&gt;25s}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">label</span><span class="p">))</span>
                <span class="c1"># standard axis</span>
                <span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">get_xdata</span><span class="p">(),</span><span class="n">line</span><span class="o">.</span><span class="n">get_ydata</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">x</span><span class="o">!=</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
                    <span class="n">fit</span> <span class="o">=</span> <span class="n">interp1d</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">bounds_error</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">fill_value</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
                    <span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fit</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">squeeze</span><span class="p">:</span>
                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1"> &#39;</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">iscomplex</span><span class="p">(</span><span class="n">data</span><span class="p">)):</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;WARNING: Complex data may be lost.&quot;</span><span class="p">)</span>
                <span class="n">data</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">real</span><span class="o">.</span><span class="n">T</span>
                <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
                    <span class="n">row</span><span class="o">.</span><span class="n">tofile</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">sep</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="nb">format</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%24.9E</span><span class="s1">&#39;</span><span class="p">)</span>
                    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1"> &#39;</span><span class="p">)</span>
                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">squeeze</span><span class="p">:</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1"> &#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">iscomplex</span><span class="p">(</span><span class="n">data</span><span class="p">)):</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;WARNING: Complex data may be lost.&quot;</span><span class="p">)</span>
            <span class="n">data</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">real</span><span class="o">.</span><span class="n">T</span>
            <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
                <span class="n">row</span><span class="o">.</span><span class="n">tofile</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">sep</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="nb">format</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%24.9E</span><span class="s1">&#39;</span><span class="p">)</span>
                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1"> &#39;</span><span class="p">)</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Wrote lines to &quot;</span><span class="o">+</span><span class="n">filename</span><span class="p">)</span>
    <span class="k">return</span> <span class="kc">True</span></div>
<span class="n">pyplot</span><span class="o">.</span><span class="n">Figure</span><span class="o">.</span><span class="n">printlines</span> <span class="o">=</span> <span class="n">printlines</span>


<span class="c1">########################################### Axes object modifications</span>


<span class="c1"># internal function to apply customizations post initialization</span>
<span class="k">def</span> <span class="nf">_modaxes</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span><span class="n">useOffset</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Modplot axis object modifications. These include:</span>
<span class="sd">        1) Optional offset</span>
<span class="sd">        2) Ticker format power lims (-3,3)</span>
<span class="sd">        3) New downsample instance, connected to x-axis rescale</span>
<span class="sd">        4) New plot instance with complex arg handling</span>

<span class="sd">    Arguments:</span>
<span class="sd">      ax        : obj.</span>
<span class="sd">        Axes object.</span>
<span class="sd">    Key Word Arguments:</span>
<span class="sd">      useOffset : bool.</span>
<span class="sd">        Offset axis zero.</span>

<span class="sd">    returns</span>
<span class="sd">      Axis object.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">afmt</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">ticker</span><span class="o">.</span><span class="n">ScalarFormatter</span><span class="p">(</span><span class="n">useOffset</span><span class="o">=</span><span class="n">useOffset</span><span class="p">)</span>
    <span class="n">afmt</span><span class="o">.</span><span class="n">set_powerlimits</span><span class="p">((</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">callbacks</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;xlim_changed&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">.</span><span class="n">downsample</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">afmt</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">afmt</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ax</span>

<span class="c1"># down sample all lines in axes</span>
<span class="k">def</span> <span class="nf">_axes_downsample</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">ax</span><span class="p">,</span><span class="n">npts</span><span class="o">=</span><span class="mi">10000</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Attempt to down sample original data in</span>
<span class="sd">    each Line2D object in lines.</span>

<span class="sd">    Arguments:</span>
<span class="sd">      ax   : obj.</span>
<span class="sd">        Initialized Axes object containing lines</span>
<span class="sd">    Key Word Arguments:</span>
<span class="sd">      npts : int.</span>
<span class="sd">        Number of points plotted in each line</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">ax</span><span class="o">.</span><span class="n">lines</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">l</span><span class="o">.</span><span class="n">downsample</span><span class="p">(</span><span class="n">npts</span><span class="o">=</span><span class="n">npts</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">pass</span>
    <span class="c1">#draw()</span>
<span class="n">pyplot</span><span class="o">.</span><span class="n">Axes</span><span class="o">.</span><span class="n">downsample</span> <span class="o">=</span> <span class="n">_axes_downsample</span>

<span class="c1"># complex value plotting</span>
<span class="k">def</span> <span class="nf">_axes_plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Modified axes line plotting, with suport for complex plotting.</span>
<span class="sd">    Original matplotlib Axes plot method now located at _orig_plot.</span>
<span class="sd">    All original plot args and kwargs accepted.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">linestyles</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">lines</span><span class="o">.</span><span class="n">lineStyles</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
    <span class="n">newargs</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="n">_real_arg</span><span class="p">,</span><span class="n">args</span><span class="p">)</span>
    <span class="n">lines1</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_orig_plot</span><span class="p">(</span><span class="o">*</span><span class="n">newargs</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">lines2</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="nb">any</span><span class="p">([</span><span class="nb">any</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">iscomplex</span><span class="p">(</span><span class="n">arg</span><span class="p">)))</span> <span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="n">args</span><span class="p">]):</span>
        <span class="n">newargs</span> <span class="o">=</span> <span class="p">[</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">:</span> <span class="n">newargs</span><span class="o">+=</span><span class="nb">map</span><span class="p">(</span><span class="n">_imag_arg</span><span class="p">,</span><span class="n">args</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>
        <span class="n">lines2</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_orig_plot</span><span class="p">(</span><span class="o">*</span><span class="n">newargs</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">l1</span><span class="p">,</span><span class="n">l2</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">lines1</span><span class="p">,</span><span class="n">lines2</span><span class="p">):</span>
            <span class="n">l2</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="n">l1</span><span class="o">.</span><span class="n">get_color</span><span class="p">())</span>
            <span class="n">ils</span> <span class="o">=</span> <span class="n">linestyles</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">l1</span><span class="o">.</span><span class="n">get_linestyle</span><span class="p">())</span>
            <span class="n">l2</span><span class="o">.</span><span class="n">set_linestyle</span><span class="p">(</span><span class="n">linestyles</span><span class="p">[</span><span class="n">ils</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">l2</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\Im$ &#39;</span><span class="o">+</span><span class="n">l1</span><span class="o">.</span><span class="n">get_label</span><span class="p">())</span>
            <span class="n">l1</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\Re$ &#39;</span><span class="o">+</span><span class="n">l1</span><span class="o">.</span><span class="n">get_label</span><span class="p">())</span>
        <span class="n">pyplot</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">ncol</span><span class="o">=</span><span class="nb">max</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lines</span><span class="p">)</span><span class="o">/</span><span class="mi">6</span><span class="p">))</span>
    <span class="c1">#draw()</span>
    <span class="k">return</span> <span class="n">lines1</span><span class="o">+</span><span class="n">lines2</span>
<span class="n">_axes_plot</span><span class="o">.</span><span class="vm">__doc__</span><span class="o">+=</span><span class="nb">str</span><span class="p">(</span><span class="n">pyplot</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="vm">__doc__</span><span class="p">)</span>
<span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">pyplot</span><span class="o">.</span><span class="n">Axes</span><span class="p">,</span><span class="s2">&quot;_orig_plot&quot;</span><span class="p">):</span> <span class="c1">#prevent recursion when reloaded</span>
    <span class="n">pyplot</span><span class="o">.</span><span class="n">Axes</span><span class="o">.</span><span class="n">_orig_plot</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">pyplot</span><span class="o">.</span><span class="n">Axes</span><span class="o">.</span><span class="n">plot</span><span class="p">)</span>
<span class="n">pyplot</span><span class="o">.</span><span class="n">Axes</span><span class="o">.</span><span class="n">plot</span> <span class="o">=</span> <span class="n">_axes_plot</span>


<span class="k">def</span> <span class="nf">_imag_arg</span><span class="p">(</span><span class="n">arg</span><span class="p">):</span>
    <span class="c1">#if type(arg)==str:</span>
    <span class="c1">#    return arg</span>
    <span class="c1">#else:</span>
    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">iscomplex</span><span class="p">(</span><span class="n">arg</span><span class="p">)):</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">imag</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">arg</span>

<span class="k">def</span> <span class="nf">_real_arg</span><span class="p">(</span><span class="n">arg</span><span class="p">):</span>
    <span class="c1">#if type(arg)==str:</span>
    <span class="c1">#    return arg</span>
    <span class="c1">#else:</span>
    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">iscomplex</span><span class="p">(</span><span class="n">arg</span><span class="p">)):</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">arg</span>

<span class="k">def</span> <span class="nf">_center_axes</span><span class="p">(</span><span class="n">ax</span><span class="p">):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;left&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_position</span><span class="p">(</span><span class="s1">&#39;center&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;left&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_linewidth</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;right&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;bottom&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_position</span><span class="p">(</span><span class="s1">&#39;center&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;bottom&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_linewidth</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;top&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;left&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_smart_bounds</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;bottom&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_smart_bounds</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s1">&#39;bottom&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
<span class="n">pyplot</span><span class="o">.</span><span class="n">Axes</span><span class="o">.</span><span class="n">center_axes</span> <span class="o">=</span> <span class="n">_center_axes</span>


<span class="c1">########################################### modified pyplot functions</span>

<span class="c1"># downsample data from the full set used to initialize the line</span>
<div class="viewcode-block" id="line_downsample"><a class="viewcode-back" href="../../source_documentation.html#pypec.modplot.line_downsample">[docs]</a><span class="k">def</span> <span class="nf">line_downsample</span><span class="p">(</span><span class="n">line</span><span class="p">,</span><span class="n">npts</span><span class="o">=</span><span class="mi">1000</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Downsample line data for increased plotting speed.</span>

<span class="sd">    Key Word Arguments: </span>
<span class="sd">      npts : int. </span>
<span class="sd">        Number of data points within axes xlims.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">lims</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">()</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">line</span><span class="p">,</span><span class="s1">&#39;_xinit&#39;</span><span class="p">):</span>
        <span class="n">line</span><span class="o">.</span><span class="n">_xinit</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">get_xdata</span><span class="p">()</span>
        <span class="n">line</span><span class="o">.</span><span class="n">_yinit</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">get_ydata</span><span class="p">()</span>
    <span class="n">window</span> <span class="o">=</span> <span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">_xinit</span><span class="o">&gt;=</span><span class="n">lims</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">_xinit</span><span class="o">&lt;=</span><span class="n">lims</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="c1">#extend out edge</span>
    <span class="n">window</span><span class="p">[</span><span class="n">window</span><span class="o">.</span><span class="n">argmax</span><span class="p">()</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="kc">True</span>
    <span class="n">window</span><span class="p">[</span><span class="n">window</span><span class="o">.</span><span class="n">argmax</span><span class="p">()</span><span class="o">+</span><span class="n">window</span><span class="p">[</span><span class="n">window</span><span class="o">.</span><span class="n">argmax</span><span class="p">():]</span><span class="o">.</span><span class="n">argmin</span><span class="p">()]</span><span class="o">=</span><span class="kc">True</span>
    <span class="n">step</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">_xinit</span><span class="p">[</span><span class="n">window</span><span class="p">]</span><span class="o">.</span><span class="n">size</span><span class="o">/</span><span class="n">npts</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="n">line</span><span class="o">.</span><span class="n">set_xdata</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">_xinit</span><span class="p">[</span><span class="n">window</span><span class="p">][::</span><span class="n">step</span><span class="p">])</span>
    <span class="n">line</span><span class="o">.</span><span class="n">set_ydata</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">_yinit</span><span class="p">[</span><span class="n">window</span><span class="p">][::</span><span class="n">step</span><span class="p">])</span></div>
<span class="n">pyplot</span><span class="o">.</span><span class="n">matplotlib</span><span class="o">.</span><span class="n">lines</span><span class="o">.</span><span class="n">Line2D</span><span class="o">.</span><span class="n">downsample</span> <span class="o">=</span> <span class="n">line_downsample</span>





<span class="c1">########################################### my own functions</span>

<div class="viewcode-block" id="add_inset_axes"><a class="viewcode-back" href="../../source_documentation.html#pypec.modplot.add_inset_axes">[docs]</a><span class="k">def</span> <span class="nf">add_inset_axes</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span><span class="n">rect</span><span class="p">,</span><span class="n">axisbg</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">,</span><span class="n">polar</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Add a axes inset in another axes.</span>
<span class="sd">    Unlike the native matplotlib inset_axes, here the inset axes can be a polar axes.</span>

<span class="sd">    Note that the parent axes should be drawn first if using autolayout (changes postion).</span>
<span class="sd">    The inset axes will not track the original if it is moved.</span>

<span class="sd">    From http://stackoverflow.com/questions/17458580/embedding-small-plots-inside-subplots-in-matplotlib/17479417#17479417</span>

<span class="sd">    :param ax: Axes. Parent axes.</span>
<span class="sd">    :param rect: list. Inset axes location and dimensions [left, bottom, width, height]</span>
<span class="sd">    :param axisbg: str. Background color.</span>
<span class="sd">    :param polar: bool. Polar plot.</span>
<span class="sd">    :param kwargs: dict. Passed to add_subplot.</span>
<span class="sd">    :return: Axes. A new inset axes.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">figure</span>
    <span class="n">box</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_position</span><span class="p">()</span>
    <span class="n">width</span> <span class="o">=</span> <span class="n">box</span><span class="o">.</span><span class="n">width</span>
    <span class="n">height</span> <span class="o">=</span> <span class="n">box</span><span class="o">.</span><span class="n">height</span>
    <span class="n">inax_position</span>  <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">rect</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">])</span>
    <span class="n">transFigure</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">transFigure</span><span class="o">.</span><span class="n">inverted</span><span class="p">()</span>
    <span class="n">infig_position</span> <span class="o">=</span> <span class="n">transFigure</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">inax_position</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">infig_position</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">infig_position</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">width</span> <span class="o">*=</span> <span class="n">rect</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">height</span> <span class="o">*=</span> <span class="n">rect</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
    <span class="n">subax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">width</span><span class="p">,</span><span class="n">height</span><span class="p">],</span><span class="n">axisbg</span><span class="o">=</span><span class="n">axisbg</span><span class="p">,</span><span class="n">polar</span><span class="o">=</span><span class="n">polar</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">x_labelsize</span> <span class="o">=</span> <span class="n">subax</span><span class="o">.</span><span class="n">get_xticklabels</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get_size</span><span class="p">()</span>
    <span class="n">y_labelsize</span> <span class="o">=</span> <span class="n">subax</span><span class="o">.</span><span class="n">get_yticklabels</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get_size</span><span class="p">()</span>
    <span class="n">x_labelsize</span> <span class="o">*=</span> <span class="n">rect</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">**</span><span class="mf">0.5</span>
    <span class="n">y_labelsize</span> <span class="o">*=</span> <span class="n">rect</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">**</span><span class="mf">0.5</span>
    <span class="n">subax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_tick_params</span><span class="p">(</span><span class="n">labelsize</span><span class="o">=</span><span class="n">x_labelsize</span><span class="p">)</span>
    <span class="n">subax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_tick_params</span><span class="p">(</span><span class="n">labelsize</span><span class="o">=</span><span class="n">y_labelsize</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">subax</span></div>

<div class="viewcode-block" id="shiftedColorMap"><a class="viewcode-back" href="../../source_documentation.html#pypec.modplot.shiftedColorMap">[docs]</a><span class="k">def</span> <span class="nf">shiftedColorMap</span><span class="p">(</span><span class="n">cmap</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">midpoint</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">stop</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;shiftedcmap&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Function to offset the &quot;center&quot; of a colormap. Useful for</span>
<span class="sd">    data with a negative min and positive max and you want the</span>
<span class="sd">    middle of the colormap&#39;s dynamic range to be at zero.</span>

<span class="sd">    Taken from http://stackoverflow.com/questions/7404116/defining-the-midpoint-of-a-colormap-in-matplotlib</span>

<span class="sd">    Args:</span>
<span class="sd">        cmap: The matplotlib colormap to be altered</span>
<span class="sd">        start: Offset from lowest point in the colormap&#39;s range. Should be between 0 and &#39;midpoint&#39;.</span>
<span class="sd">        midpoint: The new center of the colormap. Should be between 0.0 and 1.0. Recommended is  1 - vmax/(vmax + abs(vmin)).</span>
<span class="sd">        stop: Offset from highest point in the colormap&#39;s range. Should be between &#39;midpoint&#39; and 1.0.</span>
<span class="sd">        name: str. Added to the name of cmap when creating the new colormap.</span>

<span class="sd">    Example:</span>

<span class="sd">    The following creates a shifted colormap that can be used in matplotlib arguments,</span>

<span class="sd">        &gt;&gt;&gt; orig_cmap = matplotlib.cm.coolwarm</span>
<span class="sd">        &gt;&gt;&gt; shifted_cmap = shiftedColorMap(orig_cmap, midpoint=0.75, name=&#39;shifted&#39;)</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">cdict</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;red&#39;</span><span class="p">:</span> <span class="p">[],</span>
        <span class="s1">&#39;green&#39;</span><span class="p">:</span> <span class="p">[],</span>
        <span class="s1">&#39;blue&#39;</span><span class="p">:</span> <span class="p">[],</span>
        <span class="s1">&#39;alpha&#39;</span><span class="p">:</span> <span class="p">[]</span>
    <span class="p">}</span>

    <span class="c1"># regular index to compute the colors</span>
    <span class="n">reg_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">stop</span><span class="p">,</span> <span class="mi">257</span><span class="p">)</span>

    <span class="c1"># shifted index to match the data</span>
    <span class="n">shift_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">([</span>
        <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">midpoint</span><span class="p">,</span> <span class="mi">128</span><span class="p">,</span> <span class="n">endpoint</span><span class="o">=</span><span class="kc">False</span><span class="p">),</span>
        <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">midpoint</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mi">129</span><span class="p">,</span> <span class="n">endpoint</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="p">])</span>

    <span class="k">for</span> <span class="n">ri</span><span class="p">,</span> <span class="n">si</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">reg_index</span><span class="p">,</span> <span class="n">shift_index</span><span class="p">):</span>
        <span class="n">r</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">a</span> <span class="o">=</span> <span class="n">cmap</span><span class="p">(</span><span class="n">ri</span><span class="p">)</span>

        <span class="n">cdict</span><span class="p">[</span><span class="s1">&#39;red&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">si</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">r</span><span class="p">))</span>
        <span class="n">cdict</span><span class="p">[</span><span class="s1">&#39;green&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">si</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">g</span><span class="p">))</span>
        <span class="n">cdict</span><span class="p">[</span><span class="s1">&#39;blue&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">si</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">b</span><span class="p">))</span>
        <span class="n">cdict</span><span class="p">[</span><span class="s1">&#39;alpha&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">si</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">a</span><span class="p">))</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{:}</span><span class="s1">_</span><span class="si">{:}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">cmap</span><span class="o">.</span><span class="n">name</span><span class="p">,</span><span class="n">name</span><span class="p">)</span>
    <span class="n">newcmap</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">LinearSegmentedColormap</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">cdict</span><span class="p">)</span>
    <span class="n">pyplot</span><span class="o">.</span><span class="n">register_cmap</span><span class="p">(</span><span class="n">cmap</span><span class="o">=</span><span class="n">newcmap</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">newcmap</span></div>


<div class="viewcode-block" id="MidPointNorm"><a class="viewcode-back" href="../../source_documentation.html#pypec.modplot.MidPointNorm">[docs]</a><span class="k">class</span> <span class="nc">MidPointNorm</span><span class="p">(</span><span class="n">Normalize</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Taken from http://stackoverflow.com/questions/7404116/defining-the-midpoint-of-a-colormap-in-matplotlib</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">midpoint</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">clip</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        A Normalize subclass that, when used, will stretch a colormap out such that the</span>
<span class="sd">        dynamic range has (vmin, midpoint, vmax) even if midpoint is not half way between the ends.</span>

<span class="sd">        Note, a side-product of this approach is that the colorbar labeling is similarly stretched.</span>

<span class="sd">        Args:</span>
<span class="sd">            midpoint: numeric. Sets the data value that will be the center of the colormap dynamic range.</span>
<span class="sd">            vmin: numeric. Sets the data value that will be the min of the colormap dynamic range.</span>
<span class="sd">            vmax: numeric. Sets the data value that will be the max of the colormap dynamic range.</span>
<span class="sd">            clip: numeric.</span>

<span class="sd">        Returns:</span>
<span class="sd">            class. To be used as a norm with matplotlib.</span>

<span class="sd">        Example:</span>
<span class="sd">            &gt;&gt;&gt; norm = MidPointNorm(midpoint=0.8)</span>
<span class="sd">            &gt;&gt;&gt; f,ax = subplots()</span>
<span class="sd">            &gt;&gt;&gt; im = ax.imshow(np.random.random((10,10)), norm=norm, cmap=&#39;seismic&#39;)</span>
<span class="sd">            &gt;&gt;&gt; f.colorbar(im,ax=ax)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">Normalize</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="p">,</span> <span class="n">clip</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">midpoint</span> <span class="o">=</span> <span class="n">midpoint</span>

    <span class="k">def</span> <span class="nf">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">clip</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">clip</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">clip</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">clip</span>

        <span class="n">result</span><span class="p">,</span> <span class="n">is_scalar</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">process_value</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">autoscale_None</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
        <span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="p">,</span> <span class="n">midpoint</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vmin</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">vmax</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">midpoint</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">vmin</span> <span class="o">&lt;</span> <span class="n">midpoint</span> <span class="o">&lt;</span> <span class="n">vmax</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;midpoint must be between maxvalue and minvalue.&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">vmin</span> <span class="o">==</span> <span class="n">vmax</span><span class="p">:</span>
            <span class="n">result</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="c1"># Or should it be all masked? Or 0.5?</span>
        <span class="k">elif</span> <span class="n">vmin</span> <span class="o">&gt;</span> <span class="n">vmax</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;maxvalue must be bigger than minvalue&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">vmin</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">vmin</span><span class="p">)</span>
            <span class="n">vmax</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">vmax</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">clip</span><span class="p">:</span>
                <span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">getmask</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
                <span class="n">result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">filled</span><span class="p">(</span><span class="n">vmax</span><span class="p">),</span> <span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="p">),</span>
                                  <span class="n">mask</span><span class="o">=</span><span class="n">mask</span><span class="p">)</span>

            <span class="c1"># ma division is very slow; we can take a shortcut</span>
            <span class="n">resdat</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">data</span>

            <span class="c1">#First scale to -1 to 1 range, than to from 0 to 1.</span>
            <span class="n">resdat</span> <span class="o">-=</span> <span class="n">midpoint</span>
            <span class="n">resdat</span><span class="p">[</span><span class="n">resdat</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">]</span> <span class="o">/=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">vmax</span> <span class="o">-</span> <span class="n">midpoint</span><span class="p">)</span>
            <span class="n">resdat</span><span class="p">[</span><span class="n">resdat</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">]</span> <span class="o">/=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">vmin</span> <span class="o">-</span> <span class="n">midpoint</span><span class="p">)</span>

            <span class="n">resdat</span> <span class="o">/=</span> <span class="mf">2.</span>
            <span class="n">resdat</span> <span class="o">+=</span> <span class="mf">0.5</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">resdat</span><span class="p">,</span> <span class="n">mask</span><span class="o">=</span><span class="n">result</span><span class="o">.</span><span class="n">mask</span><span class="p">,</span> <span class="n">copy</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">is_scalar</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">result</span>

<div class="viewcode-block" id="MidPointNorm.inverse"><a class="viewcode-back" href="../../source_documentation.html#pypec.modplot.MidPointNorm.inverse">[docs]</a>    <span class="k">def</span> <span class="nf">inverse</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">scaled</span><span class="p">():</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Not invertible until scaled&quot;</span><span class="p">)</span>
        <span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="p">,</span> <span class="n">midpoint</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vmin</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">vmax</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">midpoint</span>

        <span class="k">if</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">cbook</span><span class="o">.</span><span class="n">iterable</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
            <span class="n">val</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
            <span class="n">val</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">val</span><span class="o">-</span><span class="mf">0.5</span><span class="p">)</span>
            <span class="n">val</span><span class="p">[</span><span class="n">val</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">]</span>  <span class="o">*=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">vmax</span> <span class="o">-</span> <span class="n">midpoint</span><span class="p">)</span>
            <span class="n">val</span><span class="p">[</span><span class="n">val</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">]</span> <span class="o">*=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">vmin</span> <span class="o">-</span> <span class="n">midpoint</span><span class="p">)</span>
            <span class="n">val</span> <span class="o">+=</span> <span class="n">midpoint</span>
            <span class="k">return</span> <span class="n">val</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">val</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">val</span> <span class="o">-</span> <span class="mf">0.5</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">val</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">return</span>  <span class="n">val</span><span class="o">*</span><span class="nb">abs</span><span class="p">(</span><span class="n">vmin</span><span class="o">-</span><span class="n">midpoint</span><span class="p">)</span> <span class="o">+</span> <span class="n">midpoint</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span>  <span class="n">val</span><span class="o">*</span><span class="nb">abs</span><span class="p">(</span><span class="n">vmax</span><span class="o">-</span><span class="n">midpoint</span><span class="p">)</span> <span class="o">+</span> <span class="n">midpoint</span></div></div>


<div class="viewcode-block" id="plot_axes"><a class="viewcode-back" href="../../source_documentation.html#pypec.modplot.plot_axes">[docs]</a><span class="k">def</span> <span class="nf">plot_axes</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">fig</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">geometry</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Re-create a given axis in a new figure. This allows, for instance,</span>
<span class="sd">    a subplot to be moved to its own figure where it can be manipulated</span>
<span class="sd">    and/or saved independent of the original.</span>

<span class="sd">    Arguments:   </span>
<span class="sd">      ax : obj. </span>
<span class="sd">        An initialized Axes object  </span>
<span class="sd">    Key Word Arguments: </span>
<span class="sd">      fig: obj. </span>
<span class="sd">        A figure in which to re-create the axis</span>
<span class="sd">      geometry : tuple. </span>
<span class="sd">        Axes geometry of re-created axis</span>
<span class="sd">    </span>
<span class="sd">    returns    </span>
<span class="sd">      Figure.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">fig</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="n">figure</span><span class="p">()</span>
    <span class="n">a2</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
    <span class="n">a2</span><span class="o">.</span><span class="n">set_figure</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
    <span class="n">a2</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">(</span><span class="n">a2</span><span class="p">)</span>
<span class="c1">#    for k,v in vars(ax).iteritems():</span>
<span class="c1">#        if &#39;_&#39; not in k:</span>
<span class="c1">#            try:</span>
<span class="c1">#                setattr(ax2,k,v)</span>
<span class="c1">#            except:</span>
<span class="c1">#                pass</span>
    <span class="k">if</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_geometry</span><span class="p">()</span> <span class="o">!=</span> <span class="n">geometry</span> <span class="p">:</span>
        <span class="n">a2</span><span class="o">.</span><span class="n">change_geometry</span><span class="p">(</span><span class="o">*</span><span class="n">geometry</span><span class="p">)</span>
<span class="c1">#    draw()</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">fig</span></div>

<div class="viewcode-block" id="xyaxes"><a class="viewcode-back" href="../../source_documentation.html#pypec.modplot.xyaxes">[docs]</a><span class="k">def</span> <span class="nf">xyaxes</span><span class="p">(</span><span class="n">axes</span><span class="p">,</span><span class="n">x</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plot hline and vline through (0,0).</span>
<span class="sd">    </span>
<span class="sd">    **Arguments:**</span>
<span class="sd">        - axes : obj. Matplotlib Axes object.</span>
<span class="sd">        </span>
<span class="sd">    **key Word Arguments:**</span>
<span class="sd">        - x : bool. Draw hline</span>
<span class="sd">        - y : bool. Draw vline</span>
<span class="sd">    </span>
<span class="sd">    **Returns:**</span>
<span class="sd">        - bool.</span>
<span class="sd">        </span>
<span class="sd">    All other kwargs passed to hlines and vlines functions.</span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">y</span><span class="p">:</span>
        <span class="n">ylim</span> <span class="o">=</span> <span class="n">axes</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()</span>
        <span class="n">axes</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="o">*</span><span class="n">ylim</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">axes</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">*</span><span class="n">ylim</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">x</span><span class="p">:</span>
        <span class="n">xlim</span> <span class="o">=</span> <span class="n">axes</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">()</span>
        <span class="n">axes</span><span class="o">.</span><span class="n">hlines</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="o">*</span><span class="n">xlim</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">axes</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">*</span><span class="n">xlim</span><span class="p">)</span>
    <span class="k">return</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="set_linearray"><a class="viewcode-back" href="../../source_documentation.html#pypec.modplot.set_linearray">[docs]</a><span class="k">def</span> <span class="nf">set_linearray</span><span class="p">(</span><span class="n">lines</span><span class="p">,</span><span class="n">values</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">vmin</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">vmax</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Set colors of lines to colormaping of values.</span>
<span class="sd">    </span>
<span class="sd">    Other good sequential colormaps are YlOrBr and autumn.</span>
<span class="sd">    A good diverging colormap is bwr.</span>
<span class="sd">    </span>
<span class="sd">    **Arguments:**</span>
<span class="sd">        - lines : list. Lines to get set colors.</span>
<span class="sd">    </span>
<span class="sd">    **Key Word Arguments:**</span>
<span class="sd">        - values : array like. Values corresponding to each line. Default is indexing.</span>
<span class="sd">        - cmap : str. Valid matplotlib colormap name.</span>
<span class="sd">        - vmax : float. Upper bound of colormaping.</span>
<span class="sd">        - vmin : float. Lower bound of colormaping.</span>
<span class="sd">    </span>
<span class="sd">    **Returns:**</span>
<span class="sd">        - ScalarMappable. A mapping object used for colorbars.</span>
<span class="sd">        </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">values</span><span class="o">==</span><span class="kc">None</span><span class="p">:</span>
        <span class="n">values</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">lines</span><span class="p">))</span>
    <span class="n">nm</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">Normalize</span><span class="p">(</span><span class="n">vmin</span><span class="p">,</span><span class="n">vmax</span><span class="p">)</span>
    <span class="n">sm</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">ScalarMappable</span><span class="p">(</span><span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span><span class="n">norm</span><span class="o">=</span><span class="n">nm</span><span class="p">)</span>
    <span class="n">sm</span><span class="o">.</span><span class="n">set_array</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>
    <span class="n">colors</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">cmap</span><span class="p">(</span><span class="n">sm</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">values</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">l</span><span class="p">,</span><span class="n">c</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">lines</span><span class="p">,</span><span class="n">colors</span><span class="p">):</span>
        <span class="n">l</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>    
        
    <span class="k">return</span> <span class="n">sm</span></div>

<div class="viewcode-block" id="onkey"><a class="viewcode-back" href="../../source_documentation.html#pypec.modplot.onkey">[docs]</a><span class="k">def</span> <span class="nf">onkey</span><span class="p">(</span><span class="n">event</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Function to connect key_press_event events from matplotlib</span>
<span class="sd">    to custom functions.</span>

<span class="sd">    Matplotlib defaults (may be changed in matplotlibrc):</span>

<span class="sd">    keymap.fullscreen : f               # toggling</span>
<span class="sd">    keymap.home : h, r, home            # home or reset mnemonic</span>
<span class="sd">    keymap.back : left, c, backspace    # forward / backward keys to enable</span>
<span class="sd">    keymap.forward : right, v           #   left handed quick navigation</span>
<span class="sd">    keymap.pan : p                      # pan mnemonic</span>
<span class="sd">    keymap.zoom : o                     # zoom mnemonic</span>
<span class="sd">    keymap.save : s                     # saving current figure</span>
<span class="sd">    keymap.quit : ctrl+w                # close the current figure</span>
<span class="sd">    keymap.grid : g                     # switching on/off a grid in current axes</span>
<span class="sd">    keymap.yscale : l                   # toggle scaling of y-axes (&#39;log&#39;/&#39;linear&#39;)</span>
<span class="sd">    keymap.xscale : L, k                # toggle scaling of x-axes (&#39;log&#39;/&#39;linear&#39;)</span>
<span class="sd">    keymap.all_axes : a                 # enable all axes</span>

<span class="sd">    My custom function mapping:</span>

<span class="sd">    popaxes : n                         #Creates new figure with current axes</span>
<span class="sd">    tighten : t                         #Call tight_layout bound method for figure</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">key</span><span class="o">==</span><span class="s1">&#39;n&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">inaxes</span><span class="p">:</span>
            <span class="n">f</span> <span class="o">=</span> <span class="n">plot_axes</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">inaxes</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">key</span><span class="o">==</span><span class="s1">&#39;t&#39;</span><span class="p">:</span>
        <span class="n">f</span> <span class="o">=</span> <span class="n">pyplot</span><span class="o">.</span><span class="n">gcf</span><span class="p">()</span>
        <span class="n">f</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
        <span class="n">f</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">key</span><span class="o">==</span><span class="s1">&#39;c&#39;</span><span class="p">:</span>
        <span class="n">event</span><span class="o">.</span><span class="n">inaxes</span><span class="o">.</span><span class="n">_center_axis</span><span class="p">()</span>
    <span class="k">return</span></div>



    
</pre></div>

          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="../../index.html">home</a>|&nbsp;</li>
        <li><a href="../../search.html">search</a>|&nbsp;</li>

          <li class="nav-item nav-item-1"><a href="../index.html" >Module code</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2015, PPPL.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.5.1.
    </div>
  </body>
</html>