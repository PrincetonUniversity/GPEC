<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>PYPEC Source documentation &#8212; GPEC 1.2.3 documentation</title>
    <link rel="stylesheet" href="_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '1.2.3',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="_static/bootstrap-3.3.6/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="_static/bootstrap-sphinx.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  </head>
  <body>

<div style="background-color: white; text-align: left; padding: 10px 10px 15px 15px">
<a href="index.html"><img src="_static/logo.png" border="0" alt="py4sci"/></a>
</div>



  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="index.html"><img height=40, src="_static/GPEC_logo.png">
          <!-- GPEC-->
        </a>
        <!-- <span class="navbar-text navbar-version pull-left"><b>1.2</b></span> -->
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
                <li><a href="references.html">Cite</a></li>
                <li><a href="contact.html">Contact</a></li>
                <li><a href="developers.html">Develop</a></li>
                <li><a href="releases.html">Release History</a></li>
                <li><a href="#">Code</a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="index.html">Jump to <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"></ul>
</li>
              
            
            
            
            
            
          </ul>
           <!-- 
            
<form class="navbar-form navbar-right" action="search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
           -->
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="index.html">
              <img class="logo" src="_static/GPEC_logo.png" alt="Logo"/>
            </a></p><ul>
<li><a class="reference internal" href="#">PYPEC Source documentation</a><ul>
<li><a class="reference internal" href="#pypec-main-package"><code class="docutils literal"><span class="pre">pypec</span></code> – Main Package</a></li>
<li><a class="reference internal" href="#python-at-pppl">Python at PPPL</a><ul>
<li><a class="reference internal" href="#python-tutorials">Python Tutorials</a></li>
<li><a class="reference internal" href="#setting-your-personal-defaults">Setting Your Personal Defaults</a></li>
<li><a class="reference internal" href="#using-the-best-environment">Using the Best Environment</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pypec-data-pythonic-treatment-of-scientific-data"><code class="docutils literal"><span class="pre">pypec.data</span></code> – Pythonic Treatment of Scientific Data</a><ul>
<li><a class="reference internal" href="#beginners">Beginners</a></li>
<li><a class="reference internal" href="#advanced-users">Advanced Users</a></li>
<li><a class="reference internal" href="#deprecated-ascii-interface">Deprecated ASCII Interface</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pypec-post-post-processing-fundamental-gpec-outputs"><code class="docutils literal"><span class="pre">pypec.post</span></code> – Post-Processing Fundamental GPEC Outputs</a><ul>
<li><a class="reference internal" href="#examples">Examples</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pypec-gpec-python-wrappers-for-fortran-codes"><code class="docutils literal"><span class="pre">pypec.gpec</span></code> – Python Wrappers for FORTRAN Codes</a></li>
<li><a class="reference internal" href="#pypec-namelist-io-for-fortran-namelists"><code class="docutils literal"><span class="pre">pypec.namelist</span></code> – IO for FORTRAN Namelists</a><ul>
<li><a class="reference internal" href="#id1">Examples</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pypec-modplot-matplotlib-customizations"><code class="docutils literal"><span class="pre">pypec.modplot</span></code> – matplotlib Customizations</a><ul>
<li><a class="reference internal" href="#id2">Examples</a></li>
</ul>
</li>
<li><a class="reference internal" href="#regression-compare-for-comparing-restults"><code class="docutils literal"><span class="pre">regression.compare</span></code> – For Comparing Restults</a><ul>
<li><a class="reference internal" href="#interface">Interface</a></li>
</ul>
</li>
</ul>
</li>
</ul>

<form action="search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
        </div>
      </div>
    <div class="col-md-12 content">
      
  <div class="section" id="module-pypec">
<span id="pypec-source-documentation"></span><span id="source-documentation"></span><h1>PYPEC Source documentation<a class="headerlink" href="#module-pypec" title="Permalink to this headline">¶</a></h1>
<div class="section" id="pypec-main-package">
<h2><a class="reference internal" href="#module-pypec" title="pypec"><code class="xref py py-mod docutils literal"><span class="pre">pypec</span></code></a> – Main Package<a class="headerlink" href="#pypec-main-package" title="Permalink to this headline">¶</a></h2>
<p>Python modules for data visualization and postprocessing, 
as well as python wrappers for GPEC and PENT.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Author:</th><td class="field-body">N.C. Logan</td>
</tr>
<tr class="field-even field"><th class="field-name">Location:</th><td class="field-body">Princeton Plasma Physics Laboratory</td>
</tr>
<tr class="field-odd field"><th class="field-name">Email:</th><td class="field-body"><a class="reference external" href="mailto:nlogan&#37;&#52;&#48;pppl&#46;gov">nlogan<span>&#64;</span>pppl<span>&#46;</span>gov</a></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="python-at-pppl">
<h2>Python at PPPL<a class="headerlink" href="#python-at-pppl" title="Permalink to this headline">¶</a></h2>
<p>To set up python on portal at PPPL, insert the 
following lines into your .bashrc file:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>export PYTHONPATH=$PYTHONPATH:/path/to/gpec
module load anaconda/2.3.0
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Anaconda is the most complete and current python distribution
available at pppl. Users can also use locally built python/2.7.2, but
will loose 3D plotting capabilities and may experience problems reading
large data files.</p>
</div>
<p>Obviously, “/path/to/gpec” needs to be replaced with the path
to your installation of the GPEC package (containing the pypec directory).</p>
<p>For tcsh shell users, replace export with setenv syntax
and insert in .cshrc.</p>
<dl class="docutils">
<dt>..note: Mayavi’s default gui api is not consistent with the anaconda</dt>
<dd>interactive python default. To enable 3D plotting, you must add
“export QT_API=pyqt” and “ETS_TOOLKIT=qt4” to your .bashrc or a similar 
line to your .cshrc.</dd>
</dl>
<p>To put the changes into effect:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$ source ~/.bashrc
</pre></div>
</div>
<p>Users are further encouraged to create a matplotlib rc file in
user ~/.config/matplotlib similar to /u/nlogan/.config/matplotlib/matplotlibrc.
This file sets a number of plotting defaults.</p>
<div class="section" id="python-tutorials">
<h3>Python Tutorials<a class="headerlink" href="#python-tutorials" title="Permalink to this headline">¶</a></h3>
<p>The 3 workhorse modules for scientific programming
in python are numpy, scipy and matplotlib (although
the third is really a personal preference). Tutorials
for each can be found at</p>
<p><a class="reference external" href="http://wiki.scipy.org/Tentative_NumPy_Tutorial">numpy tutorial</a></p>
<p><a class="reference external" href="http://docs.scipy.org/doc/scipy/reference/tutorial/">scipy tutorial</a></p>
<p><a class="reference external" href="http://matplotlib.org/users/pyplot_tutorial.html">matplotlib tutorial</a></p>
</div>
<div class="section" id="setting-your-personal-defaults">
<h3>Setting Your Personal Defaults<a class="headerlink" href="#setting-your-personal-defaults" title="Permalink to this headline">¶</a></h3>
<p>To set personal defaults for runs, edit the _defaults_.py file in
this directory. Some of these (like email) should be obvious, others
you may not understand until becoming more familiar with the package.
Do not worry if these are confusing, and feel free to skip them for now.</p>
</div>
<div class="section" id="using-the-best-environment">
<h3>Using the Best Environment<a class="headerlink" href="#using-the-best-environment" title="Permalink to this headline">¶</a></h3>
<p>The ipython (interactive) environment is recommended for commandline
data analysis. To start, it is easiest to auto-import a number of 
basic mathematics and visualization modules and use an enhanced
interactivity for displaying figures. To do this enter:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$ ipython
In [1]: import mayavi
In [2]: %pylab
</pre></div>
</div>
<p>Look into online tutorial on numpy and matplotlib. Advanced users 
are recommended to edit ~/.matplotlib/matplotlibrc and
~/.ipython/profile_default/startup/autoimports.ipy files.</p>
<p>Now in the ipython environment, type</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pypec</span> <span class="k">import</span> <span class="n">gpec</span><span class="p">,</span><span class="n">data</span> 
</pre></div>
</div>
<p>There may be a few warnings/hints… take them or leave them.</p>
</div>
</div>
<span class="target" id="module-pypec.data"></span><div class="section" id="pypec-data-pythonic-treatment-of-scientific-data">
<h2><a class="reference internal" href="#module-pypec.data" title="pypec.data"><code class="xref py py-mod docutils literal"><span class="pre">pypec.data</span></code></a> – Pythonic Treatment of Scientific Data<a class="headerlink" href="#pypec-data-pythonic-treatment-of-scientific-data" title="Permalink to this headline">¶</a></h2>
<p>The data module is a very generalized tool for visualizing and manipulating scientific data from netcdf and ascii files.</p>
<p>GPEC data is migrating to netcdf, and this module uses the xarray module for its python netcdf interface. The xarray module is very powerful and well documented <a class="reference external" href="http://xarray.readthedocs.org/">here</a>.</p>
<p>Previous GPEC results and some current outputs are still writen to ascii. This module contains a custom I/O for converting ascii data to python objects. A custom Data object was created for this purpose, and conversion to the xarray Dataset is automated in the open_dataset function to facilitate migration to netcdf. The only requirement for creating a data object from an ascii file is that the file have one or more tables of data, with appropriate labels in a header line directly above the data.</p>
<p>Here, we show some examples using common outputs from both GPEC and PENT.</p>
<div class="section" id="beginners">
<h3>Beginners<a class="headerlink" href="#beginners" title="Permalink to this headline">¶</a></h3>
<p>First, add your release of GPEC to your PYTHONPATH environment variable.</p>
<p>In an open ipython session, import the data module</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pypec</span> <span class="k">import</span> <span class="n">data</span>
</pre></div>
</div>
<p>Explore the data module by typing ‘data.’ and hitting tab. For information on any particular object in the module, use the ‘?’ syntax or ‘help’ function. For example, enter ‘data.read?’. You will see that it has a lot of metadata on this function, but the important things to look at for now are the arguments and key word arguments. These are passed to the function as shown in the Definition line… you can either pass a single string, or a string and specification for squeeze. If this confuses you, consult any of the many great python tutorials online.</p>
<p>Lets use it! To get a typical GPEC output into python, use the open_dataset function.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">con</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="s1">&#39;examples/DIIID_ideal_example/gpec_control_output_n1.nc&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Printing to the terminal is intelegent, giving a conviniently human readable summary of the data.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">con</span>
<span class="go">&lt;xarray.Dataset&gt;</span>
<span class="go">Dimensions:        (i: 2, m: 129, mode: 34, mode_PX: 34, mode_RX: 34, mode_SC: 4, mode_WX: 34, mode_XT: 34, theta: 513)</span>
<span class="go">Coordinates:</span>
<span class="go">  * i              (i) int32 0 1</span>
<span class="go">  * m              (m) int32 -64 -63 -62 -61 -60 -59 -58 -57 -56 -55 -54 -53 ...</span>
<span class="go">  * mode           (mode) int32 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 ...</span>
<span class="go">  * mode_SC        (mode_SC) int32 1 2 3 4</span>
<span class="go">  * theta          (theta) float64 0.0 0.001953 0.003906 0.005859 0.007812 ...</span>
<span class="go">  * mode_XT        (mode_XT) int32 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 ...</span>
<span class="go">  * mode_WX        (mode_WX) int32 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 ...</span>
<span class="go">  * mode_RX        (mode_RX) int32 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 ...</span>
<span class="go">  * mode_PX        (mode_PX) int32 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 ...</span>
<span class="go">Data variables:</span>
<span class="go">    L              (mode, m) complex128 (-0.478146242223-0.0251176845733j) ...</span>
<span class="go">    Lambda         (mode, m) complex128 (1.4032106893e-07-3.56355823737e-08j) ...</span>
<span class="go">    P              (mode, m) complex128 (0.000212307471204-9.52839135614e-05j) ...</span>
<span class="go">    rho            (mode, m) complex128 (9.96920996839e+36+9.96920996839e+36j) ...</span>
<span class="go">    X_EDT          (mode_XT, m) complex128 (3.88116613338e-05+1.90243722796e-05j) ...</span>
<span class="go">    X_EVT          (mode_XT) float64 2.517e+04 1.334e+05 5.081e+05 1.119e+06 ...</span>
<span class="go">    W_EDX          (mode_WX, m) complex128 (2.0673520088e-06-4.52521668335e-07j) ...</span>
<span class="go">    W_EVX          (mode_WX) float64 8.543 2.882 2.516 1.137 0.8107 0.6662 ...</span>
<span class="go">    W_EVX_A        (mode_WX) float64 3.922e+05 7.805e+04 2.466e+05 3.042e+05 ...</span>
<span class="go">    W_EVX_energyv  (mode_WX) float64 6.701e+06 4.499e+05 1.241e+06 6.917e+05 ...</span>
<span class="go">    W_EVX_energys  (mode_WX) float64 6.383e+06 8.481e+05 1.724e+06 6.867e+05 ...</span>
<span class="go">    W_EVX_energyp  (mode_WX) float64 6.817e+06 5.582e+05 8.381e+05 5.807e+05 ...</span>
<span class="go">    R_EDX          (mode_RX, m) complex128 (-9.04352944467e-07-5.23229281269e-07j) ...</span>
<span class="go">    R_EVX          (mode_RX) float64 1.881e+06 8.165e+05 2.477e+05 1.895e+05 ...</span>
<span class="go">    R_EVX_RL       (mode_RX) float64 5.689 0.7149 0.3795 0.8092 0.2417 ...</span>
<span class="go">    R_EVX_energyv  (mode_RX) float64 4.298e+05 1.373e+06 1.01e+06 7.832e+05 ...</span>
<span class="go">    R_EVX_energys  (mode_RX) float64 8.994e+05 1.745e+06 1.096e+06 8.803e+05 ...</span>
<span class="go">    R_EVX_energyp  (mode_RX) float64 3.785e+05 8.975e+05 8.31e+05 6.814e+05 ...</span>
<span class="go">    P_EDX          (mode_PX, m) complex128 (-5.0711563448e-06-2.51239391938e-06j) ...</span>
<span class="go">    P_EVX          (mode_PX) float64 493.5 161.8 146.4 128.7 127.8 110.2 ...</span>
<span class="go">    O_WRX          (mode_RX, mode_WX) float64 0.082 0.99 0.08839 0.01132 ...</span>
<span class="go">    O_WPX          (mode_PX, mode_WX) float64 0.01414 0.9607 0.08296 0.01058 ...</span>
<span class="go">    O_RPX          (mode_PX, mode_RX) float64 0.9571 0.01583 0.02807 0.1558 ...</span>
<span class="go">    O_XT           (mode_XT) complex128 (0.00296215168999+0.00489536349583j) ...</span>
<span class="go">    O_WX           (mode_XT) complex128 (0.0101206436883-0.00397946238035j) ...</span>
<span class="go">    O_RX           (mode_RX) complex128 (-0.00967090555989-0.000112969521773j) ...</span>
<span class="go">    O_PX           (mode_PX) complex128 (-0.00598278876631+0.0105074013581j) ...</span>
<span class="go">    Phi_EX         (m) complex128 (-1.42853908779e-10-4.20811059626e-11j) ...</span>
<span class="go">    Phi_ET         (m) complex128 (-6.89310992668e-10-1.01978717443e-09j) ...</span>
<span class="go">    W_EDX_FUN      (mode_WX, theta) complex128 (-1.45421344314-0.0472501327701j) ...</span>
<span class="go">    R_EDX_FUN      (mode_RX, theta) complex128 (1.45665015126-0.521253285202j) ...</span>
<span class="go">    b_nm           (m) complex128 (-9.46126704696e-10+1.48737377032e-09j) ...</span>
<span class="go">    b_xnm          (m) complex128 (-5.48365827795e-10+5.89720875704e-10j) ...</span>
<span class="go">    xi_nm          (m) complex128 (-3.3871234611e-09-1.86371281018e-09j) ...</span>
<span class="go">    xi_xnm         (m) complex128 (-6.60388933097e-10+2.7635104984e-09j) ...</span>
<span class="go">    xi_n           (theta) complex128 (0.000402066428626+0.00260098774146j) ...</span>
<span class="go">    xi_xn          (theta) complex128 (-0.000601114809848-0.00197978522356j) ...</span>
<span class="go">    b_n            (theta) complex128 (-0.00157772177652+0.00052698051739j) ...</span>
<span class="go">    b_xn           (theta) complex128 (-0.000920387597747+0.000315158824532j) ...</span>
<span class="go">    R              (theta) float64 2.289 2.289 2.288 2.287 2.286 2.284 2.282 ...</span>
<span class="go">    z              (theta) float64 0.02442 0.03972 0.05506 0.07046 0.08596 ...</span>
<span class="go">    R_n            (theta) float64 1.0 0.9995 0.9981 0.9959 0.9928 0.9889 ...</span>
<span class="go">    z_n            (theta) float64 0.003568 0.03241 0.06134 0.09036 0.1195 ...</span>
<span class="go">    dphi           (theta) float64 0.0 -0.039 -0.078 -0.117 -0.1559 -0.1948 ...</span>
<span class="go">Attributes:</span>
<span class="go">    title: GPEC outputs in Fourier or alternate modal bases</span>
<span class="go">    Jacobian: pest</span>
<span class="go">    q_lim: 5.2</span>
<span class="go">    psi_n_lim: 0.991536136179</span>
<span class="go">    shot: 147131</span>
<span class="go">    time: 2300</span>
<span class="go">    machine: DIII-D</span>
<span class="go">    n: 1</span>
<span class="go">    version: GPEC version 0.3.1</span>
<span class="go">    long_name: Surface Inductance</span>
<span class="go">    energy_vacuum: 3.28697635252</span>
<span class="go">    energy_surface: 7.8714975121</span>
<span class="go">    energy_plasma: 3.7597335618</span>
</pre></div>
</div>
<p>We see the data contains dimensions, variables, and global attributes. Some individual data arrays may have attributes as well.</p>
<p>For quick visualization, we can use xarray’s built in plotting routines,</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">xarray.plot</span> <span class="k">as</span> <span class="nn">xplot</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f1</span><span class="p">,</span><span class="n">a1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l1</span> <span class="o">=</span> <span class="n">xplot</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">con</span><span class="p">[</span><span class="s1">&#39;W_EVX&#39;</span><span class="p">])</span> <span class="c1"># 1D data, returns a list of lines</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f1</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;examples/figures/example_eigenvalues.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/example_eigenvalues.png"><img alt="_images/example_eigenvalues.png" src="_images/example_eigenvalues.png" style="width: 600px;" /></a>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">f2</span><span class="p">,</span><span class="n">a2</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l2</span> <span class="o">=</span> <span class="n">xplot</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">con</span><span class="p">[</span><span class="s1">&#39;W_EDX&#39;</span><span class="p">])</span> <span class="c1"># This is 2D, returns Quadmesh</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f2</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;examples/figures/example_eigenvectors.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/example_eigenvectors.png"><img alt="_images/example_eigenvectors.png" src="_images/example_eigenvectors.png" style="width: 600px;" /></a>
<p>Note this uses matplotlib, and the plots are fully interactive. Navigate and zoom using the toolbar below plots.</p>
<p>This is not the recommended way to display detailed studies using GPEC data, however. It is
recommended that the user familiarise themselves with matplotlib (there are many great online
tutorials) and write their own scripts for plotting the data of interest, as details will
inevitably need tweaking.</p>
<p>For a common example of more customized plots, lets look at some 2d data</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cyl</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="s1">&#39;examples/DIIID_ideal_example/gpec_cylindrical_output_n1.nc&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>We could use the built in plotting methods like ds[‘b_z’].plot), but these are (R,z) figures
should be done with a little care to look right. Lets look at b_z for example,</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">plt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">v</span> <span class="o">=</span> <span class="n">cyl</span><span class="p">[</span><span class="s1">&#39;b_z&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">im</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">v</span><span class="p">),</span><span class="n">aspect</span><span class="o">=</span><span class="s1">&#39;equal&#39;</span><span class="p">,</span><span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;RdBu&#39;</span><span class="p">,</span><span class="n">vmin</span><span class="o">=-</span><span class="mf">2e-3</span><span class="p">,</span><span class="n">vmax</span><span class="o">=</span><span class="mf">2e-3</span><span class="p">,</span>
<span class="gp">... </span>         <span class="n">extent</span><span class="o">=</span><span class="p">[</span><span class="n">v</span><span class="p">[</span><span class="s1">&#39;R&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span><span class="n">v</span><span class="p">[</span><span class="s1">&#39;R&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span><span class="n">v</span><span class="p">[</span><span class="s1">&#39;z&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span><span class="n">v</span><span class="p">[</span><span class="s1">&#39;z&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()],</span>
<span class="gp">... </span>         <span class="n">interpolation</span><span class="o">=</span><span class="s1">&#39;gaussian&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cb</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cb</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s1">&#39;$\delta B_z$&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xtks</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mf">1.7</span><span class="p">,</span><span class="mf">2.4</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xtxt</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;R (m)&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ytxt</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;z (m)&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;examples/figures/example_pbrzphi.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/example_pbrzphi.png"><img alt="_images/example_pbrzphi.png" src="_images/example_pbrzphi.png" style="width: 600px;" /></a>
<p>There we go. That looks publication ready!</p>
<p>Another common plot of GPEC outputs is the (psi,m) spectrogram plot. Lets quickly make a
nice one,</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">prof</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="s1">&#39;examples/DIIID_ideal_example/gpec_profile_output_n1.nc&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">extent</span> <span class="o">=</span> <span class="p">[</span><span class="n">prof</span><span class="p">[</span><span class="s1">&#39;m&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span><span class="n">prof</span><span class="p">[</span><span class="s1">&#39;m&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span><span class="n">prof</span><span class="p">[</span><span class="s1">&#39;psi_n&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span><span class="n">prof</span><span class="p">[</span><span class="s1">&#39;psi_n&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">im</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">prof</span><span class="p">[</span><span class="s1">&#39;xi_m_contrapsi&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">T</span><span class="p">,</span><span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">,</span>
<span class="gp">... </span>               <span class="n">interpolation</span><span class="o">=</span><span class="s1">&#39;nearest&#39;</span><span class="p">,</span><span class="n">aspect</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span><span class="n">extent</span><span class="o">=</span><span class="n">extent</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cb</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cb</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\xi^\psi_m$&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lim</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">20</span><span class="p">,</span><span class="mi">20</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xtxt</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;m&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ytxt</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\psi$&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;examples/figures/example_xispectrogram.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/example_xispectrogram.png"><img alt="_images/example_xispectrogram.png" src="_images/example_xispectrogram.png" style="width: 600px;" /></a>
<p>Note that the choice of interpolation resulted in discrete bands in m, which is true
to the the discrete fourier decomposition used in the codes and provides a more intuitive
connection between what the user sees and what the code is calculating.</p>
<p>One of the many cool additions to matplotlib in the pypec package is the ability to
write line plots to tables. Lets look at a 1D mode spectrum plot for example,</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">9</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">lines</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">prof</span><span class="p">[</span><span class="s1">&#39;psi_n&#39;</span><span class="p">],</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">prof</span><span class="p">[</span><span class="s1">&#39;xi_m_contrapsi&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">m</span><span class="o">=</span><span class="n">m</span><span class="p">)),</span><span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;m=</span><span class="si">{:}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">m</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mappable</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">set_linearray</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">lines</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ytxt</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\xi^\psi_m$&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xtxt</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\psi$&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">leg</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">ncol</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;examples/figures/example_xim.png&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">printlines</span><span class="p">(</span><span class="s1">&#39;examples/figures/example_xim.txt&#39;</span><span class="p">,</span><span class="n">squeeze</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">Wrote lines to examples/figures/example_xim.txt</span>
<span class="go">True</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/example_xim.png"><img alt="_images/example_xim.png" src="_images/example_xim.png" style="width: 600px;" /></a>
<p>That’s it! Read the table with your favorite editor. It will probably need a little
cleaning at the top since it tries to use the lengthy legend labels as column headers.</p>
<p>At this point we have outlined the basics. Using this module and similar commands
to those used here the user should be able to fully interact with and visually
explore the GPEC output.</p>
</div>
<div class="section" id="advanced-users">
<h3>Advanced Users<a class="headerlink" href="#advanced-users" title="Permalink to this headline">¶</a></h3>
<p>In this section, we will assume you have a pretty good hold on both python and the basic ploting functions of these modules.</p>
<p>Now that you use this module regularly, save yourself some time by placing the line:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pypec</span> <span class="k">import</span> <span class="o">*</span>
</pre></div>
</div>
<p>into your autoimport file located at:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">~/.</span><span class="n">ipython</span><span class="o">/</span><span class="n">profile_default</span><span class="o">/</span><span class="n">startup</span><span class="o">/</span><span class="n">autoimports</span><span class="o">.</span><span class="n">ipy</span>
</pre></div>
</div>
</div>
<div class="section" id="deprecated-ascii-interface">
<h3>Deprecated ASCII Interface<a class="headerlink" href="#deprecated-ascii-interface" title="Permalink to this headline">¶</a></h3>
<p>As mentioned above, GPEC has moved the vast majority of its I/O to netcdf, and open_dataset should
be used to create xarray Dataset objects whenever possible. This section describes the deprecated
ascii interface for context, and motivates the move to netcdf.</p>
<p>Data in ascii tables can be read into a custom Data object using the read function,</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mydata</span> <span class="o">=</span> <span class="n">read</span><span class="p">(</span><span class="s1">&#39;examples/DIIID_ideal_example/g147131.02300_DIIID_KEFIT.kin&#39;</span><span class="p">)</span>
<span class="go">Casting table 1 into Data object.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">type</span><span class="p">(</span><span class="n">mydata</span><span class="p">),</span><span class="nb">len</span><span class="p">(</span><span class="n">mydata</span><span class="p">)</span>
<span class="go">(&lt;type &#39;list&#39;&gt;, 1)</span>
</pre></div>
</div>
<p>The read function creates a list of data objects corresponding to the tables in the text file. In this case, there is only one table. If we knew this ahead of time, we could have gotten the data object directly by splitting the list.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mydata</span> <span class="o">=</span> <span class="n">read</span><span class="p">(</span><span class="s1">&#39;examples/DIIID_ideal_example/g147131.02300_DIIID_KEFIT.kin&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">Casting table 1 into Data object.</span>
</pre></div>
</div>
<p>At its heart, the data object consists of independent data and dependent data. This are stored differently, namely as a list in the pts attribute and as a dictionary in y. The x attribute is a dictionary if the data is 1 dimensional or a regular grid is found in the first n columns of the data (n=2,3), and left empty if the n&gt;1 dependent data is irregular.</p>
<p>Explore the data using the corresponding python tools.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mydata</span><span class="o">.</span><span class="n">xnames</span>
<span class="go">[&#39;psi&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mydata</span><span class="o">.</span><span class="n">y</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
<span class="go">[&#39;nim^3&#39;, &#39;tieV&#39;, &#39;teeV&#39;, &#39;wexbrad/s&#39;, &#39;nem^3&#39;]</span>
</pre></div>
</div>
<p>You would access the ion density data using mydata.y[‘nim3’] for example.</p>
<p>The data object, however, is more that just a place holder for parced text files. It contains visualization and data manipulation tools. Plotting functions return interactive matplotlib Figure objects.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span> <span class="o">=</span> <span class="n">mydata</span><span class="o">.</span><span class="n">plot1d</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;examples/figures/example_profiles.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/example_profiles.png"><img alt="_images/example_profiles.png" src="_images/example_profiles.png" style="width: 600px;" /></a>
<p>Interpolation returns a new Data object of the desired data, which can be one, multiple, or all of the dependent variables found in y.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">myinterp</span> <span class="o">=</span> <span class="n">mydata</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">0.1</span><span class="p">),[</span><span class="s1">&#39;nim^3&#39;</span><span class="p">,</span><span class="s1">&#39;tieV&#39;</span><span class="p">])</span>
<span class="go">Forming interpolator for nim^3.</span>
<span class="go">Interpolating values for nim^3.</span>
<span class="go">Forming interpolator for tieV.</span>
<span class="go">Interpolating values for tieV.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">mydata</span><span class="o">.</span><span class="n">plot1d</span><span class="p">(</span><span class="s1">&#39;nim^3&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">myinterp</span><span class="o">.</span><span class="n">plot1d</span><span class="p">(</span><span class="s1">&#39;nim^3&#39;</span><span class="p">,</span><span class="n">marker</span><span class="o">=</span><span class="s1">&#39;s&#39;</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">figure</span><span class="o">=</span><span class="n">f</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;examples/figures/example_profiles2.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/example_profiles2.png"><img alt="_images/example_profiles2.png" src="_images/example_profiles2.png" style="width: 400px;" /></a>
<p>Note that the interpolator initialized the interpolation function on the first call, this is saved internally for subsequent calls.</p>
<p>One common need is to look at spectra. For this we want to utilize
the full functionality of the data instances’ plot1d function.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">xc</span><span class="p">,</span> <span class="o">=</span> <span class="n">read</span><span class="p">(</span><span class="s1">&#39;examples/DIIID_ideal_example/gpec_xclebsch_n1.out&#39;</span><span class="p">)</span>
<span class="go">Casting table 1 into Data object.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">xc</span><span class="o">.</span><span class="n">plot1d</span><span class="p">(</span><span class="s1">&#39;xi^psi&#39;</span><span class="p">,</span><span class="s1">&#39;psi&#39;</span><span class="p">,</span><span class="n">x2rng</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;examples/figures/example_spectrum.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/example_spectrum.png"><img alt="_images/example_spectrum.png" src="_images/example_spectrum.png" style="width: 600px;" /></a>
<p>We knew it was one table, so we used the “,” to automatically
unpack returned list. We were then so familiar with the args and
kwargs of the plotting function that we did not bother typing the names.
If you do this, be sure you get the order consistent with the order
given in the documentation “Definition” line (watch out for inconsistent
“Docstring” listings).</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>These examples can be tested by developers using ipython 
in this directory as follows:</p>
<blockquote class="last">
<div><p>In [1]: import data,doctest</p>
<p>In [2]: doctest.testmod(data,verbose=True)</p>
</div></blockquote>
</div>
<dl class="class">
<dt id="pypec.data.DataBase">
<em class="property">class </em><code class="descclassname">pypec.data.</code><code class="descname">DataBase</code><span class="sig-paren">(</span><em>fromtxt</em>, <em>preamble</em>, <em>forcex=[]</em>, <em>forcedim=[]</em>, <em>maxlength=1000000.0</em>, <em>auto_complex=True</em>, <em>quiet=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pypec/data.html#DataBase"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypec.data.DataBase" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.7)"><code class="xref py py-class docutils literal"><span class="pre">object</span></code></a></p>
<p>An emtpy class object with the following operations overloaded:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">+</span><span class="p">,</span><span class="o">-</span><span class="p">,</span><span class="o">*</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="o">**</span>
</pre></div>
</div>
<p>such that the operation is only performed on the attributes 
starting with .real_ and .imag_ and ending with r,z, or phi. 
If the two factors in the operation have different r or z attributes
data is interpolated to the wider spaced axis.</p>
<dl class="method">
<dt id="pypec.data.DataBase.interp">
<code class="descname">interp</code><span class="sig-paren">(</span><em>x</em>, <em>ynames=None</em>, <em>quiet=False</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pypec/data.html#DataBase.interp"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypec.data.DataBase.interp" title="Permalink to this definition">¶</a></dt>
<dd><p>Interpolate data to point(s).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> – ndarray shape (npts,ndim). Point(s) on dependent axis(axes).</li>
<li><strong>ynames</strong> – list. Any number of keys from y attribute</li>
<li><strong>quiet</strong> – bool. Suppress status messages</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">dict. Each name contains array of interpolated data.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pypec.data.DataBase.plot1d">
<code class="descname">plot1d</code><span class="sig-paren">(</span><em>ynames=None</em>, <em>xname=None</em>, <em>x1rng=None</em>, <em>x2rng=None</em>, <em>x3rng=None</em>, <em>squeeze=False</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pypec/data.html#DataBase.plot1d"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypec.data.DataBase.plot1d" title="Permalink to this definition">¶</a></dt>
<dd><p>Line plots of from 1D or 2D data.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>ynames</strong> – list. Strings specifying dependent data displayed.</li>
<li><strong>xname</strong> – string. The independent axis if 2D data.</li>
<li><strong>x1rng</strong> – optional. Valid formats are,
x - Plot single nearest point.
(xmin,xmax) - Plots all data in range (min,max).
(xmin,xmax,n) - Plots n evenly spaced points in range.</li>
<li><strong>x2rng</strong> – Same as x1rng. Applicable to 2D or 3D data.</li>
<li><strong>x3rng</strong> – Same as x2rng for 3D data only. Order of x is xnames with xname placed in front if given.</li>
<li><strong>squeeze</strong> – bool. Plots all ynames in same axis.</li>
<li><strong>kwargs</strong> – dict. Valid matplotlib pyplot.plot keyword arguments.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">figure.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pypec.data.DataBase.plot2d">
<code class="descname">plot2d</code><span class="sig-paren">(</span><em>ynames=None</em>, <em>aspect='auto'</em>, <em>plot_type='imshow'</em>, <em>cbar=True</em>, <em>center=None</em>, <em>grid_size=(256</em>, <em>256)</em>, <em>swap=False</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pypec/data.html#DataBase.plot2d"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypec.data.DataBase.plot2d" title="Permalink to this definition">¶</a></dt>
<dd><p>Matplotlib 2D plots of the data.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>ynames</strong> – list. Strings specifying dependent data displayed.</li>
<li><strong>aspect</strong> – str/float. Choose from ‘auto’ or ‘equal’ (see matplotlib axes.set_aspect). A float stretches a circle to hight=aspect*width.</li>
<li><strong>plot_type</strong> – str. Choose one of,
“imshow”       - Use matplotlib imshow to plot on grid.
“pcolormesh”   - Use matplotlib pcolormesh to plot on grid.
“contour”      - Use matplotlib contour to plot on grid.
“contourf”     - Use matplotlib contourf to plot on grid.
“tripcolor”    - Use matplotlib tripcolor to plot raw points.
“tripcontour”  - Use matplotlib tripcontour to plot raw points.
“tripcontourf” - Use matplotlib tripcontourf to plot raw points.</li>
<li><strong>cbar</strong> – bool. Show colorbar.</li>
<li><strong>grid_size</strong> – tuple. Size of grid used if no regular axes x (in order of xnames).</li>
<li><strong>swap</strong> – bool. Swap x/y axes.</li>
<li><strong>kwargs</strong> – dict. Valid pcolormesh/contour/contourf key arguments.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">figure.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pypec.data.DataBase.plot3d">
<code class="descname">plot3d</code><span class="sig-paren">(</span><em>ynames=None</em>, <em>filter={'psi': 1}</em>, <em>cbar=False</em>, <em>size=(600</em>, <em>600)</em>, <em>plot_type=''</em>, <em>phi=None</em>, <em>center=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pypec/data.html#DataBase.plot3d"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypec.data.DataBase.plot3d" title="Permalink to this definition">¶</a></dt>
<dd><p>Three dimensional plots. Data with xnames r,z will be plotted
with third dimension phi where Y = Re[y]cos(n*phi)+Im[y]sin(n*phi).</p>
<blockquote>
<div><ul class="simple">
<li>1D data &gt; lines in a plane in 3-space.</li>
<li>2D data &gt; z axis becomes y value</li>
<li>3D data &gt; chosen display type</li>
</ul>
</div></blockquote>
<p>Must have mayavi.mlab module available in pythonpath.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>ynames</strong> – list. Strings specifying dependent data displayed.</li>
<li><strong>filter</strong> – dict. Filter points as only those closest to this y value.</li>
<li><strong>cbar</strong> – bool. Display a vertical colorbar in the Mayavi Scene.</li>
<li><strong>size</strong> – tuple. Size of figure in pixels.</li>
<li><strong>plot_type</strong> – str. Valid mayavi.mlab function name. Overrides default function choices (plot3d,mesh,quiver3d).</li>
<li><strong>phi</strong> – ndarray. Toroidal angle grid for complex 2D data. Default is 360 degrees, 180 pts.</li>
<li><strong>center</strong> – float. Center colormap on this value.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">figure.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pypec.data.DataBase.scatter">
<code class="descname">scatter</code><span class="sig-paren">(</span><em>ynames=None</em>, <em>xname=None</em>, <em>x1=None</em>, <em>x2=None</em>, <em>x3=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pypec/data.html#DataBase.scatter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypec.data.DataBase.scatter" title="Permalink to this definition">¶</a></dt>
<dd><p>Scatter plot display for non-regular data. Display mimics plot1d in t
hat it displays a single independent axis. If is another independent 
axis exists, and is not sliced using one of the optional keyword arguments, 
it s represented as the color of the plotted symbols. If the data is 3D 
and unsliced, preference if given in order of xnames.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>ynames</strong> – list. Dependent data to be displayed. Default is all y data.</li>
<li><strong>xname</strong> – str. Independent axis used in scatter plots. Default is first in xnames.</li>
<li><strong>x1</strong> – float. Use only data with first axis clossest to value.</li>
<li><strong>x2</strong> – float. Use only data with second axis clossest to value.</li>
<li><strong>x3</strong> – float. Use only data with thrid axis clossest to value.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">figure.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pypec.data.DataBase.slice">
<code class="descname">slice</code><span class="sig-paren">(</span><em>x</em>, <em>xname=None</em>, <em>ynames=[]</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pypec/data.html#DataBase.slice"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypec.data.DataBase.slice" title="Permalink to this definition">¶</a></dt>
<dd><p><em>UNDER CONSTRUCTION</em></p>
<p>Return 1D data object from 2D. Method grids new data, 
so beware of loosing accuracy near rational surfaces.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> – float. Lower bound of the axis.</li>
<li><strong>xname</strong> – str. Axis allong which slice is performed.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">obj. New data nd-1 dimensional data object.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="pypec.data.getshot">
<code class="descclassname">pypec.data.</code><code class="descname">getshot</code><span class="sig-paren">(</span><em>path='.'</em>, <em>full_name=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pypec/data.html#getshot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypec.data.getshot" title="Permalink to this definition">¶</a></dt>
<dd><p>Find 6 digit shot number in path to directory or file.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>d</strong> – str. Path.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">str. Shot number if found, ‘’ if not.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pypec.data.open_dataset">
<code class="descclassname">pypec.data.</code><code class="descname">open_dataset</code><span class="sig-paren">(</span><em>filename_or_obj</em>, <em>complex_dim='i'</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pypec/data.html#open_dataset"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypec.data.open_dataset" title="Permalink to this definition">¶</a></dt>
<dd><p>Wrapper for xarray.open_dataset that allows automated reduction of
a dimension distinguishing real and imaginary components.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>filename_or_obj</strong> – str, file or xarray.backends.DataStore
Strings are interpreted as a path to a netCDF file or an OpenDAP URL
and opened with python-netCDF4, unless the filename ends with .gz, in
which case the file is gunzipped and opened with scipy.io.netcdf
(only netCDF3 supported). File-like objects are opened with
scipy.io.netcdf (only netCDF3 supported).</li>
<li><strong>complex_dim</strong> – str. Dimension designating real/imaginary (0,1)</li>
<li><strong>kwargs</strong> – dict. All other key word arguments are passed to xarray.open_dataset.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p><strong>Original Documentation:</strong></p>
<p>Load and decode a dataset from a file or file-like object.</p>
<p>Parameters</p>
<dl class="docutils">
<dt>filename_or_obj <span class="classifier-delimiter">:</span> <span class="classifier">str, Path, file or xarray.backends.*DataStore</span></dt>
<dd>Strings and Path objects are interpreted as a path to a netCDF file
or an OpenDAP URL and opened with python-netCDF4, unless the filename
ends with .gz, in which case the file is gunzipped and opened with
scipy.io.netcdf (only netCDF3 supported). File-like objects are opened
with scipy.io.netcdf (only netCDF3 supported).</dd>
<dt>group <span class="classifier-delimiter">:</span> <span class="classifier">str, optional</span></dt>
<dd>Path to the netCDF4 group in the given file to open (only works for
netCDF4 files).</dd>
<dt>decode_cf <span class="classifier-delimiter">:</span> <span class="classifier">bool, optional</span></dt>
<dd>Whether to decode these variables, assuming they were saved according
to CF conventions.</dd>
<dt>mask_and_scale <span class="classifier-delimiter">:</span> <span class="classifier">bool, optional</span></dt>
<dd>If True, replace array values equal to <cite>_FillValue</cite> with NA and scale
values according to the formula <cite>original_values * scale_factor +
add_offset</cite>, where <cite>_FillValue</cite>, <cite>scale_factor</cite> and <cite>add_offset</cite> are
taken from variable attributes (if they exist).  If the <cite>_FillValue</cite> or
<cite>missing_value</cite> attribute contains multiple values a warning will be
issued and all array values matching one of the multiple values will
be replaced by NA. mask_and_scale defaults to True except for the 
pseudonetcdf backend.</dd>
<dt>decode_times <span class="classifier-delimiter">:</span> <span class="classifier">bool, optional</span></dt>
<dd>If True, decode times encoded in the standard NetCDF datetime format
into datetime objects. Otherwise, leave them encoded as numbers.</dd>
<dt>autoclose <span class="classifier-delimiter">:</span> <span class="classifier">bool, optional</span></dt>
<dd>If True, automatically close files to avoid OS Error of too many files
being open.  However, this option doesn’t work with streams, e.g.,
BytesIO.</dd>
<dt>concat_characters <span class="classifier-delimiter">:</span> <span class="classifier">bool, optional</span></dt>
<dd>If True, concatenate along the last dimension of character arrays to
form string arrays. Dimensions will only be concatenated over (and
removed) if they have no corresponding variable and if they are only
used as the last dimension of character arrays.</dd>
<dt>decode_coords <span class="classifier-delimiter">:</span> <span class="classifier">bool, optional</span></dt>
<dd>If True, decode the ‘coordinates’ attribute to identify coordinates in
the resulting dataset.</dd>
<dt>engine <span class="classifier-delimiter">:</span> <span class="classifier">{‘netcdf4’, ‘scipy’, ‘pydap’, ‘h5netcdf’, ‘pynio’, ‘pseudonetcdf’}, optional</span></dt>
<dd>Engine to use when reading files. If not provided, the default engine
is chosen based on available dependencies, with a preference for
‘netcdf4’.</dd>
<dt>chunks <span class="classifier-delimiter">:</span> <span class="classifier">int or dict, optional</span></dt>
<dd>If chunks is provided, it used to load the new dataset into dask
arrays. <code class="docutils literal"><span class="pre">chunks={}</span></code> loads the dataset with dask using a single
chunk for all arrays.</dd>
<dt>lock <span class="classifier-delimiter">:</span> <span class="classifier">False, True or threading.Lock, optional</span></dt>
<dd>If chunks is provided, this argument is passed on to
<code class="xref py py-func docutils literal"><span class="pre">dask.array.from_array()</span></code>. By default, a global lock is
used when reading data from netCDF files with the netcdf4 and h5netcdf
engines to avoid issues with concurrent access when using dask’s
multithreaded backend.</dd>
<dt>cache <span class="classifier-delimiter">:</span> <span class="classifier">bool, optional</span></dt>
<dd>If True, cache data loaded from the underlying datastore in memory as
NumPy arrays when accessed to avoid reading from the underlying data-
store multiple times. Defaults to True unless you specify the <cite>chunks</cite>
argument to use dask, in which case it defaults to False. Does not
change the behavior of coordinates corresponding to dimensions, which
always load their data from disk into a <code class="docutils literal"><span class="pre">pandas.Index</span></code>.</dd>
<dt>drop_variables: string or iterable, optional</dt>
<dd>A variable or list of variables to exclude from being parsed from the
dataset. This may be useful to drop variables with problems or
inconsistent values.</dd>
<dt>backend_kwargs: dictionary, optional</dt>
<dd>A dictionary of keyword arguments to pass on to the backend. This
may be useful when backend options would improve performance or 
allow user control of dataset processing.</dd>
</dl>
<p>Returns
-
dataset : Dataset</p>
<blockquote>
<div>The newly created dataset.</div></blockquote>
<p>See Also</p>
<p>open_mfdataset</p>
</dd></dl>

<dl class="function">
<dt id="pypec.data.plotall">
<code class="descclassname">pypec.data.</code><code class="descname">plotall</code><span class="sig-paren">(</span><em>results</em>, <em>xfun</em>, <em>yfun</em>, <em>label=''</em>, <em>axes=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pypec/data.html#plotall"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypec.data.plotall" title="Permalink to this definition">¶</a></dt>
<dd><p>Line plot of data gethered recursively from a dictionary 
containing multiple namelists or data objects.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>results</strong> – dict. A readall result.</li>
<li><strong>xfun</strong> – func. A function that takes args (key,val) for each dictionary item and whose result is appended to the xaxis.</li>
<li><strong>yfun</strong> – func. A function that takes args (key,val) for each dictionary item and whose result is appended to the yaxis.</li>
<li><strong>axes</strong> – obj. matplotlib axes object.</li>
<li><strong>kwargs</strong> – dict. Passed to matplotlib plot function</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">figure.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pypec.data.read">
<code class="descclassname">pypec.data.</code><code class="descname">read</code><span class="sig-paren">(</span><em>fname</em>, <em>squeeze=False</em>, <em>forcex=[]</em>, <em>forcedim=[]</em>, <em>maxnumber=999</em>, <em>maxlength=1000000.0</em>, <em>auto_complex=True</em>, <em>quiet=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pypec/data.html#read"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypec.data.read" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the data from any gpec output as a list of python
class-type objects using numpy.genfromtxt.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>fname</strong> – str. Path of gpec output file.</li>
<li><strong>squeeze</strong> – bool. Sets all attributes to single data object.</li>
<li><strong>forcex</strong> – list. Set independent data labels.</li>
<li><strong>forcedim</strong> – list. Set dimensionality of each x.</li>
<li><strong>maxnumber</strong> – int. Reads only first maxnumber of tables.</li>
<li><strong>maxlength</strong> – int. Tables with more rows than this are downsampled for speed.</li>
<li><strong>auto_complex</strong> – bool. Include amplitude and phase of complex data as variables.</li>
<li><strong>quiet</strong> – bool. Prevent non-warning messages printed to terminal.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">list. Class objects for each block of data in the file.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pypec.data.readall">
<code class="descclassname">pypec.data.</code><code class="descname">readall</code><span class="sig-paren">(</span><em>base='.'</em>, <em>filetype='pent_n1.out'</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pypec/data.html#readall"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypec.data.readall" title="Permalink to this definition">¶</a></dt>
<dd><p>Recursively searches base directory for files with name
filetype, reads them into python objects, and stores 
objects in a dictionary with directory names as keys.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>base</strong> – str. Top level directory in which to begin search.</li>
<li><strong>filetype</strong> – str. Files to read.</li>
<li><strong>kwargs</strong> – dict. Passed to appropriate reader function.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">dict. Key-Value pairs are directories and their contained data.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pypec.data.write">
<code class="descclassname">pypec.data.</code><code class="descname">write</code><span class="sig-paren">(</span><em>dataobj</em>, <em>fname=''</em>, <em>ynames=[]</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pypec/data.html#write"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypec.data.write" title="Permalink to this definition">¶</a></dt>
<dd><p>Write data object to file. The aim is to replicate the original file
structure… the header text will have been lost in the read however,
as will some column label symbols in the use of genfromtxt.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>dataobj</strong> – obj. Data_Base type object.</li>
<li><strong>fname</strong> – str. File to write to.</li>
<li><strong>kwargs</strong> – dict. Passed to numpy.savetxt</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">bool. True.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
</div>
<span class="target" id="module-pypec.post"></span><div class="section" id="pypec-post-post-processing-fundamental-gpec-outputs">
<h2><a class="reference internal" href="#module-pypec.post" title="pypec.post"><code class="xref py py-mod docutils literal"><span class="pre">pypec.post</span></code></a> – Post-Processing Fundamental GPEC Outputs<a class="headerlink" href="#pypec-post-post-processing-fundamental-gpec-outputs" title="Permalink to this headline">¶</a></h2>
<p>The post module is a repository of basic post-processing functions for expanding,
manipulating, and visualizing fundamental gpec output. This is not an exhaustive
list of post-processing procedures. The focus is on a) transforming between
coordinate systems and b) matrix optimizations.</p>
<p>Here, we show some examples using common outputs.</p>
<div class="section" id="examples">
<h3>Examples<a class="headerlink" href="#examples" title="Permalink to this headline">¶</a></h3>
<p>First, add your release of GPEC to your PYTHONPATH environment variable.</p>
<p>In an open ipython session, import the data module</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pypec</span> <span class="k">import</span> <span class="n">data</span><span class="p">,</span> <span class="n">post</span>
</pre></div>
</div>
<p>To get a typical GPEC output into python, use the open_dataset function.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">con</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="s1">&#39;examples/DIIID_ideal_example/gpec_control_output_n1.nc&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">prof</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="s1">&#39;examples/DIIID_ideal_example/gpec_profile_output_n1.nc&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>First, 3D equilibrium calculations lend themselves naturally to 3D figures. This module
has a helpful function for forming the necessary x,y,z meshes from the 2D boundary.
After adding the requisite geometry to the control surface output,</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">con</span> <span class="o">=</span> <span class="n">add_3dsurface</span><span class="p">(</span><span class="n">con</span><span class="p">,</span> <span class="n">phi_lim</span><span class="o">=</span><span class="n">pi</span> <span class="o">*</span> <span class="mf">1.5</span><span class="p">)</span>
</pre></div>
</div>
<p>it is easy to make 3D surface plots using mayavi,</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span> <span class="o">=</span> <span class="n">con</span><span class="p">[</span><span class="s1">&#39;x_surf&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span><span class="n">con</span><span class="p">[</span><span class="s1">&#39;y_surf&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span><span class="n">con</span><span class="p">[</span><span class="s1">&#39;z_surf&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b_n_3d</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">con</span><span class="p">[</span><span class="s1">&#39;b_n_fun&#39;</span><span class="p">]</span><span class="o">*</span><span class="n">con</span><span class="p">[</span><span class="s1">&#39;phase_surf&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span> <span class="o">=</span> <span class="n">mmlab</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">bgcolor</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">fgcolor</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span><span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">600</span><span class="p">,</span><span class="mi">600</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mesh</span> <span class="o">=</span> <span class="n">mmlab</span><span class="o">.</span><span class="n">mesh</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">,</span><span class="n">scalars</span><span class="o">=</span><span class="n">b_n_3d</span><span class="p">,</span><span class="n">colormap</span><span class="o">=</span><span class="s1">&#39;RdBu&#39;</span><span class="p">,</span><span class="n">vmin</span><span class="o">=-</span><span class="mf">2e-3</span><span class="p">,</span><span class="n">vmax</span><span class="o">=</span><span class="mf">2e-3</span><span class="p">,</span><span class="n">figure</span><span class="o">=</span><span class="n">fig</span><span class="p">)</span>
</pre></div>
</div>
<p>Note that mayavi explicitly requires numpy.ndarray objects so we had to
use the values of each xarray DataArray.</p>
<p>Now, lets cap the ends with our full profile information. This is a little
more involved. For the toroidal angle of each end, we need to rotate the
2D arrays for the mesh and the field values.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">phi</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mi">3</span><span class="o">/</span><span class="mi">2</span><span class="p">]:</span>
<span class="gp">... </span>    <span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">prof</span><span class="p">[</span><span class="s1">&#39;b_n_fun&#39;</span><span class="p">]</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="mi">1</span><span class="o">*</span><span class="n">phi</span><span class="p">))</span> <span class="c1"># poloidal cross section at phi</span>
<span class="gp">... </span>    <span class="n">xy</span> <span class="o">=</span> <span class="n">prof</span><span class="p">[</span><span class="s1">&#39;R&#39;</span><span class="p">]</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="n">phi</span><span class="p">)</span> <span class="c1"># rotate the plane</span>
<span class="gp">... </span>    <span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">xy</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">imag</span><span class="p">(</span><span class="n">xy</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">prof</span><span class="p">[</span><span class="s1">&#39;z&#39;</span><span class="p">])</span>
<span class="gp">... </span>    <span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">,</span><span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">,</span><span class="n">b</span><span class="p">])[:,:,::</span><span class="mi">10</span><span class="p">]</span> <span class="c1"># downsample psi by 10 to speed up mayavi</span>
<span class="gp">... </span>    <span class="n">cap</span> <span class="o">=</span> <span class="n">mmlab</span><span class="o">.</span><span class="n">mesh</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">,</span><span class="n">scalars</span><span class="o">=</span><span class="n">b</span><span class="p">,</span><span class="n">colormap</span><span class="o">=</span><span class="s1">&#39;RdBu&#39;</span><span class="p">,</span><span class="n">vmin</span><span class="o">=-</span><span class="mf">2e-3</span><span class="p">,</span><span class="n">vmax</span><span class="o">=</span><span class="mf">2e-3</span><span class="p">,</span><span class="n">figure</span><span class="o">=</span><span class="n">fig</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mmlab</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="s1">&#39;examples/figures/example_bn_3d_capped.png&#39;</span><span class="p">,</span><span class="n">figure</span><span class="o">=</span><span class="n">fig</span><span class="p">)</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/example_bn_3d_capped.png"><img alt="_images/example_bn_3d_capped.png" src="_images/example_bn_3d_capped.png" style="width: 600px;" /></a>
<p>That looks awesome!</p>
<p>There are, of course, plenty more outputs and important ways of visualizing
them intuitively. See, for example, the 2D plots in the add_3dsurface
function’s documentation. At this point we have outlined the basics. Using
this module and similar commands to those used here, the user should be able
to do all sorts of post-processing tasks.</p>
<dl class="function">
<dt id="pypec.post.add_3dsurface">
<code class="descclassname">pypec.post.</code><code class="descname">add_3dsurface</code><span class="sig-paren">(</span><em>control_output</em>, <em>phi_lim=6.283185307179586</em>, <em>nphi=180</em>, <em>overwrite=False</em>, <em>inplace=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pypec/post.html#add_3dsurface"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypec.post.add_3dsurface" title="Permalink to this definition">¶</a></dt>
<dd><p>Add 3D geometric dimensions to dataset from gpec_control_output_n#.nc.</p>
<p>Note, this surface uses the machine toroidal angle. It should only by used
with functions that do the same (tmag_out=0).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>control_output</strong> – Dataset. xarray Dataset opened from gpec_control_output_n#.nc</li>
<li><strong>phi_lim</strong> – float. Toroidal angle extended from 0 to phi_lim radians.</li>
<li><strong>nphi</strong> – int. Length of toroidal angle dimension array.</li>
<li><strong>overwrite</strong> – bool. Overwrite geometric quantities if they already exist.</li>
<li><strong>inplace</strong> – bool. Modify dataset inplace. Otherwise, return a new dataset.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Dataset. New dataset with additional dimensions.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Examples:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<p>After opening, adding geometry and confirming the functional forms
are using the machine angle,</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">con</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="s1">&#39;examples/DIIID_ideal_example/gpec_control_output_n1.nc&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">con</span> <span class="o">=</span> <span class="n">add_3dsurface</span><span class="p">(</span><span class="n">con</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">con</span> <span class="o">=</span> <span class="n">add_fun</span><span class="p">(</span><span class="n">con</span><span class="p">,</span><span class="n">tmag</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<p>it is easy to make 3D surface plots using mayavi,</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span> <span class="o">=</span> <span class="n">mmlab</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">bgcolor</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">fgcolor</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">600</span><span class="p">,</span> <span class="mi">600</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mesh</span> <span class="o">=</span> <span class="n">mmlab</span><span class="o">.</span><span class="n">mesh</span><span class="p">(</span><span class="n">con</span><span class="p">[</span><span class="s1">&#39;x_surf&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span><span class="n">con</span><span class="p">[</span><span class="s1">&#39;y_surf&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span><span class="n">con</span><span class="p">[</span><span class="s1">&#39;z_surf&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
<span class="gp">... </span>                  <span class="n">scalars</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">con</span><span class="p">[</span><span class="s1">&#39;b_n_fun&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">con</span><span class="p">[</span><span class="s1">&#39;phase_surf&#39;</span><span class="p">]),</span> <span class="n">colormap</span><span class="o">=</span><span class="s1">&#39;RdBu&#39;</span><span class="p">,</span> <span class="n">figure</span><span class="o">=</span><span class="n">fig</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mmlab</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="s1">&#39;examples/figures/example_bn_3d.png&#39;</span><span class="p">,</span> <span class="n">figure</span><span class="o">=</span><span class="n">fig</span><span class="p">)</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/example_bn_3d.png"><img alt="_images/example_bn_3d.png" src="_images/example_bn_3d.png" style="width: 600px;" /></a>
<p>Make 2D perturbed last-closed-flux-surface plots quickly using,</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fac</span> <span class="o">=</span> <span class="mf">1e-1</span> <span class="c1"># good for DIII-D unit eigenmodes</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l</span><span class="p">,</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">con</span><span class="p">[</span><span class="s1">&#39;R&#39;</span><span class="p">],</span> <span class="n">con</span><span class="p">[</span><span class="s1">&#39;z&#39;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span> <span class="c1"># most and least stable modes</span>
<span class="gp">... </span>    <span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">con</span><span class="p">[</span><span class="s1">&#39;R_xe_eigenvector_fun&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">fac</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">l</span><span class="p">,</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">con</span><span class="p">[</span><span class="s1">&#39;R&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">v</span> <span class="o">*</span> <span class="n">con</span><span class="p">[</span><span class="s1">&#39;R_n&#39;</span><span class="p">],</span> <span class="n">con</span><span class="p">[</span><span class="s1">&#39;z&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">v</span> <span class="o">*</span> <span class="n">con</span><span class="p">[</span><span class="s1">&#39;z_n&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sm</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">set_linearray</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">lines</span><span class="p">[</span><span class="o">-</span><span class="mi">4</span><span class="p">:],</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cb</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">sm</span><span class="p">,</span> <span class="n">ticks</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cb</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s1">&#39;Mode Index&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xtl</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mf">1.7</span><span class="p">,</span> <span class="mf">2.4</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">txt</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;R (m)&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">txt</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;z (m)&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;examples/figures/example_boundary_wiggle.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/example_boundary_wiggle.png"><img alt="_images/example_boundary_wiggle.png" src="_images/example_boundary_wiggle.png" style="width: 600px;" /></a>
<p>Combining these two concepts, we can even plot a 3D perturbed surface distorted
by the normal displacements and colored to show the normal field.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span> <span class="o">=</span> <span class="n">mmlab</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">bgcolor</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">fgcolor</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">600</span><span class="p">,</span> <span class="mi">600</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xinorm</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">*</span> <span class="n">con</span><span class="p">[</span><span class="s1">&#39;phase_surf&#39;</span><span class="p">]</span> <span class="c1"># good for ~cm displacements</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">con</span><span class="p">[</span><span class="s1">&#39;x_surf&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span> <span class="o">+</span> <span class="n">con</span><span class="p">[</span><span class="s1">&#39;xi_n_fun&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">xinorm</span> <span class="o">*</span> <span class="n">con</span><span class="p">[</span><span class="s1">&#39;x_surf_n&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">con</span><span class="p">[</span><span class="s1">&#39;y_surf&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span> <span class="o">+</span> <span class="n">con</span><span class="p">[</span><span class="s1">&#39;xi_n_fun&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">xinorm</span> <span class="o">*</span> <span class="n">con</span><span class="p">[</span><span class="s1">&#39;y_surf_n&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">con</span><span class="p">[</span><span class="s1">&#39;z_surf&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span> <span class="o">+</span> <span class="n">con</span><span class="p">[</span><span class="s1">&#39;xi_n_fun&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">xinorm</span> <span class="o">*</span> <span class="n">con</span><span class="p">[</span><span class="s1">&#39;z_surf_n&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">con</span><span class="p">[</span><span class="s1">&#39;b_n_fun&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">con</span><span class="p">[</span><span class="s1">&#39;phase_surf&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mesh</span> <span class="o">=</span> <span class="n">mmlab</span><span class="o">.</span><span class="n">mesh</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">,</span><span class="n">scalars</span><span class="o">=</span><span class="n">s</span><span class="p">,</span> <span class="n">colormap</span><span class="o">=</span><span class="s1">&#39;RdBu&#39;</span><span class="p">,</span> <span class="n">figure</span><span class="o">=</span><span class="n">fig</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mmlab</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="s1">&#39;examples/figures/example_bn_xin_3d.png&#39;</span><span class="p">,</span> <span class="n">figure</span><span class="o">=</span><span class="n">fig</span><span class="p">)</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/example_bn_xin_3d.png"><img alt="_images/example_bn_xin_3d.png" src="_images/example_bn_xin_3d.png" style="width: 600px;" /></a>
<p>Fancy!</p>
</dd></dl>

<dl class="function">
<dt id="pypec.post.add_fun">
<code class="descclassname">pypec.post.</code><code class="descname">add_fun</code><span class="sig-paren">(</span><em>control_output</em>, <em>keys=None</em>, <em>tmag=False</em>, <em>inplace=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pypec/post.html#add_fun"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypec.post.add_fun" title="Permalink to this definition">¶</a></dt>
<dd><p>Add real space functions of theta calculated from the spectral outputs.
This is helpful when analyzing a GPEC run for which fun_flag was off
for speed/efficiency.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>control_output</strong> – Dataset. xarray Dataset opened from gpec_control_output_n#.nc</li>
<li><strong>keys</strong> – iterable. List of keys for which &lt;key&gt;_fun will be added. Default is all spectral variables.</li>
<li><strong>tmag</strong> – bool. Keep the magnetic coordinate angle (default is machine angle).</li>
<li><strong>inplace</strong> – bool. Add to dataset. Otherwise, make a new dataset object.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Dataset. New dataset with real space functions of theta.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<p>You can check this against fun_flag outputs,</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">con</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="s1">&#39;examples/DIIID_kinetic_example/gpec_control_output_n1.nc&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">con_mag</span> <span class="o">=</span> <span class="n">post</span><span class="o">.</span><span class="n">add_fun</span><span class="p">(</span><span class="n">con</span><span class="p">,</span> <span class="n">tmag</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">con_mac</span> <span class="o">=</span> <span class="n">post</span><span class="o">.</span><span class="n">add_fun</span><span class="p">(</span><span class="n">con</span><span class="p">,</span> <span class="n">tmag</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l</span><span class="p">,</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">con</span><span class="p">[</span><span class="s1">&#39;theta&#39;</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">con</span><span class="p">[</span><span class="s1">&#39;xi_n_fun&#39;</span><span class="p">]),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;fun_flag Output&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l</span><span class="p">,</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">con</span><span class="p">[</span><span class="s1">&#39;theta&#39;</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">con_mag</span><span class="p">[</span><span class="s1">&#39;xi_n_fun&#39;</span><span class="p">]),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Magnetic Angle&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l</span><span class="p">,</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">con</span><span class="p">[</span><span class="s1">&#39;theta&#39;</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">con_mac</span><span class="p">[</span><span class="s1">&#39;xi_n_fun&#39;</span><span class="p">]),</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Machine Angle&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">leg</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">txt</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Normal Displacement&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">txt</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Amplitude&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l</span><span class="p">,</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">con</span><span class="p">[</span><span class="s1">&#39;theta&#39;</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">con</span><span class="p">[</span><span class="s1">&#39;xi_n_fun&#39;</span><span class="p">]),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;fun_flag Output&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l</span><span class="p">,</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">con</span><span class="p">[</span><span class="s1">&#39;theta&#39;</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">con_mag</span><span class="p">[</span><span class="s1">&#39;xi_n_fun&#39;</span><span class="p">]),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Magnetic Angle&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l</span><span class="p">,</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">con</span><span class="p">[</span><span class="s1">&#39;theta&#39;</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">con_mac</span><span class="p">[</span><span class="s1">&#39;xi_n_fun&#39;</span><span class="p">]),</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Machine Angle&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">txt</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Phase&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">txt</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;theta&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;examples/figures/example_add_fun.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/example_add_fun.png"><img alt="_images/example_add_fun.png" src="_images/example_add_fun.png" style="width: 600px;" /></a>
<p>To see the function is properly recovered. Note that the fun_flag outputs are
on the machine coordinate.</p>
</dd></dl>

<dl class="function">
<dt id="pypec.post.optimize_torque">
<code class="descclassname">pypec.post.</code><code class="descname">optimize_torque</code><span class="sig-paren">(</span><em>matrixprofile</em>, <em>psilow=0</em>, <em>psihigh=1</em>, <em>normalize=False</em>, <em>energy=False</em>, <em>minimize=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pypec/post.html#optimize_torque"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypec.post.optimize_torque" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the eigenvalue and eigenvector corresponding to maximum the torque
within the specified range of normalized poloidal flux.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>matrixprofile</strong> – DataArray. T_x or T_coil from gpec_profile_output_n#.nc.</li>
<li><strong>psilow</strong> – float. Lower limit of normalized poloidal flux.</li>
<li><strong>psihigh</strong> – float. Upper limit of normalized poloidal flux.</li>
<li><strong>normalize</strong> – bool. Optimize value within psi range normalized to the total.</li>
<li><strong>energy</strong> – bool. Optimize 2ndW (default is torque).</li>
<li><strong>minimize</strong> – bool. FInd the minimum (default is maximum).</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">w,v. Eigenvalue, eigenvector of optimum.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Note:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<p>The matrix order will be forced to end in the primed dimension, i.e. (‘psi_n’, ‘m’, ‘m_prime’)
or (‘psi_n’, ‘coil_index’, ‘coil_index_prime’).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Examples:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<p>With the output of a kinetic GPEC run in hand,</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">con</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="s1">&#39;examples/DIIID_kinetic_example/gpec_control_output_n1.nc&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">prof</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="s1">&#39;examples/DIIID_kinetic_example/gpec_profile_output_n1.nc&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>This function provides the spectrum that optimizes the integral torque
and the corresponding profile is easily obtained.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">w</span><span class="p">,</span><span class="n">v</span> <span class="o">=</span> <span class="n">optimize_torque</span><span class="p">(</span><span class="n">prof</span><span class="p">[</span><span class="s1">&#39;T_xe&#39;</span><span class="p">])</span> <span class="c1"># handles any order of dims</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">T_mat</span> <span class="o">=</span> <span class="n">prof</span><span class="p">[</span><span class="s1">&#39;T_xe&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="s1">&#39;psi_n&#39;</span><span class="p">,</span> <span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="s1">&#39;m_prime&#39;</span><span class="p">)</span> <span class="c1"># order matters in  dot products</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">T_opt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">conj</span><span class="p">(),</span> <span class="n">T_mat</span><span class="p">),</span> <span class="n">v</span><span class="p">))</span><span class="o">/</span><span class="mi">2</span> <span class="c1"># 0.5 for quadratic fourier analysis</span>
</pre></div>
</div>
<p>We can then compare the spectrum and torque from our GPEC perturbed equilibrium to
the theoretical optima,</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">input_power</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">con</span><span class="p">[</span><span class="s1">&#39;Phi_xe&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">conj</span><span class="p">(),</span> <span class="n">con</span><span class="p">[</span><span class="s1">&#39;Phi_xe&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">con</span><span class="p">[</span><span class="s1">&#39;Phi_xe&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Input&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l</span><span class="p">,</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">con</span><span class="p">[</span><span class="s1">&#39;m&#39;</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">input_power</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Optimum Torque&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">leg</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l</span> <span class="o">=</span> <span class="n">prof</span><span class="p">[</span><span class="s1">&#39;T&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">real</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Input&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l</span><span class="p">,</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">prof</span><span class="p">[</span><span class="s1">&#39;psi_n&#39;</span><span class="p">],</span> <span class="n">T_opt</span><span class="o">*</span><span class="n">input_power</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Optimized Torque&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">leg</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;examples/figures/example_optimize_torque.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/example_optimize_torque.png"><img alt="_images/example_optimize_torque.png" src="_images/example_optimize_torque.png" style="width: 600px;" /></a>
</dd></dl>

<dl class="function">
<dt id="pypec.post.update_name_conventions">
<code class="descclassname">pypec.post.</code><code class="descname">update_name_conventions</code><span class="sig-paren">(</span><em>dataset</em>, <em>version=None</em>, <em>inplace=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pypec/post.html#update_name_conventions"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypec.post.update_name_conventions" title="Permalink to this definition">¶</a></dt>
<dd><p>Update the naming conventions in a dataset to the latest conventions.</p>
<p>Use this to avoid lots of if statements in cross-checking versions.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>dataset</strong> – </li>
<li><strong>version</strong> – str. Override version attribute.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
</div>
<span class="target" id="module-pypec.gpec"></span><div class="section" id="pypec-gpec-python-wrappers-for-fortran-codes">
<h2><a class="reference internal" href="#module-pypec.gpec" title="pypec.gpec"><code class="xref py py-mod docutils literal"><span class="pre">pypec.gpec</span></code></a> – Python Wrappers for FORTRAN Codes<a class="headerlink" href="#pypec-gpec-python-wrappers-for-fortran-codes" title="Permalink to this headline">¶</a></h2>
<p>This is a collection of wrapper functions for running DCON, GPEC, and PENT.</p>
<p>If run from the command line, this module will call an associated GUI.</p>
<p>This module is for more advanced operators who want to control/run 
the fortran package for DCON, GPEC, and PENT. To get started, lets
explore the package</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">gpec</span><span class="o">.</span>
<span class="go">gpec.InputSet       gpec.join           gpec.optimize       gpec.run</span>
<span class="go">gpec.bashjob        gpec.namelist       gpec.optntv         gpec.subprocess</span>
<span class="go">gpec.data           gpec.np             gpec.os             gpec.sys</span>
<span class="go">gpec.default        gpec.ntv_dominantm  gpec.packagedir     gpec.time</span>
</pre></div>
</div>
<p>many of these are simply standard python modules imported by gpec
lets submit a full run in just 4 lines:
steal the settings from a previous run (leaving run director as deafult)</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">new_inputs</span> <span class="o">=</span> <span class="n">gpec</span><span class="o">.</span><span class="n">InputSet</span><span class="p">(</span><span class="n">indir</span><span class="o">=</span><span class="s1">&#39;/p/gpec/users/nlogan/data/d3d/ipecout/145117/ico3_n3/&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>change what we want to</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">new_inputs</span><span class="p">[</span><span class="s1">&#39;dcon&#39;</span><span class="p">][</span><span class="s1">&#39;DCON_CONTROL&#39;</span><span class="p">][</span><span class="s1">&#39;nn&#39;</span><span class="p">]</span><span class="o">=</span><span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">new_dir</span> <span class="o">=</span> <span class="n">new_inputs</span><span class="o">.</span><span class="n">indir</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;2&#39;</span>
</pre></div>
</div>
<p><em>Double check that all inputs are what you expect</em> (not shown here)
and submit the job to the cluster.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">gpec</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="n">new_dir</span><span class="p">,</span><span class="o">**</span><span class="n">new_inputs</span><span class="o">.</span><span class="n">infiles</span><span class="p">)</span>
</pre></div>
</div>
<p>Running the package using this module will</p>
<ol class="arabic simple">
<li>Create the new location (if not already existing), and cd to it</li>
<li>rm all .out, .dat, and .bin files already in the directory (not dcon ones if rundcon=False, not pent ones for runpent=False, etc).</li>
<li>cp all .dat and .in files from the run directoy to the new location</li>
<li>Write all namelists supplied in kwargs to file (overwriting)</li>
<li>Write a unique bash script for the run, and submit it OR run each fortran routine from the commandline.</li>
<li>Remove all .dat and xdraw files from the directory</li>
</ol>
<p>You will not that there is significant oportunity for overwriting files,
and the user must be responsible for double checking that all inputs 
are correct and will not result in life crushing disaster for themselves
or a friend when that super special file gets over-written.</p>
<dl class="class">
<dt id="pypec.gpec.InputSet">
<em class="property">class </em><code class="descclassname">pypec.gpec.</code><code class="descname">InputSet</code><span class="sig-paren">(</span><em>rundir='/p/gpec/GPEC-1.2/bin'</em>, <em>indir='/p/gpec/GPEC-1.2/input'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pypec/gpec.html#InputSet"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypec.gpec.InputSet" title="Permalink to this definition">¶</a></dt>
<dd><p>Class designed to hold the standard inputs for a run.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Attributes:</th><td class="field-body"><ul class="first last simple">
<li>rundir: str. Location of executables, .dat files, and extra .in files.</li>
<li>indir: str. Location of .in files read in and stored here</li>
<li>infiles: dict. Tree like storage of namelist objects.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pypec.gpec.nustarscan">
<code class="descclassname">pypec.gpec.</code><code class="descname">nustarscan</code><span class="sig-paren">(</span><em>base='.'</em>, <em>scale=(0.1</em>, <em>1.0</em>, <em>10.0)</em>, <em>pentfile='pent.in'</em>, <em>scalen=True</em>, <em>scalet=True</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pypec/gpec.html#nustarscan"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypec.gpec.nustarscan" title="Permalink to this definition">¶</a></dt>
<dd><p>Run pent for series of <em>approximately</em> scaled collisionality values.
Default scaling holds P=NT constant (NTV~P), but this is broken using
scalen or scalet (scalet=False, for example, scales only density).</p>
<p>User may want to include a non-zero ximag if going to low collisionality.</p>
<p>User must specify full path to all files named in the pent input.</p>
<p>Kinetic file must have header with ‘n’ and ‘i’ in the ion density label
but no other label, both ‘t’ and ‘e’ in only the electron temperature label,
‘omega’ omega_EXB label, etc.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Approximate scaling ignores log-Lambda dependence, and uses
nu_star ~ nu/v_th ~ (NT^-3/2)/(T^1/2) ~ N/T^2.</p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>base</strong> – str. Top level directory containing dcon and gpec runs. Must contain euler.bin and vacuum.bin file.</li>
<li><strong>scale</strong> – ndarray. The scale factors iterated over.</li>
<li><strong>pentfile</strong> – str. Original input file.</li>
<li><strong>scalen</strong> – bool.Use density scaling to change nu_star.</li>
<li><strong>scalet</strong> – bool.Use temperature scaling to change nu_star.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">bool. True.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pypec.gpec.omegascan">
<code class="descclassname">pypec.gpec.</code><code class="descname">omegascan</code><span class="sig-paren">(</span><em>omega='wp'</em>, <em>base='.'</em>, <em>scale=(-2</em>, <em>-1</em>, <em>-0.5</em>, <em>0.5</em>, <em>1</em>, <em>2)</em>, <em>pentrcfile='pentrc.in'</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pypec/gpec.html#omegascan"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypec.gpec.omegascan" title="Permalink to this definition">¶</a></dt>
<dd><p>Run pent for series of scaled nu/omega_phi/omega_E/omega_D/gamma_damp values. 
User must specify full path to all files named in pent.in input file
located in the base directory.
Note that the rotation profile is scaled by manipulating omega_E
on each surface to obtain the scaled rotation.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>omega</strong> – str. Choose from nu, wp, we, wd, or ga</li>
<li><strong>base</strong> – str. Top level directory containing dcon and gpec runs. Must contain euler.bin and vacuum.bin file.</li>
<li><strong>scale</strong> – ndarray. The scale factors iterated over.</li>
<li><strong>pentfile</strong> – str. Original input file.</li>
<li><strong>rundcon</strong> – bool. Set true if using hybrid kinetic MHD DCON. Will also attempt GPEC + PENT.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">bool. True.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pypec.gpec.optntv">
<code class="descclassname">pypec.gpec.</code><code class="descname">optntv</code><span class="sig-paren">(</span><em>mlist</em>, <em>maxiter=50</em>, <em>loc='.'</em>, <em>rundir='/p/gpec/GPEC-1.2/bin/'</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pypec/gpec.html#optntv"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypec.gpec.optntv" title="Permalink to this definition">¶</a></dt>
<dd><p>Python wrapper for running gpec package multiple times in
a search for the normalized spectrum that maximizes NTV.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>mlist</strong> – list. Integer poloidal modes included on plasma surface.</li>
<li><strong>maxiter</strong> – int.Maximum number of iterations.</li>
<li><strong>loc</strong> – str. Directory location for run.</li>
<li><strong>rundir</strong> – str. GPEC package directory with executables and .dat files.</li>
<li><strong>kwargs</strong> – <p>dict. namelist instance(s) written to &lt;kwarg&gt;.in file(s).</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Namelists taken from (in order of priority):
1) Key word arguments 
2) .in files from loc
3) .in files from rundir</p>
</div>
</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">bool. True.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pypec.gpec.optpentrc">
<code class="descclassname">pypec.gpec.</code><code class="descname">optpentrc</code><span class="sig-paren">(</span><em>ms=[-5, -4, -3, -2, -1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24], ttype='tgar', tfac=-1, perp1=False, norm=0.001, qsub=True, method='Powell', maxiter=1000, loc='.', rundir='/p/gpec/GPEC-1.2/bin/', **kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pypec/gpec.html#optpentrc"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypec.gpec.optpentrc" title="Permalink to this definition">¶</a></dt>
<dd><p>Python wrapper for running gpec packages multiple times in
a search for the normalized spectrum that maximizes NTV.</p>
<p>Approach is as follows:
1) Run DCON and GPEC in base directory with singcoup_flag True
2) Run GPEC twice for each m, creating new subdirectories cosmn* and sinmn*
3) Optimize a functional wrapper for PENTRC using optimize.fmin_slsqp
- Spectra constrained to have 1 Gm^2 norm
- wrapper uses data package to linearly combine gpec_xclebsch outputs
- Initial guess is the first singcoup_svd mode from GPEC</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>ms</strong> – list. Integer poloidal modes included on plasma surface.</li>
<li><strong>ttype</strong> – str.PENTRC_OUTPUT flag (fgar,tgar,rlar,etc).</li>
<li><strong>tfac</strong> – int.Optimization minimizes tfac*|T_phi|. Negative values maximize applied NTV.</li>
<li><strong>perp1</strong> – bool.Optimizes in space perpendicular to 1st GPEC SVD mode.</li>
<li><strong>norm</strong> – float.Amplitude of applied area normalized spectrum Phi_x (Tesla meter^2).</li>
<li><strong>qsub</strong> – bool.Submits individual jobs to cluster. Use gpec.run for qsub overall optimizer.</li>
<li><strong>method</strong> – str.Method used in scipy.optimize.minimize.</li>
<li><strong>maxiter</strong> – int.Maximum number of iterations.</li>
<li><strong>loc</strong> – str. Directory location for run.</li>
<li><strong>rundir</strong> – str. GPEC package directory with executables and .dat files.</li>
<li><strong>kwargs</strong> – <p>dict. namelist instance(s) written to &lt;kwarg&gt;.in file(s).</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Namelists taken from (in order of priority):
1) Key word arguments 
2) .in files from loc
3) .in files from rundir</p>
</div>
</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">bool. True.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pypec.gpec.run">
<code class="descclassname">pypec.gpec.</code><code class="descname">run</code><span class="sig-paren">(</span><em>loc='.'</em>, <em>rundir='/p/gpec/GPEC-1.2/bin/'</em>, <em>submit=True</em>, <em>return_on_complete=False</em>, <em>rerun=False</em>, <em>rundcon=True</em>, <em>rungpec=True</em>, <em>runpentrc=True</em>, <em>runrdcon=False</em>, <em>cleandcon=False</em>, <em>fill_inputs=False</em>, <em>version='1.2'</em>, <em>mailon='NONE'</em>, <em>email=''</em>, <em>mem=3000.0</em>, <em>hours=36</em>, <em>partition='sque'</em>, <em>runipec=False</em>, <em>qsub=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pypec/gpec.html#run"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypec.gpec.run" title="Permalink to this definition">¶</a></dt>
<dd><p>Python wrapper for running gpec package.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>loc</strong> – str. Directory location for run.</li>
<li><strong>rundir</strong> – str. GPEC package directory with executables and .dat files.</li>
<li><strong>submit</strong> – bool. Submit job to cluster.</li>
<li><strong>return_on_complete</strong> – bool. Return only after job is finished on cluster (irrelevant if qsub=False).</li>
<li><strong>rerun</strong> – bool. Does not delete existing .out files.</li>
<li><strong>rundcon</strong> – bool. Run dcon.</li>
<li><strong>runipec</strong> – bool. Run ipec.</li>
<li><strong>rungpec</strong> – bool. Run gpec.</li>
<li><strong>runpentrc</strong> – bool. Run pentrc.</li>
<li><strong>runpentrc</strong> – bool. Run rdcon and rmatch.</li>
<li><strong>cleandcon</strong> – bool. Remove euler.bin file after run is complete.</li>
<li><strong>fill_inputs</strong> – bool. Use inputs from rundir (see kwargs).</li>
<li><strong>version</strong> – str. Version of GPEC loaded (may set compilers if 1.2 or later)</li>
<li><strong>mailon</strong> – str. Choose from NONE, BEGIN, END, FAIL, REQUEUE, or ALL.</li>
<li><strong>email</strong> – str. Email address (default is submitting user).</li>
<li><strong>mem</strong> – floatMemory request of q-submission in megabytes (converted to integer).</li>
<li><strong>hours</strong> – int. Number of hours requested from job manager.</li>
<li><strong>partition</strong> – str. Specify a specific computing queue (e.g. ‘ellis’). Default auto-chooses based on threads and memory.</li>
<li><strong>kwargs</strong> – dict. namelist instance(s) written to &lt;kwarg&gt;.in file(s).</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Namelists taken from (in order of priority): 
1) Key word arguments 
2) .in files from loc
3) .in files from rundir</p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">bool. True.</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<span class="target" id="module-pypec.namelist"></span><div class="section" id="pypec-namelist-io-for-fortran-namelists">
<h2><a class="reference internal" href="#module-pypec.namelist" title="pypec.namelist"><code class="xref py py-mod docutils literal"><span class="pre">pypec.namelist</span></code></a> – IO for FORTRAN Namelists<a class="headerlink" href="#pypec-namelist-io-for-fortran-namelists" title="Permalink to this headline">¶</a></h2>
<p>This module provides pythonic tools for reading and writing 
fortran namelists.</p>
<div class="section" id="id1">
<h3>Examples<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<p>This module can be used to convert FORTRAN namelist files into 
python ordered dictionary type objects. The individual namelists are 
capitalized and their paramters are left as written. The actual
parameter is thus stored two levels deep in the dictionary.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">nl</span><span class="o">=</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;examples/example_namelist.in&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nl</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
<span class="go">[&#39;GPEC_INPUT&#39;, &#39;GPEC_CONTROL&#39;, &#39;GPEC_OUTPUT&#39;, &#39;GPEC_DIAGNOSE&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nl</span><span class="p">[</span><span class="s1">&#39;GPEC_CONTROL&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
<span class="go">[&#39;resp_index&#39;, &#39;sing_spot&#39;, &#39;reg_flag&#39;, &#39;reg_spot&#39;, &#39;chebyshev_flag&#39;, &#39;nche&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nl</span><span class="p">[</span><span class="s1">&#39;GPEC_CONTROL&#39;</span><span class="p">][</span><span class="s1">&#39;reg_spot&#39;</span><span class="p">]</span>
<span class="go">0.05</span>
</pre></div>
</div>
<p>The parameters can be changed, added, or deleted as in any python
dictionary.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">nl</span><span class="p">[</span><span class="s1">&#39;GPEC_CONTROL&#39;</span><span class="p">][</span><span class="s1">&#39;reg_spot&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.01</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nl</span><span class="p">[</span><span class="s1">&#39;GPEC_CONTROL&#39;</span><span class="p">][</span><span class="s1">&#39;reg_spot&#39;</span><span class="p">]</span>
<span class="go">0.01</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">del</span> <span class="n">nl</span><span class="p">[</span><span class="s1">&#39;GPEC_CONTROL&#39;</span><span class="p">][</span><span class="s1">&#39;nche&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nl</span><span class="p">[</span><span class="s1">&#39;GPEC_CONTROL&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
<span class="go">[&#39;resp_index&#39;, &#39;sing_spot&#39;, &#39;reg_flag&#39;, &#39;reg_spot&#39;, &#39;chebyshev_flag&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nl</span><span class="p">[</span><span class="s1">&#39;GPEC_CONTROL&#39;</span><span class="p">][</span><span class="s1">&#39;nche&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">30</span>
</pre></div>
</div>
<p>The resulting namelists can then be re-written in ASCII format
for use with the FORTAN codes.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">write</span><span class="p">(</span><span class="n">nl</span><span class="p">,</span><span class="s1">&#39;examples/example_namelist_edit.in&#39;</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>These examples can be tested by developers using ipython as follows:</p>
<blockquote class="last">
<div><p>In [1]: import pypec.namelist,doctest</p>
<p>In [2]: doctest.testmod(pypec.namelist,verbose=True)</p>
</div></blockquote>
</div>
<dl class="class">
<dt id="pypec.namelist.Objectify">
<em class="property">class </em><code class="descclassname">pypec.namelist.</code><code class="descname">Objectify</code><span class="sig-paren">(</span><em>d</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pypec/namelist.html#Objectify"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypec.namelist.Objectify" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.7)"><code class="xref py py-class docutils literal"><span class="pre">object</span></code></a></p>
<p>Class base to convert iterable to instance.</p>
</dd></dl>

<dl class="function">
<dt id="pypec.namelist.read">
<code class="descclassname">pypec.namelist.</code><code class="descname">read</code><span class="sig-paren">(</span><em>filename</em>, <em>out_type='dict'</em>, <em>comment='!'</em>, <em>old=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pypec/namelist.html#read"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypec.namelist.read" title="Permalink to this definition">¶</a></dt>
<dd><p>Read in a file. Must have namelists in series, not embedded.
Assumes name of list preceded by ‘&amp;’ and list ends with a single backslash.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>filename</strong> – str. Path to input namelist.</li>
<li><strong>out_type</strong> – str. Can be either ‘dict’ or ‘obj’.</li>
<li><strong>comment</strong> – str. Lines starting with any of these characters are considered annotations.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">dict (object). Top keys (attributes) are namelists with sub-key(-attribute) parameter values.</p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The returned dict is actually “OrderedDict” type from 
collections module. If returning an object, the object is 
un-ordered.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="pypec.namelist.write">
<code class="descclassname">pypec.namelist.</code><code class="descname">write</code><span class="sig-paren">(</span><em>nl</em>, <em>filename</em>, <em>old=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pypec/namelist.html#write"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypec.namelist.write" title="Permalink to this definition">¶</a></dt>
<dd><p>Write namelist object to file for fortran interface.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>nl</strong> – object. namelist object from read(). Can be dictionary or Objectify type class.</li>
<li><strong>filename</strong> – str. Path of file to be written.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">bool. True.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
</div>
<span class="target" id="module-pypec.modplot"></span><div class="section" id="pypec-modplot-matplotlib-customizations">
<h2><a class="reference internal" href="#module-pypec.modplot" title="pypec.modplot"><code class="xref py py-mod docutils literal"><span class="pre">pypec.modplot</span></code></a> – matplotlib Customizations<a class="headerlink" href="#pypec-modplot-matplotlib-customizations" title="Permalink to this headline">¶</a></h2>
<p>Collection of modified matplotlib functions and objects.</p>
<div class="section" id="id2">
<h3>Examples<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h3>
<p>Plot complex arguments.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">subplots</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lines</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="mf">0.5</span><span class="n">j</span><span class="p">),</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;test&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pyplot</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>Automatically resize plots to fit labels.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">xlbl</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;X AXIS&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Plot huge data sets quickly.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mf">1e5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">1e5</span><span class="p">)</span><span class="o">/</span><span class="mf">1.5e4</span><span class="o">+</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mf">1e5</span><span class="p">)</span><span class="o">-</span><span class="mf">0.5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">newline</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">data</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;large data set&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>This plots a line capped at 1000-pts by default. The maximum number 
of points is maintained as you manipulate the axis, so zooming
in will provide you with new points and increased detail until the
window samples fewer than that many points in the orginal data. The
first two lines, for instance, contain only their original 10 points
(not 1000 interpolated points).</p>
<dl class="class">
<dt id="pypec.modplot.MidPointNorm">
<em class="property">class </em><code class="descclassname">pypec.modplot.</code><code class="descname">MidPointNorm</code><span class="sig-paren">(</span><em>midpoint=0</em>, <em>vmin=None</em>, <em>vmax=None</em>, <em>clip=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pypec/modplot.html#MidPointNorm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypec.modplot.MidPointNorm" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">matplotlib.colors.Normalize</span></code></p>
<p>Taken from <a class="reference external" href="http://stackoverflow.com/questions/7404116/defining-the-midpoint-of-a-colormap-in-matplotlib">http://stackoverflow.com/questions/7404116/defining-the-midpoint-of-a-colormap-in-matplotlib</a></p>
<dl class="method">
<dt id="pypec.modplot.MidPointNorm.inverse">
<code class="descname">inverse</code><span class="sig-paren">(</span><em>value</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pypec/modplot.html#MidPointNorm.inverse"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypec.modplot.MidPointNorm.inverse" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="function">
<dt id="pypec.modplot.add_inset_axes">
<code class="descclassname">pypec.modplot.</code><code class="descname">add_inset_axes</code><span class="sig-paren">(</span><em>ax</em>, <em>rect</em>, <em>axisbg='w'</em>, <em>polar=False</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pypec/modplot.html#add_inset_axes"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypec.modplot.add_inset_axes" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a axes inset in another axes.
Unlike the native matplotlib inset_axes, here the inset axes can be a polar axes.</p>
<p>Note that the parent axes should be drawn first if using autolayout (changes postion).
The inset axes will not track the original if it is moved.</p>
<p>From <a class="reference external" href="http://stackoverflow.com/questions/17458580/embedding-small-plots-inside-subplots-in-matplotlib/17479417#17479417">http://stackoverflow.com/questions/17458580/embedding-small-plots-inside-subplots-in-matplotlib/17479417#17479417</a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>ax</strong> – Axes. Parent axes.</li>
<li><strong>rect</strong> – list. Inset axes location and dimensions [left, bottom, width, height]</li>
<li><strong>axisbg</strong> – str. Background color.</li>
<li><strong>polar</strong> – bool. Polar plot.</li>
<li><strong>kwargs</strong> – dict. Passed to add_subplot.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">Axes. A new inset axes.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pypec.modplot.colorbar">
<code class="descclassname">pypec.modplot.</code><code class="descname">colorbar</code><span class="sig-paren">(</span><em>mappable=None</em>, <em>cax=None</em>, <em>ax=None</em>, <em>use_gridspec=True</em>, <em>**kw</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pypec/modplot.html#colorbar"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypec.modplot.colorbar" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Modified pyplot colorbar for default use_gridspec=True.</p>
<p>ORIGINAL DOCUMENTATION</p>
</div></blockquote>
<p>Add a colorbar to a plot.</p>
<p>Function signatures for the <code class="xref py py-mod docutils literal"><span class="pre">pyplot</span></code> interface; all
but the first are also method signatures for the
<code class="xref py py-meth docutils literal"><span class="pre">colorbar()</span></code> method:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">colorbar</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="n">colorbar</span><span class="p">(</span><span class="n">mappable</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="n">colorbar</span><span class="p">(</span><span class="n">mappable</span><span class="p">,</span> <span class="n">cax</span><span class="o">=</span><span class="n">cax</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="n">colorbar</span><span class="p">(</span><span class="n">mappable</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>
</div>
<dl class="docutils">
<dt>mappable :</dt>
<dd>The <code class="xref py py-class docutils literal"><span class="pre">Image</span></code>,
<code class="xref py py-class docutils literal"><span class="pre">ContourSet</span></code>, etc. to
which the colorbar applies; this argument is mandatory for the Figure
<code class="xref py py-meth docutils literal"><span class="pre">colorbar()</span></code> method but optional for the
pyplot <code class="xref py py-func docutils literal"><span class="pre">colorbar()</span></code> function, which sets the
default to the current image.</dd>
<dt>cax <span class="classifier-delimiter">:</span> <span class="classifier"><code class="xref py py-class docutils literal"><span class="pre">Axes</span></code> object, optional</span></dt>
<dd>Axis into which the colorbar will be drawn</dd>
<dt>ax <span class="classifier-delimiter">:</span> <span class="classifier"><code class="xref py py-class docutils literal"><span class="pre">Axes</span></code>, list of Axes, optional</span></dt>
<dd>Parent axes from which space for a new colorbar axes will be stolen.
If a list of axes is given they will all be resized to make room for the
colorbar axes.</dd>
<dt>use_gridspec <span class="classifier-delimiter">:</span> <span class="classifier">bool, optional</span></dt>
<dd>If <em>cax</em> is <code class="docutils literal"><span class="pre">None</span></code>, a new <em>cax</em> is created as an instance of
Axes. If <em>ax</em> is an instance of Subplot and <em>use_gridspec</em> is <code class="docutils literal"><span class="pre">True</span></code>,
<em>cax</em> is created as an instance of Subplot using the
grid_spec module.</dd>
</dl>
<dl class="docutils">
<dt><code class="xref py py-class docutils literal"><span class="pre">Colorbar</span></code> instance</dt>
<dd>See also its base class, <code class="xref py py-class docutils literal"><span class="pre">ColorbarBase</span></code>.
Call the <code class="xref py py-meth docutils literal"><span class="pre">set_label()</span></code> method
to label the colorbar.</dd>
</dl>
<p>Additional keyword arguments are of two kinds:</p>
<blockquote>
<div><p>axes properties:</p>
<blockquote>
<div><table border="1" class="docutils">
<colgroup>
<col width="18%" />
<col width="82%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Property</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><em>orientation</em></td>
<td>vertical or horizontal</td>
</tr>
<tr class="row-odd"><td><em>fraction</em></td>
<td>0.15; fraction of original axes to use for colorbar</td>
</tr>
<tr class="row-even"><td><em>pad</em></td>
<td>0.05 if vertical, 0.15 if horizontal; fraction
of original axes between colorbar and new image axes</td>
</tr>
<tr class="row-odd"><td><em>shrink</em></td>
<td>1.0; fraction by which to multiply the size of the colorbar</td>
</tr>
<tr class="row-even"><td><em>aspect</em></td>
<td>20; ratio of long to short dimensions</td>
</tr>
<tr class="row-odd"><td><em>anchor</em></td>
<td>(0.0, 0.5) if vertical; (0.5, 1.0) if horizontal;
the anchor point of the colorbar axes</td>
</tr>
<tr class="row-even"><td><em>panchor</em></td>
<td>(1.0, 0.5) if vertical; (0.5, 0.0) if horizontal;
the anchor point of the colorbar parent axes. If
False, the parent axes’ anchor will be unchanged</td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>colorbar properties:</p>
<blockquote>
<div><table border="1" class="docutils">
<colgroup>
<col width="18%" />
<col width="82%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Property</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><em>extend</em></td>
<td>[ ‘neither’ | ‘both’ | ‘min’ | ‘max’ ]
If not ‘neither’, make pointed end(s) for out-of-
range values.  These are set for a given colormap
using the colormap set_under and set_over methods.</td>
</tr>
<tr class="row-odd"><td><em>extendfrac</em></td>
<td>[ <em>None</em> | ‘auto’ | length | lengths ]
If set to <em>None</em>, both the minimum and maximum
triangular colorbar extensions with have a length of
5% of the interior colorbar length (this is the
default setting). If set to ‘auto’, makes the
triangular colorbar extensions the same lengths as
the interior boxes (when <em>spacing</em> is set to
‘uniform’) or the same lengths as the respective
adjacent interior boxes (when <em>spacing</em> is set to
‘proportional’). If a scalar, indicates the length
of both the minimum and maximum triangular colorbar
extensions as a fraction of the interior colorbar
length. A two-element sequence of fractions may also
be given, indicating the lengths of the minimum and
maximum colorbar extensions respectively as a
fraction of the interior colorbar length.</td>
</tr>
<tr class="row-even"><td><em>extendrect</em></td>
<td>[ <em>False</em> | <em>True</em> ]
If <em>False</em> the minimum and maximum colorbar extensions
will be triangular (the default). If <em>True</em> the
extensions will be rectangular.</td>
</tr>
<tr class="row-odd"><td><em>spacing</em></td>
<td>[ ‘uniform’ | ‘proportional’ ]
Uniform spacing gives each discrete color the same
space; proportional makes the space proportional to
the data interval.</td>
</tr>
<tr class="row-even"><td><em>ticks</em></td>
<td>[ None | list of ticks | Locator object ]
If None, ticks are determined automatically from the
input.</td>
</tr>
<tr class="row-odd"><td><em>format</em></td>
<td>[ None | format string | Formatter object ]
If None, the
<code class="xref py py-class docutils literal"><span class="pre">ScalarFormatter</span></code> is used.
If a format string is given, e.g., ‘%.3f’, that is
used. An alternative
<code class="xref py py-class docutils literal"><span class="pre">Formatter</span></code> object may be
given instead.</td>
</tr>
<tr class="row-even"><td><em>drawedges</em></td>
<td>[ False | True ] If true, draw lines at color
boundaries.</td>
</tr>
</tbody>
</table>
<p>The following will probably be useful only in the context of
indexed colors (that is, when the mappable has norm=NoNorm()),
or other unusual circumstances.</p>
<table border="1" class="docutils">
<colgroup>
<col width="19%" />
<col width="81%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Property</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><em>boundaries</em></td>
<td>None or a sequence</td>
</tr>
<tr class="row-odd"><td><em>values</em></td>
<td>None or a sequence which must be of length 1 less
than the sequence of <em>boundaries</em>. For each region
delimited by adjacent entries in <em>boundaries</em>, the
color mapped to the corresponding value in values
will be used.</td>
</tr>
</tbody>
</table>
</div></blockquote>
</div></blockquote>
<p>If <em>mappable</em> is a <code class="xref py py-class docutils literal"><span class="pre">ContourSet</span></code>, its <em>extend</em>
kwarg is included automatically.</p>
<p>Note that the <em>shrink</em> kwarg provides a simple way to keep a vertical
colorbar, for example, from being taller than the axes of the mappable
to which the colorbar is attached; but it is a manual method requiring
some trial and error. If the colorbar is too tall (or a horizontal
colorbar is too wide) use a smaller value of <em>shrink</em>.</p>
<p>For more precise control, you can manually specify the positions of
the axes objects in which the mappable and the colorbar are drawn.  In
this case, do not use any of the axes properties kwargs.</p>
<p>It is known that some vector graphics viewer (svg and pdf) renders white gaps
between segments of the colorbar. This is due to bugs in the viewers not
matplotlib. As a workaround the colorbar can be rendered with overlapping
segments:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">cbar</span> <span class="o">=</span> <span class="n">colorbar</span><span class="p">()</span>
<span class="n">cbar</span><span class="o">.</span><span class="n">solids</span><span class="o">.</span><span class="n">set_edgecolor</span><span class="p">(</span><span class="s2">&quot;face&quot;</span><span class="p">)</span>
<span class="n">draw</span><span class="p">()</span>
</pre></div>
</div>
<p>However this has negative consequences in other circumstances. Particularly
with semi transparent images (alpha &lt; 1) and colorbar extensions and is not
enabled by default see (issue #1188).</p>
</dd></dl>

<dl class="function">
<dt id="pypec.modplot.figure">
<code class="descclassname">pypec.modplot.</code><code class="descname">figure</code><span class="sig-paren">(</span><em>num=None</em>, <em>figsize=None</em>, <em>dpi=None</em>, <em>facecolor=None</em>, <em>edgecolor=None</em>, <em>frameon=True</em>, <em>FigureClass=&lt;class 'matplotlib.figure.Figure'&gt;</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pypec/modplot.html#figure"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypec.modplot.figure" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="pypec.modplot.line_downsample">
<code class="descclassname">pypec.modplot.</code><code class="descname">line_downsample</code><span class="sig-paren">(</span><em>line</em>, <em>npts=1000</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pypec/modplot.html#line_downsample"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypec.modplot.line_downsample" title="Permalink to this definition">¶</a></dt>
<dd><p>Downsample line data for increased plotting speed.</p>
<dl class="docutils">
<dt>Key Word Arguments: </dt>
<dd><dl class="first last docutils">
<dt>npts <span class="classifier-delimiter">:</span> <span class="classifier">int. </span></dt>
<dd>Number of data points within axes xlims.</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="pypec.modplot.onkey">
<code class="descclassname">pypec.modplot.</code><code class="descname">onkey</code><span class="sig-paren">(</span><em>event</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pypec/modplot.html#onkey"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypec.modplot.onkey" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to connect key_press_event events from matplotlib
to custom functions.</p>
<p>Matplotlib defaults (may be changed in matplotlibrc):</p>
<p>keymap.fullscreen : f               # toggling
keymap.home : h, r, home            # home or reset mnemonic
keymap.back : left, c, backspace    # forward / backward keys to enable
keymap.forward : right, v           #   left handed quick navigation
keymap.pan : p                      # pan mnemonic
keymap.zoom : o                     # zoom mnemonic
keymap.save : s                     # saving current figure
keymap.quit : ctrl+w                # close the current figure
keymap.grid : g                     # switching on/off a grid in current axes
keymap.yscale : l                   # toggle scaling of y-axes (‘log’/’linear’)
keymap.xscale : L, k                # toggle scaling of x-axes (‘log’/’linear’)
keymap.all_axes : a                 # enable all axes</p>
<p>My custom function mapping:</p>
<p>popaxes : n                         #Creates new figure with current axes
tighten : t                         #Call tight_layout bound method for figure</p>
</dd></dl>

<dl class="function">
<dt id="pypec.modplot.plot_axes">
<code class="descclassname">pypec.modplot.</code><code class="descname">plot_axes</code><span class="sig-paren">(</span><em>ax</em>, <em>fig=None</em>, <em>geometry=(1</em>, <em>1</em>, <em>1)</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pypec/modplot.html#plot_axes"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypec.modplot.plot_axes" title="Permalink to this definition">¶</a></dt>
<dd><p>Re-create a given axis in a new figure. This allows, for instance,
a subplot to be moved to its own figure where it can be manipulated
and/or saved independent of the original.</p>
<dl class="docutils">
<dt>Arguments:   </dt>
<dd><dl class="first last docutils">
<dt>ax <span class="classifier-delimiter">:</span> <span class="classifier">obj. </span></dt>
<dd>An initialized Axes object</dd>
</dl>
</dd>
<dt>Key Word Arguments: </dt>
<dd><dl class="first last docutils">
<dt>fig: obj. </dt>
<dd>A figure in which to re-create the axis</dd>
<dt>geometry <span class="classifier-delimiter">:</span> <span class="classifier">tuple. </span></dt>
<dd>Axes geometry of re-created axis</dd>
</dl>
</dd>
<dt>returns    </dt>
<dd>Figure.</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="pypec.modplot.png_to_gif">
<code class="descclassname">pypec.modplot.</code><code class="descname">png_to_gif</code><span class="sig-paren">(</span><em>files</em>, <em>gif_file</em>, <em>delay=20</em>, <em>loop=0</em>, <em>clean=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pypec/modplot.html#png_to_gif"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypec.modplot.png_to_gif" title="Permalink to this definition">¶</a></dt>
<dd><p>gif_file should end in .gif</p>
</dd></dl>

<dl class="function">
<dt id="pypec.modplot.printlines">
<code class="descclassname">pypec.modplot.</code><code class="descname">printlines</code><span class="sig-paren">(</span><em>self</em>, <em>filename</em>, <em>labeled_only=False</em>, <em>squeeze=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pypec/modplot.html#printlines"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypec.modplot.printlines" title="Permalink to this definition">¶</a></dt>
<dd><p>Print all data in line plot(s) to text file.The x values 
will be taken from the line with the greatest number of
points in the (first) axis, and other lines are interpolated
if their x values do not match. Column lables are the
line labels and xlabel.</p>
<dl class="docutils">
<dt>Arguments:</dt>
<dd><dl class="first last docutils">
<dt>filename <span class="classifier-delimiter">:</span> <span class="classifier">str. </span></dt>
<dd>Path to print to.</dd>
</dl>
</dd>
<dt>Key Word Arguments:</dt>
<dd><dl class="first last docutils">
<dt>labeled_only <span class="classifier-delimiter">:</span> <span class="classifier">bool</span></dt>
<dd>Only print labeled lines to file.</dd>
<dt>squeeze <span class="classifier-delimiter">:</span> <span class="classifier">bool.</span></dt>
<dd>Print lines from all axes in a single table.</dd>
</dl>
</dd>
<dt>returns</dt>
<dd><dl class="first last docutils">
<dt>bool. </dt>
<dd>True.</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="pypec.modplot.set_linearray">
<code class="descclassname">pypec.modplot.</code><code class="descname">set_linearray</code><span class="sig-paren">(</span><em>lines</em>, <em>values=None</em>, <em>cmap=None</em>, <em>vmin=None</em>, <em>vmax=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pypec/modplot.html#set_linearray"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypec.modplot.set_linearray" title="Permalink to this definition">¶</a></dt>
<dd><p>Set colors of lines to colormaping of values.</p>
<p>Other good sequential colormaps are YlOrBr and autumn.
A good diverging colormap is bwr.</p>
<dl class="docutils">
<dt><strong>Arguments:</strong></dt>
<dd><ul class="first last simple">
<li>lines : list. Lines to get set colors.</li>
</ul>
</dd>
<dt><strong>Key Word Arguments:</strong></dt>
<dd><ul class="first last simple">
<li>values : array like. Values corresponding to each line. Default is indexing.</li>
<li>cmap : str. Valid matplotlib colormap name.</li>
<li>vmax : float. Upper bound of colormaping.</li>
<li>vmin : float. Lower bound of colormaping.</li>
</ul>
</dd>
<dt><strong>Returns:</strong></dt>
<dd><ul class="first last simple">
<li>ScalarMappable. A mapping object used for colorbars.</li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="pypec.modplot.set_style">
<code class="descclassname">pypec.modplot.</code><code class="descname">set_style</code><span class="sig-paren">(</span><em>style=None</em>, <em>rc={}</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pypec/modplot.html#set_style"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypec.modplot.set_style" title="Permalink to this definition">¶</a></dt>
<dd><p>Seaborn set_style with additional ‘thick’,</p>
<p>Thick (thin) style multiplies rcParams axes.linewidth, lines.linewidth,
xtick.major.width, xtick.minor.width, ytick.major.width, and 
ytick.minor.width by 2 (0.5).</p>
</dd></dl>

<dl class="function">
<dt id="pypec.modplot.shiftedColorMap">
<code class="descclassname">pypec.modplot.</code><code class="descname">shiftedColorMap</code><span class="sig-paren">(</span><em>cmap</em>, <em>start=0</em>, <em>midpoint=0.5</em>, <em>stop=1.0</em>, <em>name='shiftedcmap'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pypec/modplot.html#shiftedColorMap"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypec.modplot.shiftedColorMap" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to offset the “center” of a colormap. Useful for
data with a negative min and positive max and you want the
middle of the colormap’s dynamic range to be at zero.</p>
<p>Taken from <a class="reference external" href="http://stackoverflow.com/questions/7404116/defining-the-midpoint-of-a-colormap-in-matplotlib">http://stackoverflow.com/questions/7404116/defining-the-midpoint-of-a-colormap-in-matplotlib</a></p>
<dl class="docutils">
<dt>Args:</dt>
<dd>cmap: The matplotlib colormap to be altered
start: Offset from lowest point in the colormap’s range. Should be between 0 and ‘midpoint’.
midpoint: The new center of the colormap. Should be between 0.0 and 1.0. Recommended is  1 - vmax/(vmax + abs(vmin)).
stop: Offset from highest point in the colormap’s range. Should be between ‘midpoint’ and 1.0.
name: str. Added to the name of cmap when creating the new colormap.</dd>
</dl>
<p>Example:</p>
<p>The following creates a shifted colormap that can be used in matplotlib arguments,</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">orig_cmap</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">coolwarm</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">shifted_cmap</span> <span class="o">=</span> <span class="n">shiftedColorMap</span><span class="p">(</span><span class="n">orig_cmap</span><span class="p">,</span> <span class="n">midpoint</span><span class="o">=</span><span class="mf">0.75</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;shifted&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pypec.modplot.subplots">
<code class="descclassname">pypec.modplot.</code><code class="descname">subplots</code><span class="sig-paren">(</span><em>nrows=1</em>, <em>ncols=1</em>, <em>sharex=False</em>, <em>sharey=False</em>, <em>squeeze=True</em>, <em>autosize=True</em>, <em>subplot_kw=None</em>, <em>powerlim=(-3</em>, <em>3)</em>, <em>useOffset=False</em>, <em>nybins=None</em>, <em>nxbins=None</em>, <em>**fig_kw</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pypec/modplot.html#subplots"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypec.modplot.subplots" title="Permalink to this definition">¶</a></dt>
<dd><p>Matplotlib subplots with default figsize = rcp_size*[ncols,nrows]
fig_kw.setdefault(‘figsize’,figsize).</p>
<dl class="docutils">
<dt>Additional Key Word Arguments:</dt>
<dd><dl class="first last docutils">
<dt>powlim <span class="classifier-delimiter">:</span> <span class="classifier">tuple. </span></dt>
<dd>Axis labels use scientific notion above 10^power.</dd>
<dt>useOffset <span class="classifier-delimiter">:</span> <span class="classifier">bool. </span></dt>
<dd>Axis labels use offset if range&lt;&lt;average.</dd>
</dl>
</dd>
</dl>
<p>Accepts standargs args and kwargs for pyplot.subplots.</p>
<p>ORIGINAL DOCUMENTATION</p>
<p>Create a figure and a set of subplots</p>
<p>This utility wrapper makes it convenient to create common layouts of
subplots, including the enclosing figure object, in a single call.</p>
<dl class="docutils">
<dt>nrows, ncols <span class="classifier-delimiter">:</span> <span class="classifier">int, optional, default: 1</span></dt>
<dd>Number of rows/columns of the subplot grid.</dd>
<dt>sharex, sharey <span class="classifier-delimiter">:</span> <span class="classifier">bool or {‘none’, ‘all’, ‘row’, ‘col’}, default: False</span></dt>
<dd><p class="first">Controls sharing of properties among x (<cite>sharex</cite>) or y (<cite>sharey</cite>)
axes:</p>
<blockquote>
<div><ul class="simple">
<li>True or ‘all’: x- or y-axis will be shared among all
subplots.</li>
<li>False or ‘none’: each subplot x- or y-axis will be
independent.</li>
<li>‘row’: each subplot row will share an x- or y-axis.</li>
<li>‘col’: each subplot column will share an x- or y-axis.</li>
</ul>
</div></blockquote>
<p class="last">When subplots have a shared x-axis along a column, only the x tick
labels of the bottom subplot are visible.  Similarly, when subplots
have a shared y-axis along a row, only the y tick labels of the first
column subplot are visible.</p>
</dd>
<dt>squeeze <span class="classifier-delimiter">:</span> <span class="classifier">bool, optional, default: True</span></dt>
<dd><ul class="first last">
<li><p class="first">If True, extra dimensions are squeezed out from the returned Axes
object:</p>
<blockquote>
<div><ul class="simple">
<li>if only one subplot is constructed (nrows=ncols=1), the
resulting single Axes object is returned as a scalar.</li>
<li>for Nx1 or 1xN subplots, the returned object is a 1D numpy
object array of Axes objects are returned as numpy 1D arrays.</li>
<li>for NxM, subplots with N&gt;1 and M&gt;1 are returned as a 2D arrays.</li>
</ul>
</div></blockquote>
</li>
<li><p class="first">If False, no squeezing at all is done: the returned Axes object is
always a 2D array containing Axes instances, even if it ends up
being 1x1.</p>
</li>
</ul>
</dd>
<dt>subplot_kw <span class="classifier-delimiter">:</span> <span class="classifier">dict, optional</span></dt>
<dd>Dict with keywords passed to the
<code class="xref py py-meth docutils literal"><span class="pre">add_subplot()</span></code> call used to create each
subplot.</dd>
<dt>gridspec_kw <span class="classifier-delimiter">:</span> <span class="classifier">dict, optional</span></dt>
<dd>Dict with keywords passed to the
<code class="xref py py-class docutils literal"><span class="pre">GridSpec</span></code> constructor used to create the
grid the subplots are placed on.</dd>
<dt><a href="#id3"><span class="problematic" id="id4">**</span></a>fig_kw :</dt>
<dd>All additional keyword arguments are passed to the <a class="reference internal" href="#pypec.modplot.figure" title="pypec.modplot.figure"><code class="xref py py-func docutils literal"><span class="pre">figure()</span></code></a> call.</dd>
</dl>
<p>fig : <code class="xref py py-class docutils literal"><span class="pre">matplotlib.figure.Figure</span></code> object</p>
<p>ax : Axes object or array of Axes objects.</p>
<blockquote>
<div>ax can be either a single <code class="xref py py-class docutils literal"><span class="pre">matplotlib.axes.Axes</span></code> object or an
array of Axes objects if more than one subplot was created.  The
dimensions of the resulting array can be controlled with the squeeze
keyword, see above.</div></blockquote>
<p>First create some toy data:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">400</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<p>Creates just a figure and only one subplot</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Simple plot&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Creates two subplots and unpacks the output array immediately</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Sharing Y axis&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax2</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
<p>Creates four polar axes, and accesses them through the returned array</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">subplot_kw</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">polar</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
<p>Share a X axis with each column of subplots</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="s1">&#39;col&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Share a Y axis with each row of subplots</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="s1">&#39;row&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Share both X and Y axes with all subplots</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Note that this is the same as</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>figure
subplot</p>
</dd></dl>

<dl class="function">
<dt id="pypec.modplot.xyaxes">
<code class="descclassname">pypec.modplot.</code><code class="descname">xyaxes</code><span class="sig-paren">(</span><em>axes</em>, <em>x=True</em>, <em>y=True</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pypec/modplot.html#xyaxes"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypec.modplot.xyaxes" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot hline and vline through (0,0).</p>
<dl class="docutils">
<dt><strong>Arguments:</strong></dt>
<dd><ul class="first last simple">
<li>axes : obj. Matplotlib Axes object.</li>
</ul>
</dd>
<dt><strong>key Word Arguments:</strong></dt>
<dd><ul class="first last simple">
<li>x : bool. Draw hline</li>
<li>y : bool. Draw vline</li>
</ul>
</dd>
<dt><strong>Returns:</strong></dt>
<dd><ul class="first last simple">
<li>bool.</li>
</ul>
</dd>
</dl>
<p>All other kwargs passed to hlines and vlines functions.</p>
</dd></dl>

</div>
</div>
<span class="target" id="module-regression"></span><span class="target" id="module-regression.compare"></span><div class="section" id="regression-compare-for-comparing-restults">
<h2><a class="reference internal" href="#module-regression.compare" title="regression.compare"><code class="xref py py-mod docutils literal"><span class="pre">regression.compare</span></code></a> – For Comparing Restults<a class="headerlink" href="#regression-compare-for-comparing-restults" title="Permalink to this headline">¶</a></h2>
<p>Python modules for regression testing and benchmarking GPEC
code developments.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Author:</th><td class="field-body">N.C. Logan</td>
</tr>
<tr class="field-even field"><th class="field-name">Location:</th><td class="field-body">Princeton Plasma Physics Laboratory</td>
</tr>
<tr class="field-odd field"><th class="field-name">Email:</th><td class="field-body"><a class="reference external" href="mailto:nlogan&#37;&#52;&#48;pppl&#46;gov">nlogan<span>&#64;</span>pppl<span>&#46;</span>gov</a></td>
</tr>
</tbody>
</table>
<div class="section" id="interface">
<h3>Interface<a class="headerlink" href="#interface" title="Permalink to this headline">¶</a></h3>
<p>The compare submodules can be run as an executable from a linux terminal, and take one or more directory paths as arguments. Each check function will be called for the directories and the plots displayed. Be warned, this may create a large number of plots.</p>
<p>For example,</p>
<blockquote>
<div>$ ./compare_dcons.py /p/gpec/GPEC-0.4/docs/examples/DIIID_example /p/gpec/GPEC-1.0/docs/examples/DIIID_ideal_example</div></blockquote>
<p>Individual checks can be called from an interactive python environment (see <a class="reference internal" href="#module-pypec" title="pypec"><code class="xref py py-mod docutils literal"><span class="pre">pypec</span></code></a>).</p>
<p>For example,</p>
<blockquote>
<div>$ ipython –pylab</div></blockquote>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">regression.compare</span> <span class="k">import</span> <span class="n">compare_dcons</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">compare_dcons</span><span class="o">.</span><span class="n">check_energies</span><span class="p">(</span><span class="s1">&#39;/p/gpec/GPEC-0.4/docs/examples/DIIID_example&#39;</span><span class="p">,</span><span class="s1">&#39;/p/gpec/GPEC-1.0/docs/examples/DIIID_ideal_example&#39;</span><span class="p">)</span>
</pre></div>
</div>
<blockquote>
<div>/p/gpec/GPEC-0.4/d…   /p/gpec/GPEC-1.0/d…</div></blockquote>
<p>vacuum                  +2.4850e+00             +2.5020e+00</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">pyplot</span><span class="o">.</span><span class="n">gcf</span><span class="p">()</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;examples/figures/example_compare_dcons.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="examples/figures/example_compare_dcons.png"><img alt="examples/figures/example_compare_dcons.png" src="examples/figures/example_compare_dcons.png" style="width: 600px;" /></a>
</div>
</div>
</div>


    </div>
    
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
        <br/>
        
<div id="sourcelink">
  <a href="_sources/source_documentation.rst.txt"
     rel="nofollow">Source</a>
</div>
      
    </p>
    <p>
        &copy; Copyright 2015, PPPL.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.6.7.<br/>
    </p>
  </div>
</footer>
  </body>
</html>