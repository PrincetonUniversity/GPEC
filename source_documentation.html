<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>PYPEC Source documentation &mdash; GPEC 0.3.4 documentation</title>
    
    <link rel="stylesheet" href="_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.3.4',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="top" title="GPEC 0.3.4 documentation" href="index.html" />
    <link rel="next" title="Accessing Releases" href="releases.html" />
    <link rel="prev" title="Tutorial Examples" href="examples.html" /> 
  </head>
  <body>

<div style="background-color: white; text-align: left; padding: 10px 10px 15px 15px">
<a href="index.html"><img src="_static/logo.png" border="0" alt="py4sci"/></a>
</div>

    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="releases.html" title="Accessing Releases"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="examples.html" title="Tutorial Examples"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">home</a>|&nbsp;</li>
        <li><a href="search.html">search</a>|&nbsp;</li>
 
      </ul>
    </div>

      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">PYPEC Source documentation</a><ul>
<li><a class="reference internal" href="#pypec-main-package"><tt class="docutils literal"><span class="pre">pypec</span></tt> &#8211; Main Package</a></li>
<li><a class="reference internal" href="#python-at-pppl">Python at PPPL</a><ul>
<li><a class="reference internal" href="#python-tutorials">Python Tutorials</a></li>
<li><a class="reference internal" href="#setting-your-personal-defaults">Setting Your Personal Defaults</a></li>
<li><a class="reference internal" href="#using-the-best-environement">Using the Best Environement</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pypec-data-ascii-table-data-turned-pythonic"><tt class="docutils literal"><span class="pre">pypec.data</span></tt> &#8211; ASCII Table Data Turned Pythonic</a><ul>
<li><a class="reference internal" href="#beginners">Beginners</a></li>
<li><a class="reference internal" href="#advanced-users">Advanced Users</a></li>
<li><a class="reference internal" href="#deprecated-ascii-interface">Deprecated Ascii Interface</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pypec-post-post-processing-fundamental-gpec-outputs"><tt class="docutils literal"><span class="pre">pypec.post</span></tt> &#8211; Post-Processing Fundamental GPEC Outputs</a><ul>
<li><a class="reference internal" href="#examples">Examples</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pypec-gpec-python-wrappers-for-fortran-codes"><tt class="docutils literal"><span class="pre">pypec.gpec</span></tt> &#8211; Python Wrappers for FORTRAN Codes</a></li>
<li><a class="reference internal" href="#pypec-namelist-io-for-fortran-namelists"><tt class="docutils literal"><span class="pre">pypec.namelist</span></tt> &#8211; IO for FORTRAN Namelists</a><ul>
<li><a class="reference internal" href="#id1">Examples</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pypec-modplot-matplotlib-customizations"><tt class="docutils literal"><span class="pre">pypec.modplot</span></tt> &#8211; matplotlib Customizations</a><ul>
<li><a class="reference internal" href="#id2">Examples</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="examples.html"
                        title="previous chapter">Tutorial Examples</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="releases.html"
                        title="next chapter">Accessing Releases</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/source_documentation.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="module-pypec">
<span id="pypec-source-documentation"></span><span id="source-documentation"></span><h1>PYPEC Source documentation<a class="headerlink" href="#module-pypec" title="Permalink to this headline">¶</a></h1>
<div class="section" id="pypec-main-package">
<h2><a class="reference internal" href="#module-pypec" title="pypec"><tt class="xref py py-mod docutils literal"><span class="pre">pypec</span></tt></a> &#8211; Main Package<a class="headerlink" href="#pypec-main-package" title="Permalink to this headline">¶</a></h2>
<p>Python modules for data visualization and postprocessing, 
as well as python wrappers for IPEC and PENT.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Author:</th><td class="field-body">N.C. Logan</td>
</tr>
<tr class="field-even field"><th class="field-name">Location:</th><td class="field-body">Princeton Plasma Physics Laboratory</td>
</tr>
<tr class="field-odd field"><th class="field-name">Email:</th><td class="field-body"><a class="reference external" href="mailto:nlogan&#37;&#52;&#48;pppl&#46;gov">nlogan<span>&#64;</span>pppl<span>&#46;</span>gov</a></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="python-at-pppl">
<h2>Python at PPPL<a class="headerlink" href="#python-at-pppl" title="Permalink to this headline">¶</a></h2>
<p>To set up python on portal at PPPL, insert the 
following lines into your .bashrc file:</p>
<blockquote>
<div>export PYTHONPATH=$PYTHONPATH:/path/to/gpec
module load anaconda/2.3.0</div></blockquote>
<p>..note: Anaconda is the most complete and current python distribution
available at pppl. Users can also use locally built python/2.7.2, but
will loose 3D plotting capabilities and may experience problems reading
large data files.</p>
<p>Obviously, &#8220;/path/to/gpec&#8221; needs to be replaced with the path
to your installation of the GPEC package (containing the pypec directory).</p>
<p>For tcsh shell users, replace export with setenv syntax
and insert in .cshrc.</p>
<p>..note: Mayavi&#8217;s default gui api is not consistent with the anaconda
interactive python default. To enable 3D plotting, you must add
&#8220;export QT_API=pyqt&#8221; to your .bashrc or a similar line to your .cshrc.</p>
<p>To put the changes into effect:</p>
<blockquote>
<div>$ source ~/.bashrc</div></blockquote>
<p>Users are futher encouraged to create a matplotlib rc file in
user ~/.config/matplotlib similar to /u/nlogan/.config/matplotlib/matplotlibrc.
This file sets a number of plotting defaults.</p>
<div class="section" id="python-tutorials">
<h3>Python Tutorials<a class="headerlink" href="#python-tutorials" title="Permalink to this headline">¶</a></h3>
<p>The 3 workhorse modules for scientific programming
in python are numpy, scipy and matplotlib (although
the third is really a personal preference). Tutorials
for each can be found at</p>
<p><a class="reference external" href="http://wiki.scipy.org/Tentative_NumPy_Tutorial">numpy tutorial</a></p>
<p><a class="reference external" href="http://docs.scipy.org/doc/scipy/reference/tutorial/">scipy tutorial</a></p>
<p><a class="reference external" href="http://matplotlib.org/users/pyplot_tutorial.html">matplotlib tutorial</a></p>
</div>
<div class="section" id="setting-your-personal-defaults">
<h3>Setting Your Personal Defaults<a class="headerlink" href="#setting-your-personal-defaults" title="Permalink to this headline">¶</a></h3>
<p>To set personal defualts for runs, edit the _defaults_.py file in
this directory. Some of these (like email) should be obvious, others
you may not understand until becoming more familiar with the package.
Do not worry if these are confusing, and feel free to skip them for now.</p>
</div>
<div class="section" id="using-the-best-environement">
<h3>Using the Best Environement<a class="headerlink" href="#using-the-best-environement" title="Permalink to this headline">¶</a></h3>
<p>The ipython (interactive) environment is recomended for commandline
data analysis. To start, it is easiest to auto-import a number of 
basic mathematic and visualization modules and use an enhanced 
interactivity for displaying figures. To do this enter:</p>
<blockquote>
<div>$ ipython &#8211;pylab</div></blockquote>
<p>Look into online tutorial on numpy and matplotlib. Advanced users 
are recomended to edit ~/.matplotlib/matplotlibrc and 
~/.ipython/profile_default/startup/autoimports.ipy files.</p>
<p>Now in the ipython envirnment, type</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pypec</span> <span class="kn">import</span> <span class="n">gpec</span><span class="p">,</span><span class="n">data</span> 
</pre></div>
</div>
<p>There may be a few warnings/hints... take them or leave them.</p>
</div>
</div>
<span class="target" id="module-pypec.data"></span><div class="section" id="pypec-data-ascii-table-data-turned-pythonic">
<h2><a class="reference internal" href="#module-pypec.data" title="pypec.data"><tt class="xref py py-mod docutils literal"><span class="pre">pypec.data</span></tt></a> &#8211; ASCII Table Data Turned Pythonic<a class="headerlink" href="#pypec-data-ascii-table-data-turned-pythonic" title="Permalink to this headline">¶</a></h2>
<p>The data module is a very generalized tool for visualizing and manipulating scientific data from netcdf and ascii files.</p>
<p>GPEC data is migrating to netcdf, and this module uses the xarray module for its python netcdf interface. The xarray module is very powerful and well documented <a class="reference external" href="http://xarray.readthedocs.org/">here</a>.</p>
<p>Previous GPEC results and some current outputs are still writen to ascii. This module contains a custom I/O for converting ascii data to python objects. A custom Data object was created for this purpose, and conversion to the xarray Dataset is automated in the open_dataset function to facilitate migration to netcdf. The only requirement for creating a data object from an ascii file is that the file have one or more tables of data, with appropriate labels in a header line directly above the data.</p>
<p>Here, we show some examples using common outputs from both IPEC and PENT.</p>
<div class="section" id="beginners">
<h3>Beginners<a class="headerlink" href="#beginners" title="Permalink to this headline">¶</a></h3>
<p>First, add your release of GPEC to your PYTHONPATH environment variable.</p>
<p>In an open ipython session, import the data module</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pypec</span> <span class="kn">import</span> <span class="n">data</span>
</pre></div>
</div>
<p>Explore the data module by typing &#8216;data.&#8217; and hitting tab. For information on any particular object in the module, use the &#8216;?&#8217; syntax or &#8216;help&#8217; function. For example, enter &#8216;data.read?&#8217;. You will see that it has a lot of metadata on this function, but the important things to look at for now are the arguments and key word arguments. These are passed to the function as shown in the Definition line... you can either pass a single string, or a string and specification for squeeze. If this confuses you, consult any of the many great python tutorials online.</p>
<p>Lets use it! To get a typical GPEC output into python, use the open_dataset function.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">con</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="s">&#39;examples/DIIID_ideal_example/ipec_control_output_n1.nc&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Printing to the terminal is intelegent, giving a conviniently human readable summary of the data.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">con</span>
<span class="go">&lt;xarray.Dataset&gt;</span>
<span class="go">Dimensions:        (i: 2, m: 129, mode: 34, mode_PX: 34, mode_RX: 34, mode_SC: 4, mode_WX: 34, mode_XT: 34, theta: 513)</span>
<span class="go">Coordinates:</span>
<span class="go">  * i              (i) int32 0 1</span>
<span class="go">  * m              (m) int32 -64 -63 -62 -61 -60 -59 -58 -57 -56 -55 -54 -53 ...</span>
<span class="go">  * mode           (mode) int32 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 ...</span>
<span class="go">  * mode_SC        (mode_SC) int32 1 2 3 4</span>
<span class="go">  * theta          (theta) float64 0.0 0.001953 0.003906 0.005859 0.007812 ...</span>
<span class="go">  * mode_XT        (mode_XT) int32 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 ...</span>
<span class="go">  * mode_WX        (mode_WX) int32 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 ...</span>
<span class="go">  * mode_RX        (mode_RX) int32 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 ...</span>
<span class="go">  * mode_PX        (mode_PX) int32 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 ...</span>
<span class="go">Data variables:</span>
<span class="go">    L              (mode, m) complex128 (-0.478146242223-0.0251176845733j) ...</span>
<span class="go">    Lambda         (mode, m) complex128 (1.4032106893e-07-3.56355823737e-08j) ...</span>
<span class="go">    P              (mode, m) complex128 (0.000212307471204-9.52839135614e-05j) ...</span>
<span class="go">    rho            (mode, m) complex128 (9.96920996839e+36+9.96920996839e+36j) ...</span>
<span class="go">    X_EDT          (mode_XT, m) complex128 (3.88116613338e-05+1.90243722796e-05j) ...</span>
<span class="go">    X_EVT          (mode_XT) float64 2.517e+04 1.334e+05 5.081e+05 1.119e+06 ...</span>
<span class="go">    W_EDX          (mode_WX, m) complex128 (2.0673520088e-06-4.52521668335e-07j) ...</span>
<span class="go">    W_EVX          (mode_WX) float64 8.543 2.882 2.516 1.137 0.8107 0.6662 ...</span>
<span class="go">    W_EVX_A        (mode_WX) float64 3.922e+05 7.805e+04 2.466e+05 3.042e+05 ...</span>
<span class="go">    W_EVX_energyv  (mode_WX) float64 6.701e+06 4.499e+05 1.241e+06 6.917e+05 ...</span>
<span class="go">    W_EVX_energys  (mode_WX) float64 6.383e+06 8.481e+05 1.724e+06 6.867e+05 ...</span>
<span class="go">    W_EVX_energyp  (mode_WX) float64 6.817e+06 5.582e+05 8.381e+05 5.807e+05 ...</span>
<span class="go">    R_EDX          (mode_RX, m) complex128 (-9.04352944467e-07-5.23229281269e-07j) ...</span>
<span class="go">    R_EVX          (mode_RX) float64 1.881e+06 8.165e+05 2.477e+05 1.895e+05 ...</span>
<span class="go">    R_EVX_RL       (mode_RX) float64 5.689 0.7149 0.3795 0.8092 0.2417 ...</span>
<span class="go">    R_EVX_energyv  (mode_RX) float64 4.298e+05 1.373e+06 1.01e+06 7.832e+05 ...</span>
<span class="go">    R_EVX_energys  (mode_RX) float64 8.994e+05 1.745e+06 1.096e+06 8.803e+05 ...</span>
<span class="go">    R_EVX_energyp  (mode_RX) float64 3.785e+05 8.975e+05 8.31e+05 6.814e+05 ...</span>
<span class="go">    P_EDX          (mode_PX, m) complex128 (-5.0711563448e-06-2.51239391938e-06j) ...</span>
<span class="go">    P_EVX          (mode_PX) float64 493.5 161.8 146.4 128.7 127.8 110.2 ...</span>
<span class="go">    O_WRX          (mode_RX, mode_WX) float64 0.082 0.99 0.08839 0.01132 ...</span>
<span class="go">    O_WPX          (mode_PX, mode_WX) float64 0.01414 0.9607 0.08296 0.01058 ...</span>
<span class="go">    O_RPX          (mode_PX, mode_RX) float64 0.9571 0.01583 0.02807 0.1558 ...</span>
<span class="go">    O_XT           (mode_XT) complex128 (0.00296215168999+0.00489536349583j) ...</span>
<span class="go">    O_WX           (mode_XT) complex128 (0.0101206436883-0.00397946238035j) ...</span>
<span class="go">    O_RX           (mode_RX) complex128 (-0.00967090555989-0.000112969521773j) ...</span>
<span class="go">    O_PX           (mode_PX) complex128 (-0.00598278876631+0.0105074013581j) ...</span>
<span class="go">    Phi_EX         (m) complex128 (-1.42853908779e-10-4.20811059626e-11j) ...</span>
<span class="go">    Phi_ET         (m) complex128 (-6.89310992668e-10-1.01978717443e-09j) ...</span>
<span class="go">    W_EDX_FUN      (mode_WX, theta) complex128 (-1.45421344314-0.0472501327701j) ...</span>
<span class="go">    R_EDX_FUN      (mode_RX, theta) complex128 (1.45665015126-0.521253285202j) ...</span>
<span class="go">    b_nm           (m) complex128 (-9.46126704696e-10+1.48737377032e-09j) ...</span>
<span class="go">    b_xnm          (m) complex128 (-5.48365827795e-10+5.89720875704e-10j) ...</span>
<span class="go">    xi_nm          (m) complex128 (-3.3871234611e-09-1.86371281018e-09j) ...</span>
<span class="go">    xi_xnm         (m) complex128 (-6.60388933097e-10+2.7635104984e-09j) ...</span>
<span class="go">    xi_n           (theta) complex128 (0.000402066428626+0.00260098774146j) ...</span>
<span class="go">    xi_xn          (theta) complex128 (-0.000601114809848-0.00197978522356j) ...</span>
<span class="go">    b_n            (theta) complex128 (-0.00157772177652+0.00052698051739j) ...</span>
<span class="go">    b_xn           (theta) complex128 (-0.000920387597747+0.000315158824532j) ...</span>
<span class="go">    R              (theta) float64 2.289 2.289 2.288 2.287 2.286 2.284 2.282 ...</span>
<span class="go">    z              (theta) float64 0.02442 0.03972 0.05506 0.07046 0.08596 ...</span>
<span class="go">    R_n            (theta) float64 1.0 0.9995 0.9981 0.9959 0.9928 0.9889 ...</span>
<span class="go">    z_n            (theta) float64 0.003568 0.03241 0.06134 0.09036 0.1195 ...</span>
<span class="go">    dphi           (theta) float64 0.0 -0.039 -0.078 -0.117 -0.1559 -0.1948 ...</span>
<span class="go">Attributes:</span>
<span class="go">    title: IPEC outputs in Fourier or alternate modal bases</span>
<span class="go">    Jacobian: pest</span>
<span class="go">    q_lim: 5.2</span>
<span class="go">    psi_n_lim: 0.991536136179</span>
<span class="go">    shot: 147131</span>
<span class="go">    time: 2300</span>
<span class="go">    machine: DIII-D</span>
<span class="go">    n: 1</span>
<span class="go">    version: GPEC version 0.3.1</span>
<span class="go">    long_name: Surface Inductance</span>
<span class="go">    energy_vacuum: 3.28697635252</span>
<span class="go">    energy_surface: 7.8714975121</span>
<span class="go">    energy_plasma: 3.7597335618</span>
</pre></div>
</div>
<p>We see the data contains dimensions, variables, and global attributes. Some individual data arrays may have attributes as well.</p>
<p>For quick visualization, we can use xarray&#8217;s built in plotting routines,</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">xarray.plot</span> <span class="kn">as</span> <span class="nn">xplot</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f1</span><span class="p">,</span><span class="n">a1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l1</span> <span class="o">=</span> <span class="n">xplot</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">con</span><span class="p">[</span><span class="s">&#39;W_EVX&#39;</span><span class="p">])</span> <span class="c"># 1D data, returns a list of lines</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f1</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s">&#39;examples/figures/example_eigenvalues.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/example_eigenvalues.png"><img alt="_images/example_eigenvalues.png" src="_images/example_eigenvalues.png" style="width: 600px;" /></a>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">f2</span><span class="p">,</span><span class="n">a2</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l2</span> <span class="o">=</span> <span class="n">xplot</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">con</span><span class="p">[</span><span class="s">&#39;W_EDX&#39;</span><span class="p">])</span> <span class="c"># This is 2D, returns Quadmesh</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f2</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s">&#39;examples/figures/example_eigenvectors.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/example_eigenvectors.png"><img alt="_images/example_eigenvectors.png" src="_images/example_eigenvectors.png" style="width: 600px;" /></a>
<p>Note this uses matplotlib, and the plots are fully interactive. Navigate and zoom using the toolbar below plots.</p>
<p>This is not the recommended way to display detailed studies using GPEC data, however. It is
recommended that the user familiarise themselves with matplotlib (there are many great online
tutorials) and write their own scripts for plotting the data of interest, as details will
inevitably need tweaking.</p>
<p>For a common example of more customized plots, lets look at some 2d data</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">cyl</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="s">&#39;examples/DIIID_ideal_example/ipec_cylindrical_output_n1.nc&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>We could use the built in plotting methods like ds[&#8216;b_z&#8217;].plot), but these are (R,z) figures
should be done with a little care to look right. Lets look at b_z for example,</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">plt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">v</span> <span class="o">=</span> <span class="n">cyl</span><span class="p">[</span><span class="s">&#39;b_z&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">im</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">v</span><span class="p">),</span><span class="n">aspect</span><span class="o">=</span><span class="s">&#39;equal&#39;</span><span class="p">,</span><span class="n">origin</span><span class="o">=</span><span class="s">&#39;lower&#39;</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="s">&#39;RdBu&#39;</span><span class="p">,</span><span class="n">vmin</span><span class="o">=-</span><span class="mf">2e-3</span><span class="p">,</span><span class="n">vmax</span><span class="o">=</span><span class="mf">2e-3</span><span class="p">,</span>
<span class="gp">... </span>         <span class="n">extent</span><span class="o">=</span><span class="p">[</span><span class="n">v</span><span class="p">[</span><span class="s">&#39;R&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span><span class="n">v</span><span class="p">[</span><span class="s">&#39;R&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span><span class="n">v</span><span class="p">[</span><span class="s">&#39;z&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span><span class="n">v</span><span class="p">[</span><span class="s">&#39;z&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()],</span>
<span class="gp">... </span>         <span class="n">interpolation</span><span class="o">=</span><span class="s">&#39;gaussian&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cb</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cb</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s">&#39;$\delta B_z$&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xtks</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mf">1.7</span><span class="p">,</span><span class="mf">2.4</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xtxt</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s">&#39;R (m)&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ytxt</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s">&#39;z (m)&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s">&#39;examples/figures/example_pbrzphi.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/example_pbrzphi.png"><img alt="_images/example_pbrzphi.png" src="_images/example_pbrzphi.png" style="width: 600px;" /></a>
<p>There we go. That looks publication ready!</p>
<p>Another common plot of GPEC outputs is the (psi,m) spectrogram plot. Lets quickly make a
nice one,</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">prof</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="s">&#39;examples/DIIID_ideal_example/ipec_profile_output_n1.nc&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">extent</span> <span class="o">=</span> <span class="p">[</span><span class="n">prof</span><span class="p">[</span><span class="s">&#39;m&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span><span class="n">prof</span><span class="p">[</span><span class="s">&#39;m&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span><span class="n">prof</span><span class="p">[</span><span class="s">&#39;psi_n&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span><span class="n">prof</span><span class="p">[</span><span class="s">&#39;psi_n&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">im</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">prof</span><span class="p">[</span><span class="s">&#39;xi_m_contrapsi&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">T</span><span class="p">,</span><span class="n">origin</span><span class="o">=</span><span class="s">&#39;lower&#39;</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="s">&#39;viridis&#39;</span><span class="p">,</span>
<span class="gp">... </span>               <span class="n">interpolation</span><span class="o">=</span><span class="s">&#39;nearest&#39;</span><span class="p">,</span><span class="n">aspect</span><span class="o">=</span><span class="s">&#39;auto&#39;</span><span class="p">,</span><span class="n">extent</span><span class="o">=</span><span class="n">extent</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cb</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cb</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s">r&#39;$\xi^\psi_m$&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lim</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">20</span><span class="p">,</span><span class="mi">20</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xtxt</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s">&#39;m&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ytxt</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s">r&#39;$\psi$&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s">&#39;examples/figures/example_xispectrogram.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/example_xispectrogram.png"><img alt="_images/example_xispectrogram.png" src="_images/example_xispectrogram.png" style="width: 600px;" /></a>
<p>Note that the choice of interpolation resulted in discrete bands in m, which is true
to the the discrete fourier decomposition used in the codes and provides a more intuitive
connection between what the user sees and what the code is calculating.</p>
<p>One of the many cool additions to matplotlib in the pypec package is the ability to
write line plots to tables. Lets look at a 1D mode spectrum plot for example,</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">9</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">lines</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">prof</span><span class="p">[</span><span class="s">&#39;psi_n&#39;</span><span class="p">],</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">prof</span><span class="p">[</span><span class="s">&#39;xi_m_contrapsi&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">m</span><span class="o">=</span><span class="n">m</span><span class="p">)),</span><span class="n">label</span><span class="o">=</span><span class="s">r&#39;m={:}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">m</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mappable</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">set_linearray</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">lines</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="s">&#39;viridis&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ytxt</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s">r&#39;$\xi^\psi_m$&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xtxt</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s">r&#39;$\psi$&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">leg</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">ncol</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s">&#39;examples/figures/example_xim.png&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">printlines</span><span class="p">(</span><span class="s">&#39;examples/figures/example_xim.txt&#39;</span><span class="p">,</span><span class="n">squeeze</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">Wrote lines to examples/figures/example_xim.txt</span>
<span class="go">True</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/example_xim.png"><img alt="_images/example_xim.png" src="_images/example_xim.png" style="width: 600px;" /></a>
<p>That&#8217;s it! Read the table with your favorite editor. It will probably need a little
cleaning at the top since it tries to use the lengthy legend labels as column headers.</p>
<p>At this point we have outlined the basics. Using this module and similar commands
to those used here the user should be able to fully interact with and visually
explore the GPEC output.</p>
</div>
<div class="section" id="advanced-users">
<h3>Advanced Users<a class="headerlink" href="#advanced-users" title="Permalink to this headline">¶</a></h3>
<p>In this section, we will assume you have a pretty good hold on both python and the basic ploting functions of these modules.</p>
<p>Now that you use this module regularly, save yourself some time by placing the line:</p>
<blockquote>
<div>from pypec import *</div></blockquote>
<p>into your autoimport file located at
~/.ipython/profile_default/startup/autoimports.ipy</p>
</div>
<div class="section" id="deprecated-ascii-interface">
<h3>Deprecated Ascii Interface<a class="headerlink" href="#deprecated-ascii-interface" title="Permalink to this headline">¶</a></h3>
<p>As mentioned above, GPEC has moved the vast majority of its I/O to netcdf, and open_dataset should
be used to create xarray Dataset objects whenever possible. This section describes the deprecated
ascii interface for context, and motivates the move to netcdf.</p>
<p>Data in ascii tables can be read into a custom Data object using the read function,</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">mydata</span> <span class="o">=</span> <span class="n">read</span><span class="p">(</span><span class="s">&#39;examples/DIIID_ideal_example/g147131.02300_DIIID_KEFIT.kin&#39;</span><span class="p">)</span>
<span class="go">Casting table 1 into Data object.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">type</span><span class="p">(</span><span class="n">mydata</span><span class="p">),</span><span class="nb">len</span><span class="p">(</span><span class="n">mydata</span><span class="p">)</span>
<span class="go">(&lt;type &#39;list&#39;&gt;, 1)</span>
</pre></div>
</div>
<p>The read function creates a list of data objects corresponding to the tables in the text file. In this case, there is only one table. If we knew this ahead of time, we could have gotten the data object directly by splitting the list.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">mydata</span> <span class="o">=</span> <span class="n">read</span><span class="p">(</span><span class="s">&#39;examples/DIIID_ideal_example/g147131.02300_DIIID_KEFIT.kin&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">Casting table 1 into Data object.</span>
</pre></div>
</div>
<p>At its heart, the data object consists of independent data and dependent data. This are stored differently, namely as a list in the pts attribute and as a dictionary in y. The x attribute is a dictionary if the data is 1 dimensional or a regular grid is found in the first n columns of the data (n=2,3), and left empty if the n&gt;1 dependent data is irregular.</p>
<p>Explore the data using the corresponding python tools.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">mydata</span><span class="o">.</span><span class="n">xnames</span>
<span class="go">[&#39;psi&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mydata</span><span class="o">.</span><span class="n">y</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
<span class="go">[&#39;nim^3&#39;, &#39;tieV&#39;, &#39;teeV&#39;, &#39;wexbrad/s&#39;, &#39;nem^3&#39;]</span>
</pre></div>
</div>
<p>You would access the ion density data using mydata.y[&#8216;nim3&#8217;] for example.</p>
<p>The data object, however, is more that just a place holder for parced text files. It contains visualization and data manipulation tools. Plotting functions return interactive matplotlib Figure objects.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span> <span class="o">=</span> <span class="n">mydata</span><span class="o">.</span><span class="n">plot1d</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s">&#39;examples/figures/example_profiles.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/example_profiles.png"><img alt="_images/example_profiles.png" src="_images/example_profiles.png" style="width: 600px;" /></a>
<p>Interpolation returns a new Data object of the desired data, which can be one, multiple, or all of the dependent variables found in y.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">myinterp</span> <span class="o">=</span> <span class="n">mydata</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">0.1</span><span class="p">),[</span><span class="s">&#39;nim^3&#39;</span><span class="p">,</span><span class="s">&#39;tieV&#39;</span><span class="p">])</span>
<span class="go">Forming interpolator for nim^3.</span>
<span class="go">Interpolating values for nim^3.</span>
<span class="go">Forming interpolator for tieV.</span>
<span class="go">Interpolating values for tieV.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">mydata</span><span class="o">.</span><span class="n">plot1d</span><span class="p">(</span><span class="s">&#39;nim^3&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">myinterp</span><span class="o">.</span><span class="n">plot1d</span><span class="p">(</span><span class="s">&#39;nim^3&#39;</span><span class="p">,</span><span class="n">marker</span><span class="o">=</span><span class="s">&#39;s&#39;</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">figure</span><span class="o">=</span><span class="n">f</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s">&#39;examples/figures/example_profiles2.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/example_profiles2.png"><img alt="_images/example_profiles2.png" src="_images/example_profiles2.png" style="width: 400px;" /></a>
<p>Note that the interpolator initialized the interpolation function on the first call, this is saved internally for subsequent calls.</p>
<p>One common need is to look at spectra. For this we want to utilize
the full functionality of the data instances&#8217; plot1d function.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">xc</span><span class="p">,</span> <span class="o">=</span> <span class="n">read</span><span class="p">(</span><span class="s">&#39;examples/DIIID_ideal_example/ipec_xclebsch_n1.out&#39;</span><span class="p">)</span>
<span class="go">Casting table 1 into Data object.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">xc</span><span class="o">.</span><span class="n">plot1d</span><span class="p">(</span><span class="s">&#39;xi^psi&#39;</span><span class="p">,</span><span class="s">&#39;psi&#39;</span><span class="p">,</span><span class="n">x2rng</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s">&#39;examples/figures/example_spectrum.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/example_spectrum.png"><img alt="_images/example_spectrum.png" src="_images/example_spectrum.png" style="width: 600px;" /></a>
<p>We knew it was one table, so we used the &#8221;,&#8221; to automatically
unpack returned list. We were then so familiar with the args and
kwargs of the plotting function that we did not bother typing the names.
If you do this, be sure you get the order consistent with the order
given in the documentation &#8220;Definition&#8221; line (watch out for inconsistent
&#8220;Docstring&#8221; listings).</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>These examples can be tested by developers using ipython 
in this directory as follows:</p>
<blockquote class="last">
<div><p>In [1]: import data,doctest</p>
<p>In [2]: doctest.testmod(data,verbose=True)</p>
</div></blockquote>
</div>
<dl class="class">
<dt id="pypec.data.DataBase">
<em class="property">class </em><tt class="descclassname">pypec.data.</tt><tt class="descname">DataBase</tt><big>(</big><em>fromtxt</em>, <em>preamble</em>, <em>forcex=[]</em>, <em>forcedim=[]</em>, <em>maxlength=1000000.0</em>, <em>auto_complex=True</em>, <em>quiet=False</em><big>)</big><a class="reference internal" href="_modules/pypec/data.html#DataBase"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypec.data.DataBase" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="http://docs.python.org/library/functions.html#object" title="(in Python v2.7)"><tt class="xref py py-class docutils literal"><span class="pre">object</span></tt></a></p>
<p>An emtpy class object with the following operations overloaded:</p>
<div class="highlight-python"><div class="highlight"><pre>+,-,*,/,**
</pre></div>
</div>
<p>such that the operation is only performed on the attributes 
starting with .real_ and .imag_ and ending with r,z, or phi. 
If the two factors in the operation have different r or z attributes
data is interpolated to the wider spaced axis.</p>
<dl class="method">
<dt id="pypec.data.DataBase.interp">
<tt class="descname">interp</tt><big>(</big><em>x</em>, <em>ynames=None</em>, <em>quiet=False</em>, <em>**kwargs</em><big>)</big><a class="reference internal" href="_modules/pypec/data.html#DataBase.interp"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypec.data.DataBase.interp" title="Permalink to this definition">¶</a></dt>
<dd><p>Interpolate data to point(s).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> &#8211; ndarray shape (npts,ndim). Point(s) on dependent axis(axes).</li>
<li><strong>ynames</strong> &#8211; list. Any number of keys from y attribute</li>
<li><strong>quiet</strong> &#8211; bool. Suppress status messages</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">dict. Each name contains array of interpolated data.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pypec.data.DataBase.plot1d">
<tt class="descname">plot1d</tt><big>(</big><em>ynames=None</em>, <em>xname=None</em>, <em>x1rng=None</em>, <em>x2rng=None</em>, <em>x3rng=None</em>, <em>squeeze=False</em>, <em>**kwargs</em><big>)</big><a class="reference internal" href="_modules/pypec/data.html#DataBase.plot1d"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypec.data.DataBase.plot1d" title="Permalink to this definition">¶</a></dt>
<dd><p>Line plots of from 1D or 2D data.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>ynames</strong> &#8211; list. Strings specifying dependent data displayed.</li>
<li><strong>xname</strong> &#8211; string. The independent axis if 2D data.</li>
<li><strong>x1rng</strong> &#8211; optional. Valid formats are,
x               Plot single nearest point x-axis.
(xmin,xmax)     Plots all data in range (min,max).
(xmin,xmax,n)   Plots n evenly spaced points in range.</li>
<li><strong>x2rng</strong> &#8211; Same as x1rng. Applicable to 2D or 3D data.</li>
<li><strong>x3rng</strong> &#8211; Same as x2rng for 3D data only. Order of x is xnames with xname placed in front if given.</li>
<li><strong>squeeze</strong> &#8211; bool. Plots all ynames in same axis.</li>
<li><strong>kwargs</strong> &#8211; dict. Valid matplotlib pyplot.plot keyword arguments.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">figure.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pypec.data.DataBase.plot2d">
<tt class="descname">plot2d</tt><big>(</big><em>ynames=None</em>, <em>aspect='auto'</em>, <em>plot_type='imshow'</em>, <em>cbar=True</em>, <em>center=None</em>, <em>grid_size=(256</em>, <em>256)</em>, <em>swap=False</em>, <em>**kwargs</em><big>)</big><a class="reference internal" href="_modules/pypec/data.html#DataBase.plot2d"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypec.data.DataBase.plot2d" title="Permalink to this definition">¶</a></dt>
<dd><p>Matplotlib 2D plots of the data.</p>
<p>:param ynames : list. Strings specifying dependent data displayed.
:param aspect : str/float. Choose from &#8216;auto&#8217; or &#8216;equal&#8217; (see matplotlib axes.set_aspect). A float stretches a circle to hight=aspect*width.
:param plot_type: str. Choose one of,</p>
<blockquote>
<div>&#8220;imshow&#8221; Use matplotlib imshow to plot on grid.
&#8220;pcolormesh&#8221; Use matplotlib pcolormesh to plot on grid.
&#8220;contour&#8221;    Use matplotlib contour to plot on grid.
&#8220;contourf&#8221;   Use matplotlib contourf to plot on grid.
&#8220;tripcolor&#8221;  Use matplotlib tripcolor to plot raw points.
&#8220;tripcontour&#8221;  Use matplotlib tripcontour to plot raw points.
&#8220;tripcontourf&#8221; Use matplotlib tripcontourf to plot raw points.</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>cbar</strong> &#8211; bool. Show colorbar.</li>
<li><strong>grid_size</strong> &#8211; tuple. Size of grid used if no regular axes x (in order of xnames).</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>:param swap   : bool. Swap x/y axes.
:param kwargs : dict. Valid pcolormesh/contour/contourf key arguments.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">figure.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pypec.data.DataBase.plot3d">
<tt class="descname">plot3d</tt><big>(</big><em>ynames=None</em>, <em>filter={'psi': 1}</em>, <em>cbar=False</em>, <em>size=(600</em>, <em>600)</em>, <em>plot_type=''</em>, <em>phi=None</em>, <em>center=None</em>, <em>**kwargs</em><big>)</big><a class="reference internal" href="_modules/pypec/data.html#DataBase.plot3d"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypec.data.DataBase.plot3d" title="Permalink to this definition">¶</a></dt>
<dd><p>Three dimensional plots. Data with xnames r,z will be plotted
with third dimension phi where Y = Re[y]cos(n*phi)+Im[y]sin(n*phi).</p>
<blockquote>
<div>1D data &gt; lines in a plane in 3-space.
2D data &gt; z axis becomes y value
3D data &gt; chosen display type</div></blockquote>
<p>Must have mayavi.mlab module available in pythonpath.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>ynames</strong> &#8211; list. Strings specifying dependent data displayed.</li>
<li><strong>filter</strong> &#8211; dict. Filter points as only those closest to this y value.</li>
<li><strong>cbar</strong> &#8211; bool. Display a vertical colorbar in the Mayavi Scene.</li>
<li><strong>size</strong> &#8211; tuple. Size of figure in pixels.</li>
<li><strong>plot_type</strong> &#8211; str. Valid mayavi.mlab function name. Overrides default function choices (plot3d,mesh,quiver3d).</li>
<li><strong>phi</strong> &#8211; ndarray. Toroidal angle grid for complex 2D data. Default is 360 degrees, 180 pts.</li>
<li><strong>center</strong> &#8211; float. Center colormap on this value.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">figure.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<p>xb, = data.read(&#8216;examples/DIIID_ideal_example/ipec_xbnormal_fun_n1.out&#8217;,forcex=[&#8216;r&#8217;,&#8217;z&#8217;])
xb.plot3d(&#8216;bno&#8217;)</p>
<p>xn, = data.read(&#8216;ipec_xbnormal_fun_n2.out&#8217;)
psi = 1.0
n = 2
fltr= xb.y[&#8216;psi&#8217;]==xb.y[&#8216;psi&#8217;][np.abs(xb.y[&#8216;psi&#8217;]-psi).argmin()]
r,z,p = xb.pts[:,0][fltr],xb.pts[:,1][fltr],np.linspace(0,2*np.pi,60)
s = xb.y[&#8216;bno&#8217;][fltr]
cx = r.reshape(-1,1)*np.exp(1j*p.reshape(1,-1))
X,Y = cx.real,cx.imag
Z = z.reshape(-1,1)*np.ones_like(X)
S = (s.reshape(-1,1)*np.exp(-n*1j*p.reshape(1,-1))).real
mmlab.figure(fgcolor=(0, 0, 0), bgcolor=(1, 1, 1))
mmlab.mesh(X, Y, Z, scalars=S) #, colormap=&#8217;YlGnBu&#8217;</p>
</dd></dl>

<dl class="method">
<dt id="pypec.data.DataBase.scatter">
<tt class="descname">scatter</tt><big>(</big><em>ynames=None</em>, <em>xname=None</em>, <em>x1=None</em>, <em>x2=None</em>, <em>x3=None</em>, <em>**kwargs</em><big>)</big><a class="reference internal" href="_modules/pypec/data.html#DataBase.scatter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypec.data.DataBase.scatter" title="Permalink to this definition">¶</a></dt>
<dd><p>Scatter plot display for non-regular data. Display mimics plot1d in t
hat it displays a single independent axis. If is another independent 
axis exists, and is not sliced using one of the optional keyword arguments, 
it s represented as the color of the plotted symbols. If the data is 3D 
and unsliced, preference if given in order of xnames.</p>
<p>:param ynames : list. Dependent data to be displayed. Default is all y data.
:param xname  : str. Independent axis used in scatter plots. Default is first in xnames.
:param x1     : float. Use only data with first axis clossest to value.
:param x2     : float. Use only data with second axis clossest to value.
:param x3     : float. Use only data with thrid axis clossest to value.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">figure.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pypec.data.DataBase.slice">
<tt class="descname">slice</tt><big>(</big><em>x</em>, <em>xname=None</em>, <em>ynames=[]</em><big>)</big><a class="reference internal" href="_modules/pypec/data.html#DataBase.slice"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypec.data.DataBase.slice" title="Permalink to this definition">¶</a></dt>
<dd><p>UNDER CONSTRUCTION</p>
<p>Return 1D data object from 2D. Method grids new data, 
so beware of loosing accuracy near rational surfaces.</p>
<dl class="docutils">
<dt>Arguments:    </dt>
<dd><dl class="first last docutils">
<dt>x <span class="classifier-delimiter">:</span> <span class="classifier">float. </span></dt>
<dd>Lower bound of the axis.</dd>
</dl>
</dd>
<dt>Key Word Arguments:</dt>
<dd><dl class="first last docutils">
<dt>xname <span class="classifier-delimiter">:</span> <span class="classifier">str. </span></dt>
<dd>Axis allong which slice is performed.</dd>
</dl>
</dd>
<dt>Returns: </dt>
<dd><dl class="first last docutils">
<dt>obj. </dt>
<dd>New data nd-1 dimensional data object.</dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="pypec.data.getshot">
<tt class="descclassname">pypec.data.</tt><tt class="descname">getshot</tt><big>(</big><em>path='.'</em>, <em>full_name=False</em><big>)</big><a class="reference internal" href="_modules/pypec/data.html#getshot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypec.data.getshot" title="Permalink to this definition">¶</a></dt>
<dd><p>Find 6 digit shot number in path to directory or file.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>d</strong> &#8211; str. Path.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">str. Shot number if found, &#8216;&#8217; if not.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pypec.data.interp1d_unbound">
<tt class="descclassname">pypec.data.</tt><tt class="descname">interp1d_unbound</tt><big>(</big><em>x</em>, <em>y</em>, <em>kind='linear'</em>, <em>axis=-1</em>, <em>copy=True</em>, <em>bounds_error=False</em>, <em>fill_value=nan</em>, <em>assume_sorted=False</em><big>)</big><a class="reference internal" href="_modules/pypec/data.html#interp1d_unbound"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypec.data.interp1d_unbound" title="Permalink to this definition">¶</a></dt>
<dd><p>Interpolate a 1-D function.</p>
<p><cite>x</cite> and <cite>y</cite> are arrays of values used to approximate some function f:
<tt class="docutils literal"><span class="pre">y</span> <span class="pre">=</span> <span class="pre">f(x)</span></tt>.  This class returns a function whose call method uses
interpolation to find the value of new points.</p>
<dl class="docutils">
<dt>x <span class="classifier-delimiter">:</span> <span class="classifier">(N,) array_like</span></dt>
<dd>A 1-D array of real values.</dd>
<dt>y <span class="classifier-delimiter">:</span> <span class="classifier">(...,N,...) array_like</span></dt>
<dd>A N-D array of real values. The length of <cite>y</cite> along the interpolation
axis must be equal to the length of <cite>x</cite>.</dd>
<dt>kind <span class="classifier-delimiter">:</span> <span class="classifier">str or int, optional</span></dt>
<dd>Specifies the kind of interpolation as a string
(&#8216;linear&#8217;, &#8216;nearest&#8217;, &#8216;zero&#8217;, &#8216;slinear&#8217;, &#8216;quadratic, &#8216;cubic&#8217;
where &#8216;slinear&#8217;, &#8216;quadratic&#8217; and &#8216;cubic&#8217; refer to a spline
interpolation of first, second or third order) or as an integer
specifying the order of the spline interpolator to use.
Default is &#8216;linear&#8217;.</dd>
<dt>axis <span class="classifier-delimiter">:</span> <span class="classifier">int, optional</span></dt>
<dd>Specifies the axis of <cite>y</cite> along which to interpolate.
Interpolation defaults to the last axis of <cite>y</cite>.</dd>
<dt>copy <span class="classifier-delimiter">:</span> <span class="classifier">bool, optional</span></dt>
<dd>If True, the class makes internal copies of x and y.
If False, references to <cite>x</cite> and <cite>y</cite> are used. The default is to copy.</dd>
<dt>bounds_error <span class="classifier-delimiter">:</span> <span class="classifier">bool, optional</span></dt>
<dd>If True, a ValueError is raised any time interpolation is attempted on
a value outside of the range of x (where extrapolation is
necessary). If False, out of bounds values are assigned <cite>fill_value</cite>.
By default, an error is raised unless <cite>fill_value=&#8221;extrapolate&#8221;</cite>.</dd>
<dt>fill_value <span class="classifier-delimiter">:</span> <span class="classifier">array-like or (array-like, array_like) or &#8220;extrapolate&#8221;, optional</span></dt>
<dd><ul class="first last simple">
<li>if a ndarray (or float), this value will be used to fill in for
requested points outside of the data range. If not provided, then
the default is NaN. The array-like must broadcast properly to the
dimensions of the non-interpolation axes.</li>
<li>If a two-element tuple, then the first element is used as a
fill value for <tt class="docutils literal"><span class="pre">x_new</span> <span class="pre">&lt;</span> <span class="pre">x[0]</span></tt> and the second element is used for
<tt class="docutils literal"><span class="pre">x_new</span> <span class="pre">&gt;</span> <span class="pre">x[-1]</span></tt>. Anything that is not a 2-element tuple (e.g.,
list or ndarray, regardless of shape) is taken to be a single
array-like argument meant to be used for both bounds as
<tt class="docutils literal"><span class="pre">below,</span> <span class="pre">above</span> <span class="pre">=</span> <span class="pre">fill_value,</span> <span class="pre">fill_value</span></tt>.
.. versionadded:: 0.17.0</li>
<li>If &#8220;extrapolate&#8221;, then points outside the data range will be
extrapolated. (&#8220;nearest&#8221; and &#8220;linear&#8221; kinds only.)
.. versionadded:: 0.17.0</li>
</ul>
</dd>
<dt>assume_sorted <span class="classifier-delimiter">:</span> <span class="classifier">bool, optional</span></dt>
<dd>If False, values of <cite>x</cite> can be in any order and they are sorted first.
If True, <cite>x</cite> has to be an array of monotonically increasing values.</dd>
</dl>
<p>__call__</p>
<dl class="docutils">
<dt>splrep, splev</dt>
<dd>Spline interpolation/smoothing based on FITPACK.</dd>
</dl>
<p>UnivariateSpline : An object-oriented wrapper of the FITPACK routines.
interp2d : 2-D interpolation</p>
</dd></dl>

<dl class="function">
<dt id="pypec.data.open_dataset">
<tt class="descclassname">pypec.data.</tt><tt class="descname">open_dataset</tt><big>(</big><em>filename_or_obj</em>, <em>complex_dim='i'</em>, <em>**kwargs</em><big>)</big><a class="reference internal" href="_modules/pypec/data.html#open_dataset"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypec.data.open_dataset" title="Permalink to this definition">¶</a></dt>
<dd><p>Wrapper for xarray.open_dataset that allows automated reduction of
a dimension distinguishing real and imaginary components.</p>
<p>:param complex_dim : str. Dimension designating real/imaginary (0,1)</p>
<p>Load and decode a dataset from a file or file-like object.</p>
<dl class="docutils">
<dt>filename_or_obj <span class="classifier-delimiter">:</span> <span class="classifier">str, file or xarray.backends.*DataStore</span></dt>
<dd>Strings are interpreted as a path to a netCDF file or an OpenDAP URL
and opened with python-netCDF4, unless the filename ends with .gz, in
which case the file is gunzipped and opened with scipy.io.netcdf (only
netCDF3 supported). File-like objects are opened with scipy.io.netcdf
(only netCDF3 supported).</dd>
<dt>group <span class="classifier-delimiter">:</span> <span class="classifier">str, optional</span></dt>
<dd>Path to the netCDF4 group in the given file to open (only works for
netCDF4 files).</dd>
<dt>decode_cf <span class="classifier-delimiter">:</span> <span class="classifier">bool, optional</span></dt>
<dd>Whether to decode these variables, assuming they were saved according
to CF conventions.</dd>
<dt>mask_and_scale <span class="classifier-delimiter">:</span> <span class="classifier">bool, optional</span></dt>
<dd>If True, replace array values equal to <cite>_FillValue</cite> with NA and scale
values according to the formula <cite>original_values * scale_factor +
add_offset</cite>, where <cite>_FillValue</cite>, <cite>scale_factor</cite> and <cite>add_offset</cite> are
taken from variable attributes (if they exist).  If the <cite>_FillValue</cite> or
<cite>missing_value</cite> attribute contains multiple values a warning will be
issued and all array values matching one of the multiple values will
be replaced by NA.</dd>
<dt>decode_times <span class="classifier-delimiter">:</span> <span class="classifier">bool, optional</span></dt>
<dd>If True, decode times encoded in the standard NetCDF datetime format
into datetime objects. Otherwise, leave them encoded as numbers.</dd>
<dt>concat_characters <span class="classifier-delimiter">:</span> <span class="classifier">bool, optional</span></dt>
<dd>If True, concatenate along the last dimension of character arrays to
form string arrays. Dimensions will only be concatenated over (and
removed) if they have no corresponding variable and if they are only
used as the last dimension of character arrays.</dd>
<dt>decode_coords <span class="classifier-delimiter">:</span> <span class="classifier">bool, optional</span></dt>
<dd>If True, decode the &#8216;coordinates&#8217; attribute to identify coordinates in
the resulting dataset.</dd>
<dt>engine <span class="classifier-delimiter">:</span> <span class="classifier">{&#8216;netcdf4&#8217;, &#8216;scipy&#8217;, &#8216;pydap&#8217;, &#8216;h5netcdf&#8217;, &#8216;pynio&#8217;}, optional</span></dt>
<dd>Engine to use when reading files. If not provided, the default engine
is chosen based on available dependencies, with a preference for
&#8216;netcdf4&#8217;.</dd>
<dt>chunks <span class="classifier-delimiter">:</span> <span class="classifier">int or dict, optional</span></dt>
<dd>If chunks is provided, it used to load the new dataset into dask
arrays. This is an experimental feature; see the documentation for more
details.</dd>
<dt>lock <span class="classifier-delimiter">:</span> <span class="classifier">False, True or threading.Lock, optional</span></dt>
<dd>If chunks is provided, this argument is passed on to
<tt class="xref py py-func docutils literal"><span class="pre">dask.array.from_array()</span></tt>. By default, a per-variable lock is
used when reading data from netCDF files with the netcdf4 and h5netcdf
engines to avoid issues with concurrent access when using dask&#8217;s
multithreaded backend.</dd>
<dt>drop_variables: string or iterable, optional</dt>
<dd>A variable or list of variables to exclude from being parsed from the
dataset. This may be useful to drop variables with problems or
inconsistent values.</dd>
</dl>
<dl class="docutils">
<dt>dataset <span class="classifier-delimiter">:</span> <span class="classifier">Dataset</span></dt>
<dd>The newly created dataset.</dd>
</dl>
<p>open_mfdataset</p>
</dd></dl>

<dl class="function">
<dt id="pypec.data.plotall">
<tt class="descclassname">pypec.data.</tt><tt class="descname">plotall</tt><big>(</big><em>results</em>, <em>xfun</em>, <em>yfun</em>, <em>label=''</em>, <em>axes=None</em>, <em>**kwargs</em><big>)</big><a class="reference internal" href="_modules/pypec/data.html#plotall"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypec.data.plotall" title="Permalink to this definition">¶</a></dt>
<dd><p>Line plot of data gethered recursively from a dictionary 
containing multiple namelists or data objects.</p>
<p>:param results : dict. A readall result.
:param xfun    : func. A function that takes args (key,val) for each dictionary item and whose result is appended to the xaxis.
:param yfun    : func. A function that takes args (key,val) for each dictionary item and whose result is appended to the yaxis.
:param axes    : obj. matplotlib axes object.
:param kwargs  : dict. Passed to matplotlib plot function</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">figure.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pypec.data.read">
<tt class="descclassname">pypec.data.</tt><tt class="descname">read</tt><big>(</big><em>fname</em>, <em>squeeze=False</em>, <em>forcex=[]</em>, <em>forcedim=[]</em>, <em>maxnumber=999</em>, <em>maxlength=1000000.0</em>, <em>auto_complex=True</em>, <em>quiet=False</em><big>)</big><a class="reference internal" href="_modules/pypec/data.html#read"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypec.data.read" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the data from any ipec output as a list of python 
class-type objects using numpy.genfromtxt.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>fname</strong> &#8211; str. Path of ipec output file.</li>
<li><strong>squeeze</strong> &#8211; bool. Sets all attributes to single data object.</li>
<li><strong>forcex</strong> &#8211; list. Set independent data labels.</li>
<li><strong>forcedim</strong> &#8211; list. Set dimensionality of each x.</li>
<li><strong>maxnumber</strong> &#8211; int. Reads only first maxnumber of tables.</li>
<li><strong>maxlength</strong> &#8211; int. Tables with more rows than this are downsampled for speed.</li>
<li><strong>auto_complex</strong> &#8211; bool. Include amplitude and phase of complex data as variables.</li>
<li><strong>quiet</strong> &#8211; bool. Prevent non-warning messages printed to terminal.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">list. Class objects for each block of data in the file.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pypec.data.readall">
<tt class="descclassname">pypec.data.</tt><tt class="descname">readall</tt><big>(</big><em>base='.'</em>, <em>filetype='pent_n1.out'</em>, <em>**kwargs</em><big>)</big><a class="reference internal" href="_modules/pypec/data.html#readall"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypec.data.readall" title="Permalink to this definition">¶</a></dt>
<dd><p>Recursively searches base directory for files with name
filetype, reads them into python objects, and stores 
objects in a dictionary with directory names as keys.</p>
<p>:param base     : str. Top level directory in which to begin search.
:param filetype : str. Files to read.
:param kwargs :dict. Passed to appropriate reader function.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">dict. Key-Value pairs are directories and their contained data.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pypec.data.write">
<tt class="descclassname">pypec.data.</tt><tt class="descname">write</tt><big>(</big><em>dataobj</em>, <em>fname=''</em>, <em>ynames=[]</em>, <em>**kwargs</em><big>)</big><a class="reference internal" href="_modules/pypec/data.html#write"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypec.data.write" title="Permalink to this definition">¶</a></dt>
<dd><p>Write data object to file. The aim is to replicate the original file
structure... the header text will have been lost in the read however,
as will some column label symbols in the use of genfromtxt.</p>
<p>:param dataobj : obj. Data_Base type object.
:param fname   : str. File to write to.
:param kwargs  : dict. Passed to numpy.savetxt</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">bool. True.</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
</div>
<span class="target" id="module-pypec.post"></span><div class="section" id="pypec-post-post-processing-fundamental-gpec-outputs">
<h2><a class="reference internal" href="#module-pypec.post" title="pypec.post"><tt class="xref py py-mod docutils literal"><span class="pre">pypec.post</span></tt></a> &#8211; Post-Processing Fundamental GPEC Outputs<a class="headerlink" href="#pypec-post-post-processing-fundamental-gpec-outputs" title="Permalink to this headline">¶</a></h2>
<p>The post module is a repository of basic post-processing functions for expanding,
manipulating, and visualizing fundamental gpec output. This is not an exhaustive
list of post-processing procedures. The focus is on a) transforming between
coordinate systems and b) matrix optimizations.</p>
<p>Here, we show some examples using common outputs.</p>
<div class="section" id="examples">
<h3>Examples<a class="headerlink" href="#examples" title="Permalink to this headline">¶</a></h3>
<p>First, add your release of GPEC to your PYTHONPATH environment variable.</p>
<p>In an open ipython session, import the data module</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pypec</span> <span class="kn">import</span> <span class="n">data</span><span class="p">,</span> <span class="n">post</span>
</pre></div>
</div>
<p>To get a typical GPEC output into python, use the open_dataset function.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">con</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="s">&#39;examples/DIIID_ideal_example/ipec_control_output_n1.nc&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">prof</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="s">&#39;examples/DIIID_ideal_example/ipec_profile_output_n1.nc&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>First, 3D equilibrium calculations lend themselves naturally to 3D figures. This module
has a helpful function for forming the necessary x,y,z meshes from the 2D boundary.
After adding the requisite geometry to the control surface output,</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">con</span> <span class="o">=</span> <span class="n">add_3dsurfaces</span><span class="p">(</span><span class="n">con</span><span class="p">,</span> <span class="n">phi_lim</span><span class="o">=</span><span class="n">pi</span> <span class="o">*</span> <span class="mf">1.5</span><span class="p">)</span>
</pre></div>
</div>
<p>it is easy to make 3D surface plots using mayavi,</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span> <span class="o">=</span> <span class="n">con</span><span class="p">[</span><span class="s">&#39;x_surf&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span><span class="n">con</span><span class="p">[</span><span class="s">&#39;y_surf&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span><span class="n">con</span><span class="p">[</span><span class="s">&#39;z_surf&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b_n_3d</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">con</span><span class="p">[</span><span class="s">&#39;b_n_fun&#39;</span><span class="p">]</span><span class="o">*</span><span class="n">con</span><span class="p">[</span><span class="s">&#39;phase_surf&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span> <span class="o">=</span> <span class="n">mmlab</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">bgcolor</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">fgcolor</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span><span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">600</span><span class="p">,</span><span class="mi">600</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mesh</span> <span class="o">=</span> <span class="n">mmlab</span><span class="o">.</span><span class="n">mesh</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">,</span><span class="n">scalars</span><span class="o">=</span><span class="n">b_n_3d</span><span class="p">,</span><span class="n">colormap</span><span class="o">=</span><span class="s">&#39;RdBu&#39;</span><span class="p">,</span><span class="n">vmin</span><span class="o">=-</span><span class="mf">2e-3</span><span class="p">,</span><span class="n">vmax</span><span class="o">=</span><span class="mf">2e-3</span><span class="p">,</span><span class="n">figure</span><span class="o">=</span><span class="n">fig</span><span class="p">)</span>
</pre></div>
</div>
<p>Note that mayavi explicitly requires numpy.ndarray objects so we had to
use the values of each xarray DataArray.</p>
<p>Now, lets cap the ends with our full profile information. This is a little
more involved. For the toroidal angle of each end, we need to rotate the
2D arrays for the mesh and the field values.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">phi</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mi">3</span><span class="o">/</span><span class="mi">2</span><span class="p">]:</span>
<span class="gp">... </span>    <span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">prof</span><span class="p">[</span><span class="s">&#39;b_n_fun&#39;</span><span class="p">]</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">1j</span><span class="o">*</span><span class="n">phi</span><span class="p">))</span> <span class="c"># poloidal cross section at phi</span>
<span class="gp">... </span>    <span class="n">xy</span> <span class="o">=</span> <span class="n">prof</span><span class="p">[</span><span class="s">&#39;R&#39;</span><span class="p">]</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">1j</span><span class="o">*</span><span class="n">phi</span><span class="p">)</span> <span class="c"># rotate the plane</span>
<span class="gp">... </span>    <span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">xy</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">imag</span><span class="p">(</span><span class="n">xy</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">prof</span><span class="p">[</span><span class="s">&#39;z&#39;</span><span class="p">])</span>
<span class="gp">... </span>    <span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">,</span><span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">,</span><span class="n">b</span><span class="p">])[:,:,::</span><span class="mi">10</span><span class="p">]</span> <span class="c"># downsample psi by 10 to speed up mayavi</span>
<span class="gp">... </span>    <span class="n">cap</span> <span class="o">=</span> <span class="n">mmlab</span><span class="o">.</span><span class="n">mesh</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">,</span><span class="n">scalars</span><span class="o">=</span><span class="n">b</span><span class="p">,</span><span class="n">colormap</span><span class="o">=</span><span class="s">&#39;RdBu&#39;</span><span class="p">,</span><span class="n">vmin</span><span class="o">=-</span><span class="mf">2e-3</span><span class="p">,</span><span class="n">vmax</span><span class="o">=</span><span class="mf">2e-3</span><span class="p">,</span><span class="n">figure</span><span class="o">=</span><span class="n">fig</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mmlab</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="s">&#39;examples/figures/example_bn_3d_capped.png&#39;</span><span class="p">,</span><span class="n">figure</span><span class="o">=</span><span class="n">fig</span><span class="p">)</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/example_bn_3d_capped.png"><img alt="_images/example_bn_3d_capped.png" src="_images/example_bn_3d_capped.png" style="width: 600px;" /></a>
<p>That looks awesome!</p>
<p>There are, of course, plenty more outputs and important ways of visualizing
them intuitively. See, for example, the 2D plots in the add_3dsurface
function&#8217;s documentation. At this point we have outlined the basics. Using
this module and similar commands to those used here, the user should be able
to do all sorts of post-processing tasks.</p>
<dl class="function">
<dt id="pypec.post.add_3dsurface">
<tt class="descclassname">pypec.post.</tt><tt class="descname">add_3dsurface</tt><big>(</big><em>control_output</em>, <em>phi_lim=6.283185307179586</em>, <em>overwrite=False</em>, <em>inplace=False</em><big>)</big><a class="reference internal" href="_modules/pypec/post.html#add_3dsurface"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypec.post.add_3dsurface" title="Permalink to this definition">¶</a></dt>
<dd><p>Add 3D geometric dimensions to dataset from ipec_control_output_n#.nc.</p>
<p>Note, this surface uses the machine toroidal angle. It should only by used
with functions that do the same (tmag_out=0).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>control_output</strong> &#8211; Dataset. xarray Dataset opened from ipec_control_output_n#.nc</li>
<li><strong>phi_lim</strong> &#8211; float. Toroidal angle extended from 0 to phi_lim radians.</li>
<li><strong>overwrite</strong> &#8211; bool. Overwrite geometric quantities if they already exist.</li>
<li><strong>inplace</strong> &#8211; bool. Modify dataset inplace. Otherwise, return a new dataset.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Dataset. New dataset with additional dimensions.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Examples:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<p>After opening, adding geometry and confirming the functional forms
are using the machine angle,</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">ds</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="s">&#39;examples/DIIID_ideal_example/ipec_control_output_n1.nc&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ds</span> <span class="o">=</span> <span class="n">add_3dsurface</span><span class="p">(</span><span class="n">ds</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ds</span> <span class="o">=</span> <span class="n">add_fun</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span><span class="n">tmag</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
</pre></div>
</div>
<p>it is easy to make 3D surface plots using mayavi,</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span> <span class="o">=</span> <span class="n">mmlab</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">bgcolor</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">fgcolor</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">600</span><span class="p">,</span> <span class="mi">600</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mesh</span> <span class="o">=</span> <span class="n">mmlab</span><span class="o">.</span><span class="n">mesh</span><span class="p">(</span><span class="n">ds</span><span class="p">[</span><span class="s">&#39;x_surf&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span><span class="n">ds</span><span class="p">[</span><span class="s">&#39;y_surf&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span><span class="n">ds</span><span class="p">[</span><span class="s">&#39;z_surf&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
<span class="gp">... </span>                  <span class="n">scalars</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">ds</span><span class="p">[</span><span class="s">&#39;b_n_fun&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">ds</span><span class="p">[</span><span class="s">&#39;phase_surf&#39;</span><span class="p">]),</span> <span class="n">colormap</span><span class="o">=</span><span class="s">&#39;RdBu&#39;</span><span class="p">,</span> <span class="n">figure</span><span class="o">=</span><span class="n">fig</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mmlab</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="s">&#39;examples/figures/example_bn_3d.png&#39;</span><span class="p">,</span> <span class="n">figure</span><span class="o">=</span><span class="n">fig</span><span class="p">)</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/example_bn_3d.png"><img alt="_images/example_bn_3d.png" src="_images/example_bn_3d.png" style="width: 600px;" /></a>
<p>Make 2D perturbed last-closed-flux-surface plots quickly using,</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">fac</span> <span class="o">=</span> <span class="mf">1e-1</span> <span class="c"># good for DIII-D unit eigenmodes</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s">&#39;equal&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l</span><span class="p">,</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ds</span><span class="p">[</span><span class="s">&#39;R&#39;</span><span class="p">],</span> <span class="n">ds</span><span class="p">[</span><span class="s">&#39;z&#39;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s">&#39;k&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span> <span class="c"># most and least stable modes</span>
<span class="gp">... </span>    <span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">ds</span><span class="p">[</span><span class="s">&#39;R_EDX_FUN&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">fac</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">l</span><span class="p">,</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ds</span><span class="p">[</span><span class="s">&#39;R&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">v</span> <span class="o">*</span> <span class="n">ds</span><span class="p">[</span><span class="s">&#39;R_n&#39;</span><span class="p">],</span> <span class="n">ds</span><span class="p">[</span><span class="s">&#39;z&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">v</span> <span class="o">*</span> <span class="n">ds</span><span class="p">[</span><span class="s">&#39;z_n&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sm</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">set_linearray</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">lines</span><span class="p">[</span><span class="o">-</span><span class="mi">4</span><span class="p">:],</span> <span class="n">cmap</span><span class="o">=</span><span class="s">&#39;viridis&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cb</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">sm</span><span class="p">,</span> <span class="n">ticks</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cb</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s">&#39;Mode Index&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xtl</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mf">1.7</span><span class="p">,</span> <span class="mf">2.4</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">txt</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s">&#39;R (m)&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">txt</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s">&#39;z (m)&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s">&#39;examples/figures/example_boundary_wiggle.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/example_boundary_wiggle.png"><img alt="_images/example_boundary_wiggle.png" src="_images/example_boundary_wiggle.png" style="width: 600px;" /></a>
<p>Combining these two concepts, we can even plot a 3D perturbed surface distorted
by the normal displacements and colored to show the normal field.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span> <span class="o">=</span> <span class="n">mmlab</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">bgcolor</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">fgcolor</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">600</span><span class="p">,</span> <span class="mi">600</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xinorm</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">*</span> <span class="n">ds</span><span class="p">[</span><span class="s">&#39;phase_surf&#39;</span><span class="p">]</span> <span class="c"># good for ~cm displacements</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">ds</span><span class="p">[</span><span class="s">&#39;x_surf&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span> <span class="o">+</span> <span class="n">ds</span><span class="p">[</span><span class="s">&#39;xi_n_fun&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">xinorm</span> <span class="o">*</span> <span class="n">ds</span><span class="p">[</span><span class="s">&#39;x_surf_n&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">ds</span><span class="p">[</span><span class="s">&#39;y_surf&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span> <span class="o">+</span> <span class="n">ds</span><span class="p">[</span><span class="s">&#39;xi_n_fun&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">xinorm</span> <span class="o">*</span> <span class="n">ds</span><span class="p">[</span><span class="s">&#39;y_surf_n&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">ds</span><span class="p">[</span><span class="s">&#39;z_surf&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span> <span class="o">+</span> <span class="n">ds</span><span class="p">[</span><span class="s">&#39;xi_n_fun&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">xinorm</span> <span class="o">*</span> <span class="n">ds</span><span class="p">[</span><span class="s">&#39;z_surf_n&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">ds</span><span class="p">[</span><span class="s">&#39;b_n_fun&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">ds</span><span class="p">[</span><span class="s">&#39;phase_surf&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mesh</span> <span class="o">=</span> <span class="n">mmlab</span><span class="o">.</span><span class="n">mesh</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">,</span><span class="n">scalars</span><span class="o">=</span><span class="n">s</span><span class="p">,</span> <span class="n">colormap</span><span class="o">=</span><span class="s">&#39;RdBu&#39;</span><span class="p">,</span> <span class="n">figure</span><span class="o">=</span><span class="n">fig</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mmlab</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="s">&#39;examples/figures/example_bn_xin_3d.png&#39;</span><span class="p">,</span> <span class="n">figure</span><span class="o">=</span><span class="n">fig</span><span class="p">)</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/example_bn_xin_3d.png"><img alt="_images/example_bn_xin_3d.png" src="_images/example_bn_xin_3d.png" style="width: 600px;" /></a>
<p>Fancy!</p>
</dd></dl>

<dl class="function">
<dt id="pypec.post.add_control_geometry">
<tt class="descclassname">pypec.post.</tt><tt class="descname">add_control_geometry</tt><big>(</big><em>ds</em>, <em>phi_lim=6.283185307179586</em>, <em>overwrite=False</em><big>)</big><a class="reference internal" href="_modules/pypec/post.html#add_control_geometry"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypec.post.add_control_geometry" title="Permalink to this definition">¶</a></dt>
<dd><p>WARNING: This will soon be deprecated. Migrate to using add_3dsurface.</p>
<p>See add_3dsurface for documentation.</p>
</dd></dl>

<dl class="function">
<dt id="pypec.post.add_fun">
<tt class="descclassname">pypec.post.</tt><tt class="descname">add_fun</tt><big>(</big><em>ds</em>, <em>keys=None</em>, <em>tmag=False</em>, <em>inplace=True</em><big>)</big><a class="reference internal" href="_modules/pypec/post.html#add_fun"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypec.post.add_fun" title="Permalink to this definition">¶</a></dt>
<dd><p>Add real space functions of theta calculated from the spectral outputs.
This is helpful when analyzing a GPEC run for which fun_flag was off
for speed/efficiency.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>ds</strong> &#8211; Dataset. xarray Dataset opened from ipec_control_output_n#.nc</li>
<li><strong>keys</strong> &#8211; iterable. List of keys for which &lt;key&gt;_fun will be added. Default is all spectral variables.</li>
<li><strong>tmag</strong> &#8211; bool. Keep the magnetic coordinate angle (default is machine angle).</li>
<li><strong>inplace</strong> &#8211; bool. Add to dataset. Otherwise, make a new dataset object.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">Dataset. New dataset with real space functions of theta.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pypec.post.optimize_torque">
<tt class="descclassname">pypec.post.</tt><tt class="descname">optimize_torque</tt><big>(</big><em>matrixprofile</em>, <em>psilow=0</em>, <em>psihigh=1</em>, <em>normalize=False</em>, <em>energy=False</em>, <em>minimize=False</em><big>)</big><a class="reference internal" href="_modules/pypec/post.html#optimize_torque"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypec.post.optimize_torque" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the eigenvalue and eigenvector corresponding to maximum the torque
within the specified range of normalized poloidal flux.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>matrixprofile</strong> &#8211; DataArray. T_x or T_coil from ipec_profile_output_n#.nc.</li>
<li><strong>psilow</strong> &#8211; float. Lower limit of normalized poloidal flux.</li>
<li><strong>psihigh</strong> &#8211; float. Upper limit of normalized poloidal flux.</li>
<li><strong>normalize</strong> &#8211; bool. Optimize value within psi range normalized to the total.</li>
<li><strong>energy</strong> &#8211; bool. Optimize 2ndW (default is torque).</li>
<li><strong>minimize</strong> &#8211; bool. FInd the minimum (default is maximum).</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">w,v. Eigenvalue, eigenvector of optimum.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Examples:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<p>With the output of a kinetic GPEC run in hand,</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">con</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="s">&#39;examples/DIIID_kinetic_example/ipec_control_output_n1.nc&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">prof</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="s">&#39;examples/DIIID_kinetic_example/ipec_profile_output_n1.nc&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>This function provides the spectrum that optimizes the integral torque
and the corresponding profile is easily obtained.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">w</span><span class="p">,</span><span class="n">v</span> <span class="o">=</span> <span class="n">optimize_torque</span><span class="p">(</span><span class="n">prof</span><span class="p">[</span><span class="s">&#39;T_xe&#39;</span><span class="p">])</span> <span class="c"># handles any order of dims</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">T_mat</span> <span class="o">=</span> <span class="n">prof</span><span class="p">[</span><span class="s">&#39;T_xe&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="s">&#39;psi_n&#39;</span><span class="p">,</span> <span class="s">&#39;m_prime&#39;</span><span class="p">,</span> <span class="s">&#39;m&#39;</span><span class="p">)</span> <span class="c"># order matters in  dot products</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">T_opt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">conj</span><span class="p">(),</span> <span class="n">T_mat</span><span class="p">),</span> <span class="n">v</span><span class="p">))</span><span class="o">/</span><span class="mi">2</span> <span class="c"># 0.5 for quadratic fourier analysis</span>
</pre></div>
</div>
<p>We can then compare the spectrum and torque from our GPEC perturbed equilibrium to
the theoretical optima,</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">input_power</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">con</span><span class="p">[</span><span class="s">&#39;Phi_xe&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">conj</span><span class="p">(),</span> <span class="n">con</span><span class="p">[</span><span class="s">&#39;Phi_xe&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">con</span><span class="p">[</span><span class="s">&#39;Phi_xe&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s">&#39;Input&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">con</span><span class="p">[</span><span class="s">&#39;m&#39;</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">vo</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">input_power</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s">&#39;Optimum Torque&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">prof</span><span class="p">[</span><span class="s">&#39;T&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">real</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s">&#39;Input&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">prof</span><span class="p">[</span><span class="s">&#39;psi_n&#39;</span><span class="p">],</span> <span class="n">T_opt</span><span class="o">*</span><span class="n">input_power</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&#39;Optimized Torque&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s">&#39;examples/figures/example_optimize_torque.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/example_optimize_torque.png"><img alt="_images/example_optimize_torque.png" src="_images/example_optimize_torque.png" style="width: 600px;" /></a>
</dd></dl>

</div>
</div>
<span class="target" id="module-pypec.gpec"></span><div class="section" id="pypec-gpec-python-wrappers-for-fortran-codes">
<h2><a class="reference internal" href="#module-pypec.gpec" title="pypec.gpec"><tt class="xref py py-mod docutils literal"><span class="pre">pypec.gpec</span></tt></a> &#8211; Python Wrappers for FORTRAN Codes<a class="headerlink" href="#pypec-gpec-python-wrappers-for-fortran-codes" title="Permalink to this headline">¶</a></h2>
<p>This is a collection of wrapper functions for running DCON, IPEC, and PENT.</p>
<p>If run from the command line, this module will call an associated GUI.</p>
<p>This module is for more advanced operators who want to control/run 
the fortran package for DCON, IPEC, and PENT. To get started, lets
explore the package</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">gpec</span><span class="o">.</span>
<span class="go">gpec.InputSet       gpec.join           gpec.optimize       gpec.run</span>
<span class="go">gpec.bashjob        gpec.namelist       gpec.optntv         gpec.subprocess</span>
<span class="go">gpec.data           gpec.np             gpec.os             gpec.sys</span>
<span class="go">gpec.default        gpec.ntv_dominantm  gpec.packagedir     gpec.time</span>
</pre></div>
</div>
<p>many of these are simply standard python modules imported by gpec
lets submit a full run in just 4 lines:
steal the settings from a previous run (leaving run director as deafult)</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">new_inputs</span> <span class="o">=</span> <span class="n">gpec</span><span class="o">.</span><span class="n">InputSet</span><span class="p">(</span><span class="n">indir</span><span class="o">=</span><span class="s">&#39;/p/gpec/users/nlogan/data/d3d/ipecout/145117/ico3_n3/&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>change what we want to</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">new_inputs</span><span class="p">[</span><span class="s">&#39;dcon&#39;</span><span class="p">][</span><span class="s">&#39;DCON_CONTROL&#39;</span><span class="p">][</span><span class="s">&#39;nn&#39;</span><span class="p">]</span><span class="o">=</span><span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">new_dir</span> <span class="o">=</span> <span class="n">new_inputs</span><span class="o">.</span><span class="n">indir</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span><span class="o">+</span><span class="s">&#39;2&#39;</span>
</pre></div>
</div>
<p>DOUBLE CHECK THAT ALL IPUTS ARE WHAT YOU EXPECT (not shown here)
and submit the job to the cluster.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">gpec</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="n">new_dir</span><span class="p">,</span><span class="o">**</span><span class="n">new_inputs</span><span class="o">.</span><span class="n">infiles</span><span class="p">)</span>
</pre></div>
</div>
<p>Running the package using this module will</p>
<ol class="arabic simple">
<li>Create the new location (if not already existing), and cd to it</li>
<li>rm all .out, .dat, and .bin files already in the directory (not dcon ones if rundcon=False, not pent ones for runpent=False, etc).</li>
<li>cp all .dat and .in files from the run directoy to the new location</li>
<li>Write all namelists supplied in kwargs to file (overwriting)</li>
<li>Write a unique bash script for the run, and submit it OR run each fortran routine from the commandline.</li>
<li>Remove all .dat and xdraw files from the directory</li>
</ol>
<p>You will not that there is significant oportunity for overwriting files,
and the user must be responsible for double checking that all inputs 
are correct and will not result in life crushing disaster for themselves
or a friend when that super special file gets over-written.</p>
<dl class="class">
<dt id="pypec.gpec.InputSet">
<em class="property">class </em><tt class="descclassname">pypec.gpec.</tt><tt class="descname">InputSet</tt><big>(</big><em>rundir='/p/gpec/users/nlogan/gpec/bin'</em>, <em>indir='/p/gpec/users/nlogan/gpec/input'</em><big>)</big><a class="reference internal" href="_modules/pypec/gpec.html#InputSet"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypec.gpec.InputSet" title="Permalink to this definition">¶</a></dt>
<dd><p>Class designed to hold the standard inputs for a run.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Attributes:</th><td class="field-body">rundir: str. Location of executables, .dat files, and extra .in files.
indir: str. Location of .in files read in and stored here
infiles: dict. Tree like storage of namelist objects.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pypec.gpec.nustarscan">
<tt class="descclassname">pypec.gpec.</tt><tt class="descname">nustarscan</tt><big>(</big><em>base='.'</em>, <em>scale=(0.1</em>, <em>1.0</em>, <em>10.0)</em>, <em>pentfile='pent.in'</em>, <em>scalen=True</em>, <em>scalet=True</em>, <em>**kwargs</em><big>)</big><a class="reference internal" href="_modules/pypec/gpec.html#nustarscan"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypec.gpec.nustarscan" title="Permalink to this definition">¶</a></dt>
<dd><p>Run pent for series of <em>approximately</em> scaled collisionality values.
Default scaling holds P=NT constant (NTV~P), but this is broken using
scalen or scalet (scalet=False, for example, scales only density).</p>
<p>User may want to include a non-zero ximag if going to low collisionality.</p>
<p>User must specify full path to all files named in the pent input.</p>
<p>Kinetic file must have header with &#8216;n&#8217; and &#8216;i&#8217; in the ion density label
but no other label, both &#8216;t&#8217; and &#8216;e&#8217; in only the electron temperature label,
&#8216;omega&#8217; omega_EXB label, etc.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Approximate scaling ignores log-Lambda dependence, and uses
nu_star ~ nu/v_th ~ (NT^-3/2)/(T^1/2) ~ N/T^2.</p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>base</strong> &#8211; str. Top level directory containing dcon and ipec runs. Must contain euler.bin and vacuum.bin file.</li>
<li><strong>scale</strong> &#8211; ndarray. The scale factors iterated over.</li>
<li><strong>pentfile</strong> &#8211; str. Original input file.</li>
<li><strong>scalen</strong> &#8211; bool.Use density scaling to change nu_star.</li>
<li><strong>scalet</strong> &#8211; bool.Use temperature scaling to change nu_star.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">bool. True.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pypec.gpec.omegascan">
<tt class="descclassname">pypec.gpec.</tt><tt class="descname">omegascan</tt><big>(</big><em>omega='wp'</em>, <em>base='.'</em>, <em>scale=(-2</em>, <em>-1</em>, <em>-0.5</em>, <em>0.5</em>, <em>1</em>, <em>2)</em>, <em>pentrcfile='pentrc.in'</em>, <em>**kwargs</em><big>)</big><a class="reference internal" href="_modules/pypec/gpec.html#omegascan"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypec.gpec.omegascan" title="Permalink to this definition">¶</a></dt>
<dd><p>Run pent for series of scaled nu/omega_phi/omega_E/omega_D/gamma_damp values. 
User must specify full path to all files named in pent.in input file
located in the base directory.
Note that the rotation profile is scaled by manipulating omega_E
on each surface to obtain the scaled rotation.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>omega</strong> &#8211; str. Choose from nu, wp, we, wd, or ga</li>
<li><strong>base</strong> &#8211; str. Top level directory containing dcon and ipec runs. Must contain euler.bin and vacuum.bin file.</li>
<li><strong>scale</strong> &#8211; ndarray. The scale factors iterated over.</li>
<li><strong>pentfile</strong> &#8211; str. Original input file.</li>
<li><strong>rundcon</strong> &#8211; bool. Set true if using hybrid kinetic MHD DCON. Will also attempt IPEC + PENT.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">bool. True.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pypec.gpec.optntv">
<tt class="descclassname">pypec.gpec.</tt><tt class="descname">optntv</tt><big>(</big><em>mlist</em>, <em>maxiter=50</em>, <em>loc='.'</em>, <em>rundir='/p/gpec/users/nlogan/gpec/bin/'</em>, <em>**kwargs</em><big>)</big><a class="reference internal" href="_modules/pypec/gpec.html#optntv"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypec.gpec.optntv" title="Permalink to this definition">¶</a></dt>
<dd><p>Python wrapper for running ipec package multiple times in
a search for the normalized spectrum that maximizes NTV.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>mlist</strong> &#8211; list. Integer poloidal modes included on plasma surface.</li>
<li><strong>maxiter</strong> &#8211; int.Maximum number of iterations.</li>
<li><strong>loc</strong> &#8211; str. Directory location for run.</li>
<li><strong>rundir</strong> &#8211; str. IPEC package directory with executables and .dat files.</li>
<li><strong>kwargs</strong> &#8211; <p>dict. namelist instance(s) written to &lt;kwarg&gt;.in file(s).</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Namelists taken from (in order of priority):
1) Key word arguments 
2) .in files from loc
3) .in files from rundir</p>
</div>
</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">bool. True.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pypec.gpec.optpentrc">
<tt class="descclassname">pypec.gpec.</tt><tt class="descname">optpentrc</tt><big>(</big><em>ms=[-5, -4, -3, -2, -1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24], ttype='tgar', tfac=-1, perp1=False, norm=0.001, qsub=True, method='Powell', maxiter=1000, loc='.', rundir='/p/gpec/users/nlogan/gpec/bin/', **kwargs</em><big>)</big><a class="reference internal" href="_modules/pypec/gpec.html#optpentrc"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypec.gpec.optpentrc" title="Permalink to this definition">¶</a></dt>
<dd><p>Python wrapper for running gpec packages multiple times in
a search for the normalized spectrum that maximizes NTV.</p>
<p>Approach is as follows:
1) Run DCON and IPEC in base directory with singcoup_flag True
2) Run IPEC twice for each m, creating new subdirectories cosmn* and sinmn*
3) Optimize a functional wrapper for PENTRC using optimize.fmin_slsqp
- Spectra constrained to have 1 Gm^2 norm
- wrapper uses data package to linearly combine ipec_xclebsch outputs
- Initial guess is the first singcoup_svd mode from IPEC</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>ms</strong> &#8211; list. Integer poloidal modes included on plasma surface.</li>
<li><strong>ttype</strong> &#8211; str.PENTRC_OUTPUT flag (fgar,tgar,rlar,etc).</li>
<li><strong>tfac</strong> &#8211; int.Optimization minimizes tfac*|T_phi|. Negative values maximize applied NTV.</li>
<li><strong>perp1</strong> &#8211; bool.Optimizes in space perpendicular to 1st IPEC SVD mode.</li>
<li><strong>norm</strong> &#8211; float.Amplitude of applied area normalized spectrum Phi_x (Tesla meter^2).</li>
<li><strong>qsub</strong> &#8211; bool.Submits individual jobs to cluster. Use gpec.run for qsub overall optimizer.</li>
<li><strong>method</strong> &#8211; str.Method used in scipy.optimize.minimize.</li>
<li><strong>maxiter</strong> &#8211; int.Maximum number of iterations.</li>
<li><strong>loc</strong> &#8211; str. Directory location for run.</li>
<li><strong>rundir</strong> &#8211; str. IPEC package directory with executables and .dat files.</li>
<li><strong>kwargs</strong> &#8211; <p>dict. namelist instance(s) written to &lt;kwarg&gt;.in file(s).</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Namelists taken from (in order of priority):
1) Key word arguments 
2) .in files from loc
3) .in files from rundir</p>
</div>
</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">bool. True.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pypec.gpec.run">
<tt class="descclassname">pypec.gpec.</tt><tt class="descname">run</tt><big>(</big><em>loc='.'</em>, <em>rundir='/p/gpec/users/nlogan/gpec/bin/'</em>, <em>qsub=True</em>, <em>return_on_complete=False</em>, <em>rerun=False</em>, <em>rundcon=True</em>, <em>runipec=True</em>, <em>runpentrc=True</em>, <em>cleandcon=False</em>, <em>fill_inputs=False</em>, <em>mailon='ae'</em>, <em>email=''</em>, <em>mem=10000.0</em>, <em>runpent=False</em>, <em>optpentrc=False</em>, <em>pent_tol=0</em>, <em>**kwargs</em><big>)</big><a class="reference internal" href="_modules/pypec/gpec.html#run"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypec.gpec.run" title="Permalink to this definition">¶</a></dt>
<dd><p>Python wrapper for running ipec package.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>loc</strong> &#8211; str. Directory location for run.</li>
<li><strong>rundir</strong> &#8211; str. IPEC package directory with executables and .dat files.</li>
<li><strong>qsub</strong> &#8211; bool. Submit job to cluster.</li>
<li><strong>return_on_complete</strong> &#8211; bool. Return only after job is finished on cluster (irrelevant if qsub=False).</li>
<li><strong>rerun</strong> &#8211; bool. Does not delete existing .out files.</li>
<li><strong>rundcon</strong> &#8211; bool. Run dcon.</li>
<li><strong>runipec</strong> &#8211; bool. Run ipec.</li>
<li><strong>runpentrc</strong> &#8211; bool. Run pentrc.</li>
<li><strong>cleandcon</strong> &#8211; bool. Remove euler.bin file after run is complete.</li>
<li><strong>fill_inputs</strong> &#8211; bool. Use inputs from rundir (see kwargs).</li>
<li><strong>mailon</strong> &#8211; str. Any combination of a,b,e for on interruption execution, and termination respectively.</li>
<li><strong>email</strong> &#8211; str. Email address.</li>
<li><strong>mem</strong> &#8211; floatMemory request of q-submission in megabytes (converted to integer).</li>
<li><strong>kwargs</strong> &#8211; dict. namelist instance(s) written to &lt;kwarg&gt;.in file(s).</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Namelists taken from (in order of priority): 
1) Key word arguments 
2) .in files from loc
3) .in files from rundir</p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">bool. True.</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<span class="target" id="module-pypec.namelist"></span><div class="section" id="pypec-namelist-io-for-fortran-namelists">
<h2><a class="reference internal" href="#module-pypec.namelist" title="pypec.namelist"><tt class="xref py py-mod docutils literal"><span class="pre">pypec.namelist</span></tt></a> &#8211; IO for FORTRAN Namelists<a class="headerlink" href="#pypec-namelist-io-for-fortran-namelists" title="Permalink to this headline">¶</a></h2>
<p>This module provides pythonic tools for reading and writing 
fortran namelists.</p>
<div class="section" id="id1">
<h3>Examples<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<p>This module can be used to convert FORTRAN namelist files into 
python ordered dictionary type objects. The individual namelists are 
capitalized and their paramters are left as written. The actual
parameter is thus stored two levels deep in the dictionary.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">nl</span><span class="o">=</span><span class="n">read</span><span class="p">(</span><span class="s">&#39;examples/example_namelist.in&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nl</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
<span class="go">[&#39;IPEC_INPUT&#39;, &#39;IPEC_CONTROL&#39;, &#39;IPEC_OUTPUT&#39;, &#39;IPEC_DIAGNOSE&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nl</span><span class="p">[</span><span class="s">&#39;IPEC_CONTROL&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
<span class="go">[&#39;resp_index&#39;, &#39;sing_spot&#39;, &#39;reg_flag&#39;, &#39;reg_spot&#39;, &#39;chebyshev_flag&#39;, &#39;nche&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nl</span><span class="p">[</span><span class="s">&#39;IPEC_CONTROL&#39;</span><span class="p">][</span><span class="s">&#39;reg_spot&#39;</span><span class="p">]</span>
<span class="go">0.05</span>
</pre></div>
</div>
<p>The parameters can be changed, added, or deleted as in any python
dictionary.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">nl</span><span class="p">[</span><span class="s">&#39;IPEC_CONTROL&#39;</span><span class="p">][</span><span class="s">&#39;reg_spot&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.01</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nl</span><span class="p">[</span><span class="s">&#39;IPEC_CONTROL&#39;</span><span class="p">][</span><span class="s">&#39;reg_spot&#39;</span><span class="p">]</span>
<span class="go">0.01</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">del</span> <span class="n">nl</span><span class="p">[</span><span class="s">&#39;IPEC_CONTROL&#39;</span><span class="p">][</span><span class="s">&#39;nche&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nl</span><span class="p">[</span><span class="s">&#39;IPEC_CONTROL&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
<span class="go">[&#39;resp_index&#39;, &#39;sing_spot&#39;, &#39;reg_flag&#39;, &#39;reg_spot&#39;, &#39;chebyshev_flag&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nl</span><span class="p">[</span><span class="s">&#39;IPEC_CONTROL&#39;</span><span class="p">][</span><span class="s">&#39;nche&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">30</span>     
</pre></div>
</div>
<p>The resulting namelists can then be re-written in ASCII format
for use with the FORTAN codes.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">write</span><span class="p">(</span><span class="n">nl</span><span class="p">,</span><span class="s">&#39;examples/example_namelist_edit.in&#39;</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>These examples can be tested by developers using ipython as follows:</p>
<blockquote class="last">
<div><p>In [1]: import pypec.namelist,doctest</p>
<p>In [2]: doctest.testmod(pypec.namelist,verbose=True)</p>
</div></blockquote>
</div>
<dl class="class">
<dt id="pypec.namelist.Objectify">
<em class="property">class </em><tt class="descclassname">pypec.namelist.</tt><tt class="descname">Objectify</tt><big>(</big><em>d</em><big>)</big><a class="reference internal" href="_modules/pypec/namelist.html#Objectify"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypec.namelist.Objectify" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="http://docs.python.org/library/functions.html#object" title="(in Python v2.7)"><tt class="xref py py-class docutils literal"><span class="pre">object</span></tt></a></p>
</dd></dl>

<dl class="function">
<dt id="pypec.namelist.read">
<tt class="descclassname">pypec.namelist.</tt><tt class="descname">read</tt><big>(</big><em>filename</em>, <em>out_type='dict'</em>, <em>comment='!'</em>, <em>old=False</em><big>)</big><a class="reference internal" href="_modules/pypec/namelist.html#read"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypec.namelist.read" title="Permalink to this definition">¶</a></dt>
<dd><p>Read in a file. Must have namelists in series, not embedded.
Assumes name of list preceded by &#8216;&amp;&#8217; and list ends with &#8216;&#8217;.</p>
<p>:param filename : str. Path to input namelist.
:param out_type : str. Can be either &#8216;dict&#8217; or &#8216;obj&#8217;.
:param comment : str. Lines starting with any of these characters are considerd annotations.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">dict (object). Top keys (attributes) are namelists with sub-key(-attribute) parameter values.</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The returned dict is actually &#8220;OrderedDict&#8221; type from 
collections module. If returning an object, the object is 
un-ordered.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="pypec.namelist.write">
<tt class="descclassname">pypec.namelist.</tt><tt class="descname">write</tt><big>(</big><em>nl</em>, <em>filename</em>, <em>old=False</em><big>)</big><a class="reference internal" href="_modules/pypec/namelist.html#write"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypec.namelist.write" title="Permalink to this definition">¶</a></dt>
<dd><p>Write namelist object to file for fortran interface.</p>
<p>:param nl       : object. namelist object from read(). Can be dictionary or Objectify type class.
:param filename : str. Path of file to be written.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">bool. True.</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
</div>
<span class="target" id="module-pypec.modplot"></span><div class="section" id="pypec-modplot-matplotlib-customizations">
<h2><a class="reference internal" href="#module-pypec.modplot" title="pypec.modplot"><tt class="xref py py-mod docutils literal"><span class="pre">pypec.modplot</span></tt></a> &#8211; matplotlib Customizations<a class="headerlink" href="#pypec-modplot-matplotlib-customizations" title="Permalink to this headline">¶</a></h2>
<p>Collection of modified matplotlib functions and objects.</p>
<div class="section" id="id2">
<h3>Examples<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h3>
<p>Plot complex arguments.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">subplots</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lines</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="mf">0.5j</span><span class="p">),</span><span class="n">label</span><span class="o">=</span><span class="s">&#39;test&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pyplot</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>Automatically resize plots to fit labels.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">xlbl</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s">&#39;X AXIS&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Plot huge data sets quickly.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mf">1e5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">1e5</span><span class="p">)</span><span class="o">/</span><span class="mf">1.5e4</span><span class="o">+</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mf">1e5</span><span class="p">)</span><span class="o">-</span><span class="mf">0.5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">newline</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">data</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s">&#39;large data set&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>This plots a line capped at 1000-pts by default. The maximum number 
of points is maintained as you manipulate the axis, so zooming
in will provide you with new points and increased detail until the
window samples fewer than that many points in the orginal data. The
first two lines, for instance, contain only their original 10 points
(not 1000 interpolated points).</p>
<dl class="class">
<dt id="pypec.modplot.MidPointNorm">
<em class="property">class </em><tt class="descclassname">pypec.modplot.</tt><tt class="descname">MidPointNorm</tt><big>(</big><em>midpoint=0</em>, <em>vmin=None</em>, <em>vmax=None</em>, <em>clip=False</em><big>)</big><a class="reference internal" href="_modules/pypec/modplot.html#MidPointNorm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypec.modplot.MidPointNorm" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <tt class="xref py py-class docutils literal"><span class="pre">matplotlib.colors.Normalize</span></tt></p>
<p>Taken from <a class="reference external" href="http://stackoverflow.com/questions/7404116/defining-the-midpoint-of-a-colormap-in-matplotlib">http://stackoverflow.com/questions/7404116/defining-the-midpoint-of-a-colormap-in-matplotlib</a></p>
<dl class="method">
<dt id="pypec.modplot.MidPointNorm.inverse">
<tt class="descname">inverse</tt><big>(</big><em>value</em><big>)</big><a class="reference internal" href="_modules/pypec/modplot.html#MidPointNorm.inverse"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypec.modplot.MidPointNorm.inverse" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="function">
<dt id="pypec.modplot.colorbar">
<tt class="descclassname">pypec.modplot.</tt><tt class="descname">colorbar</tt><big>(</big><em>mappable=None</em>, <em>cax=None</em>, <em>ax=None</em>, <em>use_gridspec=True</em>, <em>**kw</em><big>)</big><a class="reference internal" href="_modules/pypec/modplot.html#colorbar"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypec.modplot.colorbar" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Modified pyplot colorbar for default use_gridspec=True.</p>
<p>ORIGINAL DOCUMENTATION</p>
</div></blockquote>
<p>Add a colorbar to a plot.</p>
<p>Function signatures for the <tt class="xref py py-mod docutils literal"><span class="pre">pyplot</span></tt> interface; all
but the first are also method signatures for the
<tt class="xref py py-meth docutils literal"><span class="pre">colorbar()</span></tt> method:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">colorbar</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="n">colorbar</span><span class="p">(</span><span class="n">mappable</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="n">colorbar</span><span class="p">(</span><span class="n">mappable</span><span class="p">,</span> <span class="n">cax</span><span class="o">=</span><span class="n">cax</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="n">colorbar</span><span class="p">(</span><span class="n">mappable</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>
</div>
<p>arguments:</p>
<blockquote>
<div><dl class="docutils">
<dt><em>mappable</em></dt>
<dd>the <tt class="xref py py-class docutils literal"><span class="pre">Image</span></tt>,
<tt class="xref py py-class docutils literal"><span class="pre">ContourSet</span></tt>, etc. to
which the colorbar applies; this argument is mandatory for the
<tt class="xref py py-meth docutils literal"><span class="pre">colorbar()</span></tt> method but optional for the
<tt class="xref py py-func docutils literal"><span class="pre">colorbar()</span></tt> function, which sets the
default to the current image.</dd>
</dl>
</div></blockquote>
<p>keyword arguments:</p>
<blockquote>
<div><dl class="docutils">
<dt><em>cax</em></dt>
<dd>None | axes object into which the colorbar will be drawn</dd>
<dt><em>ax</em></dt>
<dd>None | parent axes object(s) from which space for a new
colorbar axes will be stolen. If a list of axes is given
they will all be resized to make room for the colorbar axes.</dd>
<dt><em>use_gridspec</em></dt>
<dd>False | If <em>cax</em> is None, a new <em>cax</em> is created as an instance of
Axes. If <em>ax</em> is an instance of Subplot and <em>use_gridspec</em> is True,
<em>cax</em> is created as an instance of Subplot using the
grid_spec module.</dd>
</dl>
</div></blockquote>
<p>Additional keyword arguments are of two kinds:</p>
<blockquote>
<div><p>axes properties:</p>
<blockquote>
<div><table border="1" class="docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Property</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><em>orientation</em></td>
<td>vertical or horizontal</td>
</tr>
<tr class="row-odd"><td><em>fraction</em></td>
<td>0.15; fraction of original axes to use for colorbar</td>
</tr>
<tr class="row-even"><td><em>pad</em></td>
<td>0.05 if vertical, 0.15 if horizontal; fraction
of original axes between colorbar and new image axes</td>
</tr>
<tr class="row-odd"><td><em>shrink</em></td>
<td>1.0; fraction by which to shrink the colorbar</td>
</tr>
<tr class="row-even"><td><em>aspect</em></td>
<td>20; ratio of long to short dimensions</td>
</tr>
<tr class="row-odd"><td><em>anchor</em></td>
<td>(0.0, 0.5) if vertical; (0.5, 1.0) if horizontal;
the anchor point of the colorbar axes</td>
</tr>
<tr class="row-even"><td><em>panchor</em></td>
<td>(1.0, 0.5) if vertical; (0.5, 0.0) if horizontal;
the anchor point of the colorbar parent axes. If
False, the parent axes&#8217; anchor will be unchanged</td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>colorbar properties:</p>
<blockquote>
<div><table border="1" class="docutils">
<colgroup>
<col width="18%" />
<col width="82%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Property</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><em>extend</em></td>
<td>[ &#8216;neither&#8217; | &#8216;both&#8217; | &#8216;min&#8217; | &#8216;max&#8217; ]
If not &#8216;neither&#8217;, make pointed end(s) for out-of-
range values.  These are set for a given colormap
using the colormap set_under and set_over methods.</td>
</tr>
<tr class="row-odd"><td><em>extendfrac</em></td>
<td>[ <em>None</em> | &#8216;auto&#8217; | length | lengths ]
If set to <em>None</em>, both the minimum and maximum
triangular colorbar extensions with have a length of
5% of the interior colorbar length (this is the
default setting). If set to &#8216;auto&#8217;, makes the
triangular colorbar extensions the same lengths as
the interior boxes (when <em>spacing</em> is set to
&#8216;uniform&#8217;) or the same lengths as the respective
adjacent interior boxes (when <em>spacing</em> is set to
&#8216;proportional&#8217;). If a scalar, indicates the length
of both the minimum and maximum triangular colorbar
extensions as a fraction of the interior colorbar
length. A two-element sequence of fractions may also
be given, indicating the lengths of the minimum and
maximum colorbar extensions respectively as a
fraction of the interior colorbar length.</td>
</tr>
<tr class="row-even"><td><em>extendrect</em></td>
<td>[ <em>False</em> | <em>True</em> ]
If <em>False</em> the minimum and maximum colorbar extensions
will be triangular (the default). If <em>True</em> the
extensions will be rectangular.</td>
</tr>
<tr class="row-odd"><td><em>spacing</em></td>
<td>[ &#8216;uniform&#8217; | &#8216;proportional&#8217; ]
Uniform spacing gives each discrete color the same
space; proportional makes the space proportional to
the data interval.</td>
</tr>
<tr class="row-even"><td><em>ticks</em></td>
<td>[ None | list of ticks | Locator object ]
If None, ticks are determined automatically from the
input.</td>
</tr>
<tr class="row-odd"><td><em>format</em></td>
<td>[ None | format string | Formatter object ]
If None, the
<tt class="xref py py-class docutils literal"><span class="pre">ScalarFormatter</span></tt> is used.
If a format string is given, e.g., &#8216;%.3f&#8217;, that is
used. An alternative
<tt class="xref py py-class docutils literal"><span class="pre">Formatter</span></tt> object may be
given instead.</td>
</tr>
<tr class="row-even"><td><em>drawedges</em></td>
<td>[ False | True ] If true, draw lines at color
boundaries.</td>
</tr>
</tbody>
</table>
<p>The following will probably be useful only in the context of
indexed colors (that is, when the mappable has norm=NoNorm()),
or other unusual circumstances.</p>
<table border="1" class="docutils">
<colgroup>
<col width="19%" />
<col width="81%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Property</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><em>boundaries</em></td>
<td>None or a sequence</td>
</tr>
<tr class="row-odd"><td><em>values</em></td>
<td>None or a sequence which must be of length 1 less
than the sequence of <em>boundaries</em>. For each region
delimited by adjacent entries in <em>boundaries</em>, the
color mapped to the corresponding value in values
will be used.</td>
</tr>
</tbody>
</table>
</div></blockquote>
</div></blockquote>
<p>If <em>mappable</em> is a <tt class="xref py py-class docutils literal"><span class="pre">ContourSet</span></tt>, its <em>extend</em>
kwarg is included automatically.</p>
<p>Note that the <em>shrink</em> kwarg provides a simple way to keep a vertical
colorbar, for example, from being taller than the axes of the mappable
to which the colorbar is attached; but it is a manual method requiring
some trial and error. If the colorbar is too tall (or a horizontal
colorbar is too wide) use a smaller value of <em>shrink</em>.</p>
<p>For more precise control, you can manually specify the positions of
the axes objects in which the mappable and the colorbar are drawn.  In
this case, do not use any of the axes properties kwargs.</p>
<p>It is known that some vector graphics viewer (svg and pdf) renders white gaps
between segments of the colorbar. This is due to bugs in the viewers not
matplotlib. As a workaround the colorbar can be rendered with overlapping
segments:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">cbar</span> <span class="o">=</span> <span class="n">colorbar</span><span class="p">()</span>
<span class="n">cbar</span><span class="o">.</span><span class="n">solids</span><span class="o">.</span><span class="n">set_edgecolor</span><span class="p">(</span><span class="s">&quot;face&quot;</span><span class="p">)</span>
<span class="n">draw</span><span class="p">()</span>
</pre></div>
</div>
<p>However this has negative consequences in other circumstances. Particularly
with semi transparent images (alpha &lt; 1) and colorbar extensions and is not
enabled by default see (issue #1188).</p>
<dl class="docutils">
<dt>returns:</dt>
<dd><tt class="xref py py-class docutils literal"><span class="pre">Colorbar</span></tt> instance; see also its base class,
<tt class="xref py py-class docutils literal"><span class="pre">ColorbarBase</span></tt>.  Call the
<tt class="xref py py-meth docutils literal"><span class="pre">set_label()</span></tt> method
to label the colorbar.</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="pypec.modplot.figure">
<tt class="descclassname">pypec.modplot.</tt><tt class="descname">figure</tt><big>(</big><em>num=None</em>, <em>figsize=None</em>, <em>dpi=None</em>, <em>facecolor=None</em>, <em>edgecolor=None</em>, <em>frameon=True</em>, <em>FigureClass=&lt;class 'matplotlib.figure.Figure'&gt;</em>, <em>**kwargs</em><big>)</big><a class="reference internal" href="_modules/pypec/modplot.html#figure"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypec.modplot.figure" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="pypec.modplot.line_downsample">
<tt class="descclassname">pypec.modplot.</tt><tt class="descname">line_downsample</tt><big>(</big><em>line</em>, <em>npts=1000</em><big>)</big><a class="reference internal" href="_modules/pypec/modplot.html#line_downsample"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypec.modplot.line_downsample" title="Permalink to this definition">¶</a></dt>
<dd><p>Downsample line data for increased plotting speed.</p>
<dl class="docutils">
<dt>Key Word Arguments: </dt>
<dd><dl class="first last docutils">
<dt>npts <span class="classifier-delimiter">:</span> <span class="classifier">int. </span></dt>
<dd>Number of data points within axes xlims.</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="pypec.modplot.onkey">
<tt class="descclassname">pypec.modplot.</tt><tt class="descname">onkey</tt><big>(</big><em>event</em><big>)</big><a class="reference internal" href="_modules/pypec/modplot.html#onkey"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypec.modplot.onkey" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to connect key_press_event events from matplotlib
to custom functions.</p>
<p>Matplotlib defaults (may be changed in matplotlibrc):</p>
<p>keymap.fullscreen : f               # toggling
keymap.home : h, r, home            # home or reset mnemonic
keymap.back : left, c, backspace    # forward / backward keys to enable
keymap.forward : right, v           #   left handed quick navigation
keymap.pan : p                      # pan mnemonic
keymap.zoom : o                     # zoom mnemonic
keymap.save : s                     # saving current figure
keymap.quit : ctrl+w                # close the current figure
keymap.grid : g                     # switching on/off a grid in current axes
keymap.yscale : l                   # toggle scaling of y-axes (&#8216;log&#8217;/&#8217;linear&#8217;)
keymap.xscale : L, k                # toggle scaling of x-axes (&#8216;log&#8217;/&#8217;linear&#8217;)
keymap.all_axes : a                 # enable all axes</p>
<p>My custom function mapping:</p>
<p>popaxes : n                         #Creates new figure with current axes
tighten : t                         #Call tight_layout bound method for figure</p>
</dd></dl>

<dl class="function">
<dt id="pypec.modplot.plot_axes">
<tt class="descclassname">pypec.modplot.</tt><tt class="descname">plot_axes</tt><big>(</big><em>ax</em>, <em>fig=None</em>, <em>geometry=(1</em>, <em>1</em>, <em>1)</em><big>)</big><a class="reference internal" href="_modules/pypec/modplot.html#plot_axes"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypec.modplot.plot_axes" title="Permalink to this definition">¶</a></dt>
<dd><p>Re-create a given axis in a new figure. This allows, for instance,
a subplot to be moved to its own figure where it can be manipulated
and/or saved independent of the original.</p>
<dl class="docutils">
<dt>Arguments:   </dt>
<dd><dl class="first last docutils">
<dt>ax <span class="classifier-delimiter">:</span> <span class="classifier">obj. </span></dt>
<dd>An initialized Axes object</dd>
</dl>
</dd>
<dt>Key Word Arguments: </dt>
<dd><dl class="first last docutils">
<dt>fig: obj. </dt>
<dd>A figure in which to re-create the axis</dd>
<dt>geometry <span class="classifier-delimiter">:</span> <span class="classifier">tuple. </span></dt>
<dd>Axes geometry of re-created axis</dd>
</dl>
</dd>
<dt>returns    </dt>
<dd>Figure.</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="pypec.modplot.png_to_gif">
<tt class="descclassname">pypec.modplot.</tt><tt class="descname">png_to_gif</tt><big>(</big><em>files</em>, <em>gif_file</em>, <em>delay=20</em>, <em>loop=0</em>, <em>clean=False</em><big>)</big><a class="reference internal" href="_modules/pypec/modplot.html#png_to_gif"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypec.modplot.png_to_gif" title="Permalink to this definition">¶</a></dt>
<dd><p>gif_file should end in .gif</p>
</dd></dl>

<dl class="function">
<dt id="pypec.modplot.printlines">
<tt class="descclassname">pypec.modplot.</tt><tt class="descname">printlines</tt><big>(</big><em>self</em>, <em>filename</em>, <em>labeled_only=False</em>, <em>squeeze=False</em><big>)</big><a class="reference internal" href="_modules/pypec/modplot.html#printlines"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypec.modplot.printlines" title="Permalink to this definition">¶</a></dt>
<dd><p>Print all data in line plot(s) to text file.The x values 
will be taken from the line with the greatest number of
points in the (first) axis, and other lines are interpolated
if their x values do not match. Column lables are the
line labels and xlabel.</p>
<dl class="docutils">
<dt>Arguments:</dt>
<dd><dl class="first last docutils">
<dt>filename <span class="classifier-delimiter">:</span> <span class="classifier">str. </span></dt>
<dd>Path to print to.</dd>
</dl>
</dd>
<dt>Key Word Arguments:</dt>
<dd><dl class="first last docutils">
<dt>labeled_only <span class="classifier-delimiter">:</span> <span class="classifier">bool</span></dt>
<dd>Only print labeled lines to file.</dd>
<dt>squeeze <span class="classifier-delimiter">:</span> <span class="classifier">bool.</span></dt>
<dd>Print lines from all axes in a single table.</dd>
</dl>
</dd>
<dt>returns</dt>
<dd><dl class="first last docutils">
<dt>bool. </dt>
<dd>True.</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="pypec.modplot.set_linearray">
<tt class="descclassname">pypec.modplot.</tt><tt class="descname">set_linearray</tt><big>(</big><em>lines</em>, <em>values=None</em>, <em>cmap=None</em>, <em>vmin=None</em>, <em>vmax=None</em><big>)</big><a class="reference internal" href="_modules/pypec/modplot.html#set_linearray"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypec.modplot.set_linearray" title="Permalink to this definition">¶</a></dt>
<dd><p>Set colors of lines to colormaping of values.</p>
<p>Other good sequential colormaps are YlOrBr and autumn.
A good diverging colormap is bwr.</p>
<dl class="docutils">
<dt><strong>Arguments:</strong></dt>
<dd><ul class="first last simple">
<li>lines : list. Lines to get set colors.</li>
</ul>
</dd>
<dt><strong>Key Word Arguments:</strong></dt>
<dd><ul class="first last simple">
<li>values : array like. Values corresponding to each line. Default is indexing.</li>
<li>cmap : str. Valid matplotlib colormap name.</li>
<li>vmax : float. Upper bound of colormaping.</li>
<li>vmin : float. Lower bound of colormaping.</li>
</ul>
</dd>
<dt><strong>Returns:</strong></dt>
<dd><ul class="first last simple">
<li>ScalarMappable. A mapping object used for colorbars.</li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="pypec.modplot.set_style">
<tt class="descclassname">pypec.modplot.</tt><tt class="descname">set_style</tt><big>(</big><em>style=None</em>, <em>rc={}</em><big>)</big><a class="reference internal" href="_modules/pypec/modplot.html#set_style"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypec.modplot.set_style" title="Permalink to this definition">¶</a></dt>
<dd><p>Seaborn set_style with additional &#8216;thick&#8217;,</p>
<p>Thick (thin) style multiplies rcParams axes.linewidth, lines.linewidth,
xtick.major.width, xtick.minor.width, ytick.major.width, and 
ytick.minor.width by 2 (0.5).</p>
</dd></dl>

<dl class="function">
<dt id="pypec.modplot.shiftedColorMap">
<tt class="descclassname">pypec.modplot.</tt><tt class="descname">shiftedColorMap</tt><big>(</big><em>cmap</em>, <em>start=0</em>, <em>midpoint=0.5</em>, <em>stop=1.0</em>, <em>name='shiftedcmap'</em><big>)</big><a class="reference internal" href="_modules/pypec/modplot.html#shiftedColorMap"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypec.modplot.shiftedColorMap" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to offset the &#8220;center&#8221; of a colormap. Useful for
data with a negative min and positive max and you want the
middle of the colormap&#8217;s dynamic range to be at zero.</p>
<p>Taken from <a class="reference external" href="http://stackoverflow.com/questions/7404116/defining-the-midpoint-of-a-colormap-in-matplotlib">http://stackoverflow.com/questions/7404116/defining-the-midpoint-of-a-colormap-in-matplotlib</a></p>
<dl class="docutils">
<dt>Args:</dt>
<dd>cmap: The matplotlib colormap to be altered
start: Offset from lowest point in the colormap&#8217;s range. Should be between 0 and &#8216;midpoint&#8217;.
midpoint: The new center of the colormap. Should be between 0.0 and 1.0. Recommended is  1 - vmax/(vmax + abs(vmin)).
stop: Offset from highest point in the colormap&#8217;s range. Should be between &#8216;midpoint&#8217; and 1.0.
name: str. Added to the name of cmap when creating the new colormap.</dd>
</dl>
<p>Example:</p>
<p>The following creates a shifted colormap that can be used in matplotlib arguments,</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">orig_cmap</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">coolwarm</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">shifted_cmap</span> <span class="o">=</span> <span class="n">shiftedColorMap</span><span class="p">(</span><span class="n">orig_cmap</span><span class="p">,</span> <span class="n">midpoint</span><span class="o">=</span><span class="mf">0.75</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s">&#39;shifted&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pypec.modplot.subplots">
<tt class="descclassname">pypec.modplot.</tt><tt class="descname">subplots</tt><big>(</big><em>nrows=1</em>, <em>ncols=1</em>, <em>sharex=False</em>, <em>sharey=False</em>, <em>squeeze=True</em>, <em>autosize=True</em>, <em>subplot_kw=None</em>, <em>powerlim=(-3</em>, <em>3)</em>, <em>useOffset=False</em>, <em>nybins=None</em>, <em>nxbins=None</em>, <em>**fig_kw</em><big>)</big><a class="reference internal" href="_modules/pypec/modplot.html#subplots"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypec.modplot.subplots" title="Permalink to this definition">¶</a></dt>
<dd><p>Matplotlib subplots with default figsize = rcp_size*[ncols,nrows]
fig_kw.setdefault(&#8216;figsize&#8217;,figsize).</p>
<dl class="docutils">
<dt>Additional Key Word Arguments:</dt>
<dd><dl class="first last docutils">
<dt>powlim <span class="classifier-delimiter">:</span> <span class="classifier">tuple. </span></dt>
<dd>Axis labels use scientific notion above 10^power.</dd>
<dt>useOffset <span class="classifier-delimiter">:</span> <span class="classifier">bool. </span></dt>
<dd>Axis labels use offset if range&lt;&lt;average.</dd>
</dl>
</dd>
</dl>
<p>Accepts standargs args and kwargs for pyplot.subplots.</p>
<p>ORIGINAL DOCUMENTATION</p>
<p>Create a figure with a set of subplots already made.</p>
<p>This utility wrapper makes it convenient to create common layouts of
subplots, including the enclosing figure object, in a single call.</p>
<p>Keyword arguments:</p>
<blockquote>
<div><dl class="docutils">
<dt><em>nrows</em> <span class="classifier-delimiter">:</span> <span class="classifier">int</span></dt>
<dd>Number of rows of the subplot grid.  Defaults to 1.</dd>
<dt><em>ncols</em> <span class="classifier-delimiter">:</span> <span class="classifier">int</span></dt>
<dd>Number of columns of the subplot grid.  Defaults to 1.</dd>
<dt><em>sharex</em> <span class="classifier-delimiter">:</span> <span class="classifier">string or bool</span></dt>
<dd>If <em>True</em>, the X axis will be shared amongst all subplots.  If
<em>True</em> and you have multiple rows, the x tick labels on all but
the last row of plots will have visible set to <em>False</em>
If a string must be one of &#8220;row&#8221;, &#8220;col&#8221;, &#8220;all&#8221;, or &#8220;none&#8221;.
&#8220;all&#8221; has the same effect as <em>True</em>, &#8220;none&#8221; has the same effect
as <em>False</em>.
If &#8220;row&#8221;, each subplot row will share a X axis.
If &#8220;col&#8221;, each subplot column will share a X axis and the x tick
labels on all but the last row will have visible set to <em>False</em>.</dd>
<dt><em>sharey</em> <span class="classifier-delimiter">:</span> <span class="classifier">string or bool</span></dt>
<dd>If <em>True</em>, the Y axis will be shared amongst all subplots. If
<em>True</em> and you have multiple columns, the y tick labels on all but
the first column of plots will have visible set to <em>False</em>
If a string must be one of &#8220;row&#8221;, &#8220;col&#8221;, &#8220;all&#8221;, or &#8220;none&#8221;.
&#8220;all&#8221; has the same effect as <em>True</em>, &#8220;none&#8221; has the same effect
as <em>False</em>.
If &#8220;row&#8221;, each subplot row will share a Y axis and the y tick
labels on all but the first column will have visible set to <em>False</em>.
If &#8220;col&#8221;, each subplot column will share a Y axis.</dd>
<dt><em>squeeze</em> <span class="classifier-delimiter">:</span> <span class="classifier">bool</span></dt>
<dd><p class="first">If <em>True</em>, extra dimensions are squeezed out from the
returned axis object:</p>
<ul class="simple">
<li>if only one subplot is constructed (nrows=ncols=1), the
resulting single Axis object is returned as a scalar.</li>
<li>for Nx1 or 1xN subplots, the returned object is a 1-d numpy
object array of Axis objects are returned as numpy 1-d
arrays.</li>
<li>for NxM subplots with N&gt;1 and M&gt;1 are returned as a 2d
array.</li>
</ul>
<p class="last">If <em>False</em>, no squeezing at all is done: the returned axis
object is always a 2-d array containing Axis instances, even if it
ends up being 1x1.</p>
</dd>
<dt><em>subplot_kw</em> <span class="classifier-delimiter">:</span> <span class="classifier">dict</span></dt>
<dd>Dict with keywords passed to the
<tt class="xref py py-meth docutils literal"><span class="pre">add_subplot()</span></tt> call used to
create each subplots.</dd>
<dt><em>gridspec_kw</em> <span class="classifier-delimiter">:</span> <span class="classifier">dict</span></dt>
<dd>Dict with keywords passed to the
<tt class="xref py py-class docutils literal"><span class="pre">GridSpec</span></tt> constructor used to create
the grid the subplots are placed on.</dd>
<dt><em>fig_kw</em> <span class="classifier-delimiter">:</span> <span class="classifier">dict</span></dt>
<dd>Dict with keywords passed to the <a class="reference internal" href="#pypec.modplot.figure" title="pypec.modplot.figure"><tt class="xref py py-func docutils literal"><span class="pre">figure()</span></tt></a> call.  Note that all
keywords not recognized above will be automatically included here.</dd>
</dl>
</div></blockquote>
<p>Returns:</p>
<p>fig, ax : tuple</p>
<blockquote>
<div><ul class="simple">
<li><em>fig</em> is the <tt class="xref py py-class docutils literal"><span class="pre">matplotlib.figure.Figure</span></tt> object</li>
<li><em>ax</em> can be either a single axis object or an array of axis
objects if more than one subplot was created.  The dimensions
of the resulting array can be controlled with the squeeze
keyword, see above.</li>
</ul>
</div></blockquote>
<p>Examples:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">400</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

<span class="c"># Just a figure and one subplot</span>
<span class="n">f</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s">&#39;Simple plot&#39;</span><span class="p">)</span>

<span class="c"># Two subplots, unpack the output array immediately</span>
<span class="n">f</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s">&#39;Sharing Y axis&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

<span class="c"># Four polar axes</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">subplot_kw</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">polar</span><span class="o">=</span><span class="bp">True</span><span class="p">))</span>

<span class="c"># Share a X axis with each column of subplots</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="s">&#39;col&#39;</span><span class="p">)</span>

<span class="c"># Share a Y axis with each row of subplots</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="s">&#39;row&#39;</span><span class="p">)</span>

<span class="c"># Share a X and Y axis with all subplots</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="s">&#39;all&#39;</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="s">&#39;all&#39;</span><span class="p">)</span>
<span class="c"># same as</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pypec.modplot.xyaxes">
<tt class="descclassname">pypec.modplot.</tt><tt class="descname">xyaxes</tt><big>(</big><em>axes</em>, <em>x=True</em>, <em>y=True</em>, <em>**kwargs</em><big>)</big><a class="reference internal" href="_modules/pypec/modplot.html#xyaxes"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypec.modplot.xyaxes" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot hline and vline through (0,0).</p>
<dl class="docutils">
<dt><strong>Arguments:</strong></dt>
<dd><ul class="first last simple">
<li>axes : obj. Matplotlib Axes object.</li>
</ul>
</dd>
<dt><strong>key Word Arguments:</strong></dt>
<dd><ul class="first last simple">
<li>x : bool. Draw hline</li>
<li>y : bool. Draw vline</li>
</ul>
</dd>
<dt><strong>Returns:</strong></dt>
<dd><ul class="first last simple">
<li>bool.</li>
</ul>
</dd>
</dl>
<p>All other kwargs passed to hlines and vlines functions.</p>
</dd></dl>

</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="releases.html" title="Accessing Releases"
             >next</a> |</li>
        <li class="right" >
          <a href="examples.html" title="Tutorial Examples"
             >previous</a> |</li>
        <li><a href="index.html">home</a>|&nbsp;</li>
        <li><a href="search.html">search</a>|&nbsp;</li>
 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2015, PPPL.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.3.
    </div>
  </body>
</html>