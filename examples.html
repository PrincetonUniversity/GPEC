
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
        <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Tutorial Examples &#8212; GPEC 1.0.5 documentation</title>
    <link rel="stylesheet" href="_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="PYPEC Source documentation" href="source_documentation.html" />
    <link rel="prev" title="Namelist Variables" href="namelists.html" /> 
  </head><body>

<div style="background-color: white; text-align: left; padding: 10px 10px 15px 15px">
<a href="index.html"><img src="_static/logo.png" border="0" alt="py4sci"/></a>
</div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="source_documentation.html" title="PYPEC Source documentation"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="namelists.html" title="Namelist Variables"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">home</a>|&nbsp;</li>
        <li><a href="search.html">search</a>|&nbsp;</li>
 
      </ul>
    </div>

      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Tutorial Examples</a><ul>
<li><a class="reference internal" href="#gpec-diii-d-ideal-example">GPEC DIII-D Ideal Example</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="namelists.html"
                        title="previous chapter">Namelist Variables</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="source_documentation.html"
                        title="next chapter">PYPEC Source documentation</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/examples.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="tutorial-examples">
<span id="examples"></span><h1>Tutorial Examples<a class="headerlink" href="#tutorial-examples" title="Permalink to this headline">¶</a></h1>
<p>This section provides some useful tutorial examples for running the GPEC package codes together to produce relavent, publication worthy results.</p>
<div class="section" id="gpec-diii-d-ideal-example">
<h2>GPEC DIII-D Ideal Example<a class="headerlink" href="#gpec-diii-d-ideal-example" title="Permalink to this headline">¶</a></h2>
<p>This example uses a baseline H-mode Error Field Correction (EFC) plasma from a n=1 EFC study done in 2013. The equilibrium used is a kinetic EFIT from DIII-D shot 147131 at 2300ms, and the profiles are self consistent with the equilibrium. Pre-GPEC results using a combination of GPEC and PENT for this calculation are published in <a class="reference external" href="http://scitation.aip.org/content/aip/journal/pop/21/7/10.1063/1.4886795">[C. Paz-Soldan, M. J. Lanctot, N. C. Logan, et al., Phys. Plasmas 21, 072503 (2014).]</a>.</p>
<p>Note that the coil and pentrc input namelists use relative paths to the package’s data files. If you would like to run the example in a different location, you must change the input appropriately.</p>
<p>Following a typical workflow we first cd to the example’s directory, then run DCON:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">dcon</span>

 <span class="n">DCON</span> <span class="n">START</span> <span class="o">=&gt;</span> <span class="n">GPEC</span> <span class="n">version</span> <span class="mf">1.0</span><span class="o">.</span><span class="mi">0</span>
 <span class="n">__________________________________________</span>
 <span class="n">psihigh</span> <span class="o">=</span> <span class="mf">9.930E-01</span>
 <span class="n">Equilibrium</span><span class="p">:</span> <span class="n">g147131</span><span class="o">.</span><span class="mi">02300</span><span class="n">_DIIID_KEFIT</span><span class="p">,</span> <span class="n">Type</span><span class="p">:</span> <span class="n">efit</span>
 <span class="n">Jac_type</span> <span class="o">=</span> <span class="n">hamada</span><span class="p">,</span> <span class="n">power_bp</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">power_b</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">power_r</span> <span class="o">=</span> <span class="mi">0</span>
 <span class="n">Diagnosing</span> <span class="n">Grad</span><span class="o">-</span><span class="n">Shafranov</span> <span class="n">solution</span>
 <span class="n">Evaluating</span> <span class="n">Mercier</span> <span class="n">criterion</span>
 <span class="n">Evaluating</span> <span class="n">ballooning</span> <span class="n">criterion</span>
 <span class="n">Fourier</span> <span class="n">analysis</span> <span class="n">of</span> <span class="n">metric</span> <span class="n">tensor</span> <span class="n">components</span>
 <span class="n">q0</span> <span class="o">=</span>  <span class="mf">1.062E+00</span><span class="p">,</span> <span class="n">qmin</span> <span class="o">=</span>  <span class="mf">1.062E+00</span><span class="p">,</span> <span class="n">qmax</span> <span class="o">=</span>  <span class="mf">5.321E+00</span><span class="p">,</span> <span class="n">q95</span> <span class="o">=</span>  <span class="mf">4.228E+00</span>
 <span class="n">sas_flag</span> <span class="o">=</span> <span class="n">T</span><span class="p">,</span> <span class="n">dmlim</span> <span class="o">=</span>  <span class="mf">2.000E-01</span><span class="p">,</span> <span class="n">qlim</span> <span class="o">=</span>  <span class="mf">5.200E+00</span><span class="p">,</span> <span class="n">psilim</span> <span class="o">=</span>  <span class="mf">9.915E-01</span>
 <span class="n">betat</span> <span class="o">=</span>  <span class="mf">2.184E-02</span><span class="p">,</span> <span class="n">betan</span> <span class="o">=</span>  <span class="mf">1.905E+00</span><span class="p">,</span> <span class="n">betap1</span> <span class="o">=</span>  <span class="mf">7.977E-01</span>
 <span class="n">nn</span> <span class="o">=</span>   <span class="mi">1</span><span class="p">,</span> <span class="n">mlow</span> <span class="o">=</span> <span class="o">-</span><span class="mi">12</span><span class="p">,</span> <span class="n">mhigh</span> <span class="o">=</span>  <span class="mi">21</span><span class="p">,</span> <span class="n">mpert</span> <span class="o">=</span>  <span class="mi">34</span><span class="p">,</span> <span class="n">mband</span> <span class="o">=</span>  <span class="mi">33</span>
 <span class="n">Computing</span> <span class="n">F</span><span class="p">,</span> <span class="n">G</span><span class="p">,</span> <span class="ow">and</span> <span class="n">K</span> <span class="n">Matrices</span>
 <span class="n">Starting</span> <span class="n">integration</span> <span class="n">of</span> <span class="n">ODE</span><span class="s1">&#39;s</span>
 <span class="n">psi</span> <span class="o">=</span> <span class="mf">1.000E-04</span><span class="p">,</span> <span class="n">q</span> <span class="o">=</span>  <span class="mf">1.062</span>
 <span class="n">psi</span> <span class="o">=</span> <span class="mf">5.936E-01</span><span class="p">,</span> <span class="n">q</span> <span class="o">=</span>  <span class="mf">2.000</span>
 <span class="n">psi</span> <span class="o">=</span> <span class="mf">8.186E-01</span><span class="p">,</span> <span class="n">q</span> <span class="o">=</span>  <span class="mf">3.000</span>
 <span class="n">psi</span> <span class="o">=</span> <span class="mf">9.282E-01</span><span class="p">,</span> <span class="n">q</span> <span class="o">=</span>  <span class="mf">4.000</span>
 <span class="n">psi</span> <span class="o">=</span> <span class="mf">9.884E-01</span><span class="p">,</span> <span class="n">q</span> <span class="o">=</span>  <span class="mf">5.000</span>
 <span class="n">psi</span> <span class="o">=</span> <span class="mf">9.915E-01</span><span class="p">,</span> <span class="n">q</span> <span class="o">=</span>  <span class="mf">5.200</span>
 <span class="n">Computing</span> <span class="n">free</span> <span class="n">boundary</span> <span class="n">energies</span>
 <span class="n">Energies</span><span class="p">:</span> <span class="n">plasma</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.754E+00</span><span class="p">,</span> <span class="n">vacuum</span> <span class="o">=</span>  <span class="mf">2.485E+00</span><span class="p">,</span> <span class="n">total</span> <span class="o">=</span>  <span class="mf">7.309E-01</span>
 <span class="n">All</span> <span class="n">free</span><span class="o">-</span><span class="n">boundary</span> <span class="n">modes</span> <span class="n">stable</span> <span class="k">for</span> <span class="n">nn</span> <span class="o">=</span>  <span class="mf">1.</span>
 <span class="n">Total</span> <span class="n">cpu</span> <span class="n">time</span> <span class="o">=</span>  <span class="mf">8.328E+00</span> <span class="n">seconds</span>
 <span class="n">DCON</span> <span class="n">STOP</span> <span class="o">=&gt;</span> <span class="n">Normal</span> <span class="n">termination</span><span class="o">.</span>
</pre></div>
</div>
<p>From the positive total energy, we see that the plasma is reasonably stable for n=1 perturbations. Totals are often of this order 1e0-1e-2, while numbers of order 1e-3 or smaller might be considered approching instability and require some investigation. It is
always a good idea to check any solution, using xdraw or just skimming dcon.out.</p>
<p>Satisfied with the DCON result, we run GPEC:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">gpec</span>

 <span class="n">GPEC</span> <span class="n">START</span> <span class="o">=&gt;</span> <span class="n">GPEC</span> <span class="n">version</span> <span class="mf">1.0</span><span class="o">.</span><span class="mi">0</span>
 <span class="n">__________________________________________</span>
 <span class="n">Reading</span> <span class="n">dcon</span> <span class="n">eigenfuctions</span>
 <span class="n">Counting</span> <span class="ow">and</span> <span class="n">reading</span> <span class="n">dcon</span> <span class="n">solutions</span>
 <span class="n">mlow</span> <span class="o">=</span>  <span class="o">-</span><span class="mi">12</span> <span class="p">,</span> <span class="n">mhigh</span> <span class="o">=</span>  <span class="mi">21</span> <span class="p">,</span> <span class="n">mpert</span> <span class="o">=</span>  <span class="mi">34</span>
 <span class="n">mstep</span> <span class="o">=</span>  <span class="mi">1574</span> <span class="p">,</span> <span class="n">mfix</span> <span class="o">=</span>  <span class="mi">17</span> <span class="p">,</span> <span class="n">msing</span> <span class="o">=</span>  <span class="mi">4</span>
 <span class="n">Recontructing</span> <span class="n">flux</span> <span class="n">functions</span> <span class="ow">and</span> <span class="n">metric</span> <span class="n">tensors</span>
 <span class="n">Reading</span> <span class="n">vacuum</span> <span class="n">energy</span> <span class="n">matrices</span>
 <span class="n">Calculating</span> <span class="n">field</span> <span class="n">on</span> <span class="n">the</span> <span class="n">boundary</span> <span class="kn">from</span> <span class="nn">coils</span>
 <span class="n">Building</span> <span class="n">free</span> <span class="n">boundary</span> <span class="n">solutions</span>
 <span class="n">eigenmode</span> <span class="o">=</span>   <span class="mi">1</span><span class="p">,</span> <span class="n">dw</span> <span class="o">=</span> <span class="o">-</span><span class="mf">2.364E-03</span><span class="p">,</span> <span class="n">error</span> <span class="o">=</span>  <span class="mf">3.608E-09</span>
 <span class="n">eigenmode</span> <span class="o">=</span>   <span class="mi">2</span><span class="p">,</span> <span class="n">dw</span> <span class="o">=</span>  <span class="mf">3.918E-01</span><span class="p">,</span> <span class="n">error</span> <span class="o">=</span>  <span class="mf">1.151E-12</span>
 <span class="n">eigenmode</span> <span class="o">=</span>   <span class="mi">3</span><span class="p">,</span> <span class="n">dw</span> <span class="o">=</span>  <span class="mf">1.413E+00</span><span class="p">,</span> <span class="n">error</span> <span class="o">=</span>  <span class="mf">1.776E-11</span>
 <span class="n">eigenmode</span> <span class="o">=</span>   <span class="mi">4</span><span class="p">,</span> <span class="n">dw</span> <span class="o">=</span>  <span class="mf">2.932E+00</span><span class="p">,</span> <span class="n">error</span> <span class="o">=</span>  <span class="mf">4.966E-12</span>
 <span class="n">eigenmode</span> <span class="o">=</span>   <span class="mi">5</span><span class="p">,</span> <span class="n">dw</span> <span class="o">=</span>  <span class="mf">3.617E+00</span><span class="p">,</span> <span class="n">error</span> <span class="o">=</span>  <span class="mf">6.209E-12</span>
 <span class="n">eigenmode</span> <span class="o">=</span>   <span class="mi">6</span><span class="p">,</span> <span class="n">dw</span> <span class="o">=</span>  <span class="mf">4.939E+00</span><span class="p">,</span> <span class="n">error</span> <span class="o">=</span>  <span class="mf">5.212E-12</span>
 <span class="n">eigenmode</span> <span class="o">=</span>   <span class="mi">7</span><span class="p">,</span> <span class="n">dw</span> <span class="o">=</span>  <span class="mf">7.459E+00</span><span class="p">,</span> <span class="n">error</span> <span class="o">=</span>  <span class="mf">4.384E-12</span>
 <span class="n">eigenmode</span> <span class="o">=</span>   <span class="mi">8</span><span class="p">,</span> <span class="n">dw</span> <span class="o">=</span>  <span class="mf">1.033E+01</span><span class="p">,</span> <span class="n">error</span> <span class="o">=</span>  <span class="mf">3.098E-12</span>
 <span class="n">eigenmode</span> <span class="o">=</span>   <span class="mi">9</span><span class="p">,</span> <span class="n">dw</span> <span class="o">=</span>  <span class="mf">1.050E+01</span><span class="p">,</span> <span class="n">error</span> <span class="o">=</span>  <span class="mf">7.427E-12</span>
 <span class="n">eigenmode</span> <span class="o">=</span>  <span class="mi">10</span><span class="p">,</span> <span class="n">dw</span> <span class="o">=</span>  <span class="mf">1.301E+01</span><span class="p">,</span> <span class="n">error</span> <span class="o">=</span>  <span class="mf">4.758E-12</span>
 <span class="n">eigenmode</span> <span class="o">=</span>  <span class="mi">11</span><span class="p">,</span> <span class="n">dw</span> <span class="o">=</span>  <span class="mf">1.602E+01</span><span class="p">,</span> <span class="n">error</span> <span class="o">=</span>  <span class="mf">4.668E-12</span>
 <span class="n">eigenmode</span> <span class="o">=</span>  <span class="mi">12</span><span class="p">,</span> <span class="n">dw</span> <span class="o">=</span>  <span class="mf">1.760E+01</span><span class="p">,</span> <span class="n">error</span> <span class="o">=</span>  <span class="mf">2.422E-11</span>
 <span class="n">eigenmode</span> <span class="o">=</span>  <span class="mi">13</span><span class="p">,</span> <span class="n">dw</span> <span class="o">=</span>  <span class="mf">1.913E+01</span><span class="p">,</span> <span class="n">error</span> <span class="o">=</span>  <span class="mf">5.817E-12</span>
 <span class="n">eigenmode</span> <span class="o">=</span>  <span class="mi">14</span><span class="p">,</span> <span class="n">dw</span> <span class="o">=</span>  <span class="mf">2.227E+01</span><span class="p">,</span> <span class="n">error</span> <span class="o">=</span>  <span class="mf">6.625E-12</span>
 <span class="n">eigenmode</span> <span class="o">=</span>  <span class="mi">15</span><span class="p">,</span> <span class="n">dw</span> <span class="o">=</span>  <span class="mf">2.553E+01</span><span class="p">,</span> <span class="n">error</span> <span class="o">=</span>  <span class="mf">6.178E-12</span>
 <span class="n">eigenmode</span> <span class="o">=</span>  <span class="mi">16</span><span class="p">,</span> <span class="n">dw</span> <span class="o">=</span>  <span class="mf">2.650E+01</span><span class="p">,</span> <span class="n">error</span> <span class="o">=</span>  <span class="mf">4.967E-11</span>
 <span class="n">eigenmode</span> <span class="o">=</span>  <span class="mi">17</span><span class="p">,</span> <span class="n">dw</span> <span class="o">=</span>  <span class="mf">2.876E+01</span><span class="p">,</span> <span class="n">error</span> <span class="o">=</span>  <span class="mf">6.067E-12</span>
 <span class="n">eigenmode</span> <span class="o">=</span>  <span class="mi">18</span><span class="p">,</span> <span class="n">dw</span> <span class="o">=</span>  <span class="mf">3.129E+01</span><span class="p">,</span> <span class="n">error</span> <span class="o">=</span>  <span class="mf">3.658E-11</span>
 <span class="n">eigenmode</span> <span class="o">=</span>  <span class="mi">19</span><span class="p">,</span> <span class="n">dw</span> <span class="o">=</span>  <span class="mf">3.229E+01</span><span class="p">,</span> <span class="n">error</span> <span class="o">=</span>  <span class="mf">5.655E-13</span>
 <span class="n">eigenmode</span> <span class="o">=</span>  <span class="mi">20</span><span class="p">,</span> <span class="n">dw</span> <span class="o">=</span>  <span class="mf">3.677E+01</span><span class="p">,</span> <span class="n">error</span> <span class="o">=</span>  <span class="mf">1.296E-11</span>
 <span class="n">eigenmode</span> <span class="o">=</span>  <span class="mi">21</span><span class="p">,</span> <span class="n">dw</span> <span class="o">=</span>  <span class="mf">3.718E+01</span><span class="p">,</span> <span class="n">error</span> <span class="o">=</span>  <span class="mf">3.762E-11</span>
 <span class="n">eigenmode</span> <span class="o">=</span>  <span class="mi">22</span><span class="p">,</span> <span class="n">dw</span> <span class="o">=</span>  <span class="mf">4.168E+01</span><span class="p">,</span> <span class="n">error</span> <span class="o">=</span>  <span class="mf">1.153E-11</span>
 <span class="n">eigenmode</span> <span class="o">=</span>  <span class="mi">23</span><span class="p">,</span> <span class="n">dw</span> <span class="o">=</span>  <span class="mf">4.429E+01</span><span class="p">,</span> <span class="n">error</span> <span class="o">=</span>  <span class="mf">2.995E-11</span>
 <span class="n">eigenmode</span> <span class="o">=</span>  <span class="mi">24</span><span class="p">,</span> <span class="n">dw</span> <span class="o">=</span>  <span class="mf">5.306E+01</span><span class="p">,</span> <span class="n">error</span> <span class="o">=</span>  <span class="mf">2.081E-11</span>
 <span class="n">eigenmode</span> <span class="o">=</span>  <span class="mi">25</span><span class="p">,</span> <span class="n">dw</span> <span class="o">=</span>  <span class="mf">6.506E+01</span><span class="p">,</span> <span class="n">error</span> <span class="o">=</span>  <span class="mf">1.280E-11</span>
 <span class="n">eigenmode</span> <span class="o">=</span>  <span class="mi">26</span><span class="p">,</span> <span class="n">dw</span> <span class="o">=</span>  <span class="mf">8.191E+01</span><span class="p">,</span> <span class="n">error</span> <span class="o">=</span>  <span class="mf">8.032E-12</span>
 <span class="n">eigenmode</span> <span class="o">=</span>  <span class="mi">27</span><span class="p">,</span> <span class="n">dw</span> <span class="o">=</span>  <span class="mf">9.998E+01</span><span class="p">,</span> <span class="n">error</span> <span class="o">=</span>  <span class="mf">7.700E-12</span>
 <span class="n">eigenmode</span> <span class="o">=</span>  <span class="mi">28</span><span class="p">,</span> <span class="n">dw</span> <span class="o">=</span>  <span class="mf">1.069E+02</span><span class="p">,</span> <span class="n">error</span> <span class="o">=</span>  <span class="mf">5.822E-12</span>
 <span class="n">eigenmode</span> <span class="o">=</span>  <span class="mi">29</span><span class="p">,</span> <span class="n">dw</span> <span class="o">=</span>  <span class="mf">1.389E+02</span><span class="p">,</span> <span class="n">error</span> <span class="o">=</span>  <span class="mf">1.135E-12</span>
 <span class="n">eigenmode</span> <span class="o">=</span>  <span class="mi">30</span><span class="p">,</span> <span class="n">dw</span> <span class="o">=</span>  <span class="mf">1.347E+02</span><span class="p">,</span> <span class="n">error</span> <span class="o">=</span>  <span class="mf">1.387E-11</span>
 <span class="n">eigenmode</span> <span class="o">=</span>  <span class="mi">31</span><span class="p">,</span> <span class="n">dw</span> <span class="o">=</span>  <span class="mf">1.374E+02</span><span class="p">,</span> <span class="n">error</span> <span class="o">=</span>  <span class="mf">1.473E-11</span>
 <span class="n">eigenmode</span> <span class="o">=</span>  <span class="mi">32</span><span class="p">,</span> <span class="n">dw</span> <span class="o">=</span>  <span class="mf">2.171E+02</span><span class="p">,</span> <span class="n">error</span> <span class="o">=</span>  <span class="mf">6.004E-12</span>
 <span class="n">eigenmode</span> <span class="o">=</span>  <span class="mi">33</span><span class="p">,</span> <span class="n">dw</span> <span class="o">=</span>  <span class="mf">2.329E+02</span><span class="p">,</span> <span class="n">error</span> <span class="o">=</span>  <span class="mf">9.530E-12</span>
 <span class="n">eigenmode</span> <span class="o">=</span>  <span class="mi">34</span><span class="p">,</span> <span class="n">dw</span> <span class="o">=</span>  <span class="mf">6.934E+02</span><span class="p">,</span> <span class="n">error</span> <span class="o">=</span>  <span class="mf">2.111E-12</span>
 <span class="n">Calculating</span> <span class="n">inductrances</span> <span class="ow">and</span> <span class="n">permeability</span>
 <span class="n">Single</span> <span class="n">mode</span> <span class="n">permeability</span> <span class="o">=</span>  <span class="mf">7.923E+00</span>
 <span class="n">Required</span> <span class="n">energy</span> <span class="n">to</span> <span class="n">perturb</span> <span class="n">vacuum</span> <span class="o">=</span>  <span class="mf">9.309E+00</span>
 <span class="n">Required</span> <span class="n">energy</span> <span class="n">to</span> <span class="n">perturb</span> <span class="n">plasma</span> <span class="o">=</span>  <span class="mf">3.862E+00</span>
 <span class="n">Amplification</span> <span class="n">factor</span> <span class="o">=</span>  <span class="mf">2.411E+00</span>
 <span class="n">Computing</span> <span class="n">total</span> <span class="n">resonant</span> <span class="n">fields</span>
 <span class="n">psi</span> <span class="o">=</span>  <span class="mf">5.936E-01</span><span class="p">,</span> <span class="n">q</span> <span class="o">=</span>  <span class="mf">2.000</span><span class="p">,</span> <span class="n">total</span> <span class="n">resonant</span> <span class="n">field</span> <span class="o">=</span>  <span class="mf">3.705E-04</span>
 <span class="n">psi</span> <span class="o">=</span>  <span class="mf">8.186E-01</span><span class="p">,</span> <span class="n">q</span> <span class="o">=</span>  <span class="mf">3.000</span><span class="p">,</span> <span class="n">total</span> <span class="n">resonant</span> <span class="n">field</span> <span class="o">=</span>  <span class="mf">2.805E-04</span>
 <span class="n">psi</span> <span class="o">=</span>  <span class="mf">9.282E-01</span><span class="p">,</span> <span class="n">q</span> <span class="o">=</span>  <span class="mf">4.000</span><span class="p">,</span> <span class="n">total</span> <span class="n">resonant</span> <span class="n">field</span> <span class="o">=</span>  <span class="mf">5.450E-05</span>
 <span class="n">psi</span> <span class="o">=</span>  <span class="mf">9.884E-01</span><span class="p">,</span> <span class="n">q</span> <span class="o">=</span>  <span class="mf">5.000</span><span class="p">,</span> <span class="n">total</span> <span class="n">resonant</span> <span class="n">field</span> <span class="o">=</span>  <span class="mf">4.211E-04</span>
 <span class="n">Computing</span> <span class="n">Clebsch</span> <span class="n">displacements</span>
 <span class="n">volume</span> <span class="o">=</span>  <span class="mi">10</span><span class="o">%</span> <span class="n">Clebsch</span> <span class="n">decomposition</span>
 <span class="n">volume</span> <span class="o">=</span>  <span class="mi">20</span><span class="o">%</span> <span class="n">Clebsch</span> <span class="n">decomposition</span>
 <span class="n">volume</span> <span class="o">=</span>  <span class="mi">30</span><span class="o">%</span> <span class="n">Clebsch</span> <span class="n">decomposition</span>
 <span class="n">volume</span> <span class="o">=</span>  <span class="mi">40</span><span class="o">%</span> <span class="n">Clebsch</span> <span class="n">decomposition</span>
 <span class="n">volume</span> <span class="o">=</span>  <span class="mi">50</span><span class="o">%</span> <span class="n">Clebsch</span> <span class="n">decomposition</span>
 <span class="n">volume</span> <span class="o">=</span>  <span class="mi">60</span><span class="o">%</span> <span class="n">Clebsch</span> <span class="n">decomposition</span>
 <span class="n">volume</span> <span class="o">=</span>  <span class="mi">70</span><span class="o">%</span> <span class="n">Clebsch</span> <span class="n">decomposition</span>
 <span class="n">volume</span> <span class="o">=</span>  <span class="mi">80</span><span class="o">%</span> <span class="n">Clebsch</span> <span class="n">decomposition</span>
 <span class="n">volume</span> <span class="o">=</span>  <span class="mi">90</span><span class="o">%</span> <span class="n">Clebsch</span> <span class="n">decomposition</span>
 <span class="n">volume</span> <span class="o">=</span> <span class="mi">100</span><span class="o">%</span> <span class="n">Clebsch</span> <span class="n">decomposition</span>
 <span class="n">Total</span> <span class="n">cpu</span> <span class="n">time</span> <span class="k">for</span> <span class="n">GPEC</span> <span class="o">=</span>  <span class="mi">27</span>  <span class="n">seconds</span>
 <span class="n">GPEC</span> <span class="n">STOP</span> <span class="o">=&gt;</span> <span class="n">Normal</span> <span class="n">termination</span><span class="o">.</span>
</pre></div>
</div>
<p>Here we see the plasma has a single mode permeability ~8, meaning that the application of the first permeability eigenmode on the plasma control surface would result in a total flux (external + plasma response) 8 times the applied mode. The full permeability eigenmode and eigevector information can be found in gpec_response_n1.out. We also see a preview of the resonant field information, a more detailed collection of which is in gpec_singfld_n1.out. Finally, we have told GPEC to calculate and output the clebsch coordinate displacments in gpec_xclebsch_n1.out. This becomes an input for PENT.</p>
<p>Finally, we run PENT:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>pentrc

 PENTRC START =&gt; GPEC version 1.0.0
 __________________________________________
 clearing working directory
rm: cannot remove `pentrc_*.out&#39;: No such file or directory
 Set idconfile:
   euler.bin
 Reading dcon eigenfuctions
 Counting and reading dcon solutions
 mlow =  -12 , mhigh =  21 , mpert =  34
 mstep =  1574 , mfix =  17 , msing =  4
 Recontructing flux functions and metric tensors
 Computing perturbed b field for gpec
 Reading table from file:
   g147131.02300_DIIID_KEFIT.kin
 Reading table from file:
   gpec_xclebsch_n1.out
   -&gt; WARNING: Assuming DCON hamada coordinates
   -&gt; calculating deltaB/B, divxi_prp
   |----------|   0% iterations complete
   |oo--------|  20% iterations complete
   |oooo------|  40% iterations complete
   |oooooo----|  60% iterations complete
   |oooooooo--|  80% iterations complete
   |oooooooooo| 100% iterations complete
 PENTRC - full general-aspect-ratio calculation
  psi = 0.0  -&gt; T_phi =   7.63E-05  1.36E-04j
  psi = 0.1  -&gt; T_phi =   1.42E-02  5.57E-03j
  psi = 0.2  -&gt; T_phi =   2.26E-02  5.39E-03j
  psi = 0.3  -&gt; T_phi =   2.50E-02  9.84E-03j
  psi = 0.4  -&gt; T_phi =   2.80E-02  1.49E-02j
  WARNING: vpar zero crossing internal to magnetic well at psi  4.783E-01
   5.000E-01 &lt;=  5.006E-01 &lt;=  1.500E+00
   -&gt; Lambda, t/p boundry =  0.7737391481753563 0.7737464409937628
   -&gt; consider changing mtheta in equil.in
  psi = 0.5  -&gt; T_phi =   3.56E-02  2.03E-02j
  psi = 0.6  -&gt; T_phi =   4.20E-02  2.21E-02j
  WARNING: vpar zero crossing internal to magnetic well at psi  6.333E-01
   5.000E-01 &lt;=  1.497E+00 &lt;=  1.500E+00
   -&gt; Lambda, t/p boundry =  0.7299058478670797 0.7299127275381094
   -&gt; consider changing mtheta in equil.in
  psi = 0.7  -&gt; T_phi =   4.32E-02  2.33E-02j
  psi = 0.8  -&gt; T_phi =   5.03E-02  2.12E-02j
  WARNING: vpar zero crossing internal to magnetic well at psi  8.265E-01
   4.844E-01 &lt;=  1.481E+00 &lt;=  1.484E+00
   -&gt; Lambda, t/p boundry =  0.6744367173720330 0.6744430742230700
   -&gt; consider changing mtheta in equil.in
  psi = 0.9  -&gt; T_phi =   5.55E-02  3.58E-02j
  WARNING: vpar zero crossing internal to magnetic well at psi  9.326E-01
   4.492E-01 &lt;=  4.495E-01 &lt;=  1.449E+00
   -&gt; Lambda, t/p boundry =  0.6424701444514599 0.6424762000040400
   -&gt; consider changing mtheta in equil.in
 ---------------------------------------------
         Total torque =  4.263E-001
 Total Kinetic Energy =  2.657E-002
             alpha/s  = -8.022E+000
 ---------------------------------------------
  WARNING: vpar zero crossing internal to magnetic well at psi  8.000E-01
   4.844E-01 &lt;=  4.847E-01 &lt;=  1.484E+00
   -&gt; Lambda, t/p boundry =  0.6821990656221174 0.6822054956365666
   -&gt; consider changing mtheta in equil.in
  WARNING: vpar zero crossing internal to magnetic well at psi  4.575E-01
   5.039E-01 &lt;=  1.502E+00 &lt;=  1.504E+00
   -&gt; Lambda, t/p boundry =  0.7797137521775525 0.7797211013091262
   -&gt; consider changing mtheta in equil.in
 PENTRC - trapped particle general-aspect-ratio calculation
  psi = 0.0  -&gt; T_phi =   9.05E-05  1.38E-04j
  psi = 0.1  -&gt; T_phi =   1.41E-02  3.46E-03j
  psi = 0.2  -&gt; T_phi =   2.25E-02 -9.46E-05j
  psi = 0.3  -&gt; T_phi =   2.49E-02  1.45E-03j
  psi = 0.4  -&gt; T_phi =   2.74E-02  4.33E-03j
  psi = 0.5  -&gt; T_phi =   3.56E-02  7.62E-03j
  psi = 0.6  -&gt; T_phi =   4.18E-02  7.99E-03j
  psi = 0.7  -&gt; T_phi =   4.31E-02  8.85E-03j
  psi = 0.8  -&gt; T_phi =   5.07E-02  5.19E-03j
  psi = 0.9  -&gt; T_phi =   5.42E-02  1.97E-02j
 ---------------------------------------------
         Total torque =  4.027E-001
 Total Kinetic Energy =  1.002E-002
             alpha/s  = -2.010E+001
 ---------------------------------------------
 PENTRC - reduced large-aspect-ratio calculation
 Reading F^-1/2_mnl from file:
   ../../../pentrc/fkmnl.dat
  psi = 0.0  -&gt; T_phi =   7.47E-06  1.01E-04j
  psi = 0.1  -&gt; T_phi =   9.18E-01  2.02E-01j
  psi = 0.2  -&gt; T_phi =   1.40E+00  1.76E+00j
  psi = 0.3  -&gt; T_phi =   1.66E+00  5.13E+00j
  psi = 0.4  -&gt; T_phi =   1.94E+00  1.07E+01j
  psi = 0.5  -&gt; T_phi =   2.33E+00  1.74E+01j
  psi = 0.6  -&gt; T_phi =   2.98E+00  2.32E+01j
  psi = 0.7  -&gt; T_phi =   3.62E+00  3.68E+01j
  psi = 0.8  -&gt; T_phi =   6.27E+00  5.75E+01j
  psi = 0.9  -&gt; T_phi =   1.47E+01  3.04E+02j
 ---------------------------------------------
         Total torque =  2.039E+003
 Total Kinetic Energy = -2.748E+002
             alpha/s  =  3.710E+000
 ---------------------------------------------
 total cpu time =  8  minutes,  0  seconds
PENTRC STOP =&gt; Normal termination.
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The warnings about magnetic wells are ok in this case.</p>
</div>
<p>We see that the full and trapped-only calculations of the torque agree reasonably well, which is consistent with the understanding that particles on banana orbits dominate the nonambipolar transport. The RLAR result in this case is orders of magnitude off, but does have generaly the correct qualitative behavior.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="source_documentation.html" title="PYPEC Source documentation"
             >next</a> |</li>
        <li class="right" >
          <a href="namelists.html" title="Namelist Variables"
             >previous</a> |</li>
        <li><a href="index.html">home</a>|&nbsp;</li>
        <li><a href="search.html">search</a>|&nbsp;</li>
 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2015, PPPL.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.7.0.
    </div>
  </body>
</html>