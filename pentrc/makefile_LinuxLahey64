# This is the makefile for PENTRC on LinuxLahey64 computers.

FFLAGS = -I../equil

F90 = lfc $(FFLAGS)

.f.o:
	$(F90) -c $*.f

%.o: %.f90
	$(F90) -c $<


LIBDIR = \
	-L../lib/LinuxLahey64 \
	-L/usr/pppl/lff95/8.x86_64-pkgs/lapack-3.1.1.x86_64 \

LIBS = \
	$(LIBDIR) \
	-llsode \
	-lequil \
	-llapack \
	-lblas \

OBJS = \
	dcon_interface.o \
	utilities.o \
    params.o \
	lsode1.o \
	lsode2.o \
	special.o \
    grid.o \
    inputs.o \
	energy.o \
    pitch.o \
    torque.o \
	diagnostics.o \
	pentrc_interface.o \
	pentrc.o

pentrc: $(OBJS)
	$(F90) -o pentrc $(OBJS) $(LIBS)
	mkdir -p ../lib/LinuxLahey64
	ar -r ../lib/LinuxLahey64/libpentrc.a *.o

# dependencies

lsode1.o:
lsode2.o:
params.o:
grid.o: 
utilities.o: params.o
special.o: params.o utilities.o
dcon_interface.o: params.o utilities.o
inputs.o:  params.o utilities.o special.o dcon_interface.o
energy.o:  params.o utilities.o lsode2.o
pitch.o:   params.o utilities.o lsode1.o energy.o special.o
torque.o:  params.o utilities.o special.o inputs.o energy.o pitch.o
diagnostics.o: params.o special.o energy.o pitch.o
pentrc.o:  utilities.o special.o energy.o pitch.o torque.o inputs.o diagnostics.o 
pentrc_interface.o: params.o utilities.o inputs.o energy.o pitch.o torque.o

clean:
	rm -f *.o *.mod *.out *.bin pentrc
